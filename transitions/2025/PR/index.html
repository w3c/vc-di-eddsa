<!DOCTYPE html><html lang="en" dir="ltr"><head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="generator" content="ReSpec 35.2.2">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-color:var(--warning-border,#f11);border-width:.2em;border-style:solid;background:#fbe9e9;background:var(--warning-bg,#fbe9e9);color:#000;color:var(--text,#000)}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;background:var(--indextable-hover-bg,#fff);color:#000;color:var(--text,#000);box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);box-shadow:0 1em 3em -.4em var(--tocsidebar-shadow,rgba(0,0,0,.3)),0 0 1px 1px var(--tocsidebar-shadow,rgba(0,0,0,.05));border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;border-bottom-color:var(--indextable-hover-bg,#fff);top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1;border-bottom-color:var(--indextable-hover-bg,#a2a9b1)}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;color:var(--text,#000);margin-top:.25em}
.dfn-panel ul a[href]{color:#333;color:var(--text,#333)}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
    
<title>Data Integrity EdDSA Cryptosuites v1.0</title>
    
    
    
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
    

    
    
<style>

code {
  color: rgb(199, 73, 0);
  font-weight: bold;
}
pre.nohighlight {
  overflow-x: auto;
  white-space: pre-wrap;
}
pre .highlight {
  font-weight: bold;
  color: green;
}
pre .comment {
  font-weight: bold;
  color: Gray;
}
.color-text {
  font-weight: bold;
  text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;
}
ol.algorithm {
  counter-reset: numsection;
  list-style-type: none;
}
ol.algorithm li {
  margin: 0.5em 0;
}
ol.algorithm li:before {
  font-weight: bold;
  counter-increment: numsection;
  content: counters(numsection, ".") ") ";
}
    
</style>
  
<meta name="color-scheme" content="light">
<meta name="description" content="This specification describes Data Integrity cryptographic suites for use when
creating or verifying a digital signature using the the Ed25519 instantiation
of the Edwards-Curve Digital Signature Algorithm (EdDSA).">
<link rel="canonical" href="https://www.w3.org/TR/vc-di-eddsa/">
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#222}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#222;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "subtitle": "Achieving Data Integrity using EdDSA with Edwards curves",
  "specStatus": "PR",
  "shortName": "vc-di-eddsa",
  "group": "vc",
  "publishDate": "2025-3-20",
  "crEnd": "2025-01-19",
  "prEnd": "2025-4-17",
  "edDraftURI": "https://w3c.github.io/vc-di-eddsa/",
  "implementationReportURI": "https://w3c.github.io/vc-di-eddsa-test-suite/",
  "editors": [
    {
      "name": "Manu Sporny",
      "url": "https://www.linkedin.com/in/manusporny/",
      "company": "Digital Bazaar",
      "companyURL": "https://digitalbazaar.com/",
      "w3cid": 41758
    },
    {
      "name": "Greg Bernstein",
      "url": "https://www.grotto-networking.com/",
      "company": "Invited Expert",
      "w3cid": 140479
    },
    {
      "name": "Ted Thibodeau Jr",
      "url": "https://github.com/TallTed",
      "company": "OpenLink Software",
      "companyURL": "https://www.openlinksw.com/",
      "note": "v2.0",
      "w3cid": 42501
    }
  ],
  "authors": [
    {
      "name": "Dave Longley",
      "url": "https://digitalbazaar.com/",
      "company": "Digital Bazaar",
      "companyURL": "https://digitalbazaar.com/",
      "w3cid": 48025
    },
    {
      "name": "Manu Sporny",
      "url": "https://www.linkedin.com/in/manusporny/",
      "company": "Digital Bazaar",
      "companyURL": "https://digitalbazaar.com/",
      "w3cid": 41758
    },
    {
      "name": "Greg Bernstein",
      "url": "https://www.grotto-networking.com/",
      "company": "Invited Expert",
      "w3cid": 140479
    }
  ],
  "github": "https://github.com/w3c/vc-di-eddsa/",
  "maxTocLevel": 4,
  "localBiblio": {
    "MULTIBASE": {
      "title": "Multibase",
      "href": "https://datatracker.ietf.org/doc/html/draft-multiformats-multibase-01"
    },
    "MULTICODEC": {
      "title": "Multicodec",
      "href": "https://github.com/multiformats/multicodec/"
    },
    "Taming_EdDSAs": {
      "title": "Taming the many EdDSAs",
      "href": "https://eprint.iacr.org/2020/1244",
      "authors": [
        "Konstantinos Chalkias",
        "François Garillot",
        "Valeria Nikolaenko"
      ],
      "date": "2020",
      "publisher": "Cryptology ePrint Archive, Paper 2020/1244",
      "doi": "10.1007/978-3-030-64357-7_4",
      "id": "taming_eddsas"
    },
    "Provable_Ed25519": {
      "authors": [
        "Jacqueline Brendel",
        "Cas Cremers",
        "Dennis Jackson",
        "Mang Zhao"
      ],
      "title": "The Provable Security of Ed25519: Theory and Practice",
      "publisher": "Cryptology ePrint Archive, Paper 2020/823",
      "date": "2020",
      "href": "https://eprint.iacr.org/2020/823",
      "id": "provable_ed25519"
    }
  },
  "xref": [
    "INFRA",
    "VC-DATA-MODEL-2.0",
    "VC-DATA-INTEGRITY"
  ],
  "lint": {
    "informative-dfn": false
  },
  "otherLinks": [
    {
      "key": "Related Specifications",
      "data": [
        {
          "value": "Verifiable Credentials Data Model v2.0",
          "href": "https://www.w3.org/TR/vc-data-model-2.0/"
        },
        {
          "value": "Verifiable Credential Data Integrity v1.0",
          "href": "https://www.w3.org/TR/vc-data-integrity/"
        },
        {
          "value": "Controlled Identifiers v1.0",
          "href": "https://www.w3.org/TR/cid-1.0/"
        },
        {
          "value": "Data Integrity ECDSA Cryptosuites v1.0",
          "href": "https://www.w3.org/TR/vc-di-ecdsa/"
        },
        {
          "value": "Data Integrity BBS Cryptosuites v1.0",
          "href": "https://www.w3.org/TR/vc-di-bbs/"
        }
      ]
    }
  ],
  "publishISODate": "2025-03-20T00:00:00.000Z",
  "generatedSubtitle": "W3C Proposed Recommendation 20 March 2025"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/W3C-PR"></head>
  <body class="h-entry" data-cite="INFRA VC-DATA-MODEL-2.0 VC-DATA-INTEGRITY"><div class="head">
    <p class="logos"><a class="logo" href="https://www.w3.org/"><img crossorigin="" alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72">
  </a></p>
    <h1 id="title" class="title">Data Integrity EdDSA Cryptosuites v1.0</h1> <h2 id="subtitle" class="subtitle">Achieving Data Integrity using EdDSA with Edwards curves</h2>
    <p id="w3c-state"><a href="https://www.w3.org/standards/types#PR">W3C Proposed Recommendation</a> <time class="dt-published" datetime="2025-03-20">20 March 2025</time></p>
    <details open="">
      <summary>More details about this document</summary>
      <dl>
        <dt>This version:</dt><dd>
                <a class="u-url" href="https://www.w3.org/TR/2025/PR-vc-di-eddsa-20250320/">https://www.w3.org/TR/2025/PR-vc-di-eddsa-20250320/</a>
              </dd>
        <dt>Latest published version:</dt><dd>
                <a href="https://www.w3.org/TR/vc-di-eddsa/">https://www.w3.org/TR/vc-di-eddsa/</a>
              </dd>
        <dt>Latest editor's draft:</dt><dd><a href="https://w3c.github.io/vc-di-eddsa/">https://w3c.github.io/vc-di-eddsa/</a></dd>
        <dt>History:</dt><dd>
                    <a href="https://www.w3.org/standards/history/vc-di-eddsa/">https://www.w3.org/standards/history/vc-di-eddsa/</a>
                  </dd><dd>
                    <a href="https://github.com/w3c/vc-di-eddsa/commits/">Commit history</a>
                  </dd>
        
        <dt>Implementation report:</dt><dd>
                <a href="https://w3c.github.io/vc-di-eddsa-test-suite/">https://w3c.github.io/vc-di-eddsa-test-suite/</a>
              </dd>
        
        
        
        <dt>Editors:</dt><dd class="editor p-author h-card vcard" data-editor-id="41758">
    <a class="u-url url p-name fn" href="https://www.linkedin.com/in/manusporny/">Manu Sporny</a> (<a class="p-org org h-org" href="https://digitalbazaar.com/">Digital Bazaar</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="140479">
    <a class="u-url url p-name fn" href="https://www.grotto-networking.com/">Greg Bernstein</a> (<span class="p-org org h-org">Invited Expert</span>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="42501">
    <a class="u-url url p-name fn" href="https://github.com/TallTed">Ted Thibodeau Jr</a> (<a class="p-org org h-org" href="https://www.openlinksw.com/">OpenLink Software</a>) (v2.0)
  </dd>
        
        <dt>Authors:</dt><dd class="editor p-author h-card vcard" data-editor-id="48025">
    <a class="u-url url p-name fn" href="https://digitalbazaar.com/">Dave Longley</a> (<a class="p-org org h-org" href="https://digitalbazaar.com/">Digital Bazaar</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="41758">
    <a class="u-url url p-name fn" href="https://www.linkedin.com/in/manusporny/">Manu Sporny</a> (<a class="p-org org h-org" href="https://digitalbazaar.com/">Digital Bazaar</a>)
  </dd><dd class="editor p-author h-card vcard" data-editor-id="140479">
    <a class="u-url url p-name fn" href="https://www.grotto-networking.com/">Greg Bernstein</a> (<span class="p-org org h-org">Invited Expert</span>)
  </dd>
        <dt>Feedback:</dt><dd>
        <a href="https://github.com/w3c/vc-di-eddsa/">GitHub w3c/vc-di-eddsa</a>
        (<a href="https://github.com/w3c/vc-di-eddsa/pulls/">pull requests</a>,
        <a href="https://github.com/w3c/vc-di-eddsa/issues/new/choose">new issue</a>,
        <a href="https://github.com/w3c/vc-di-eddsa/issues/">open issues</a>)
      </dd>
        
        <dt>Related Specifications</dt><dd>
    <a href="https://www.w3.org/TR/vc-data-model-2.0/">Verifiable Credentials Data Model v2.0</a>
  </dd><dd>
    <a href="https://www.w3.org/TR/vc-data-integrity/">Verifiable Credential Data Integrity v1.0</a>
  </dd><dd>
    <a href="https://www.w3.org/TR/cid-1.0/">Controlled Identifiers v1.0</a>
  </dd><dd>
    <a href="https://www.w3.org/TR/vc-di-ecdsa/">Data Integrity ECDSA Cryptosuites v1.0</a>
  </dd><dd>
    <a href="https://www.w3.org/TR/vc-di-bbs/">Data Integrity BBS Cryptosuites v1.0</a>
  </dd>
      </dl>
    </details>
    
    
    <p class="copyright">
    <a href="https://www.w3.org/policies/#copyright">Copyright</a>
    ©
    2025
    
    <a href="https://www.w3.org/">World Wide Web Consortium</a>.
    <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup>
    <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>,
    <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and
    <a rel="license" href="https://www.w3.org/copyright/software-license-2023/" title="W3C Software and Document Notice and License">permissive document license</a> rules apply.
  </p>
    <hr title="Separator for header">
  </div>
    <section id="abstract" class="introductory"><h2>Abstract</h2>
      <p>
This specification describes Data Integrity cryptographic suites for use when
creating or verifying a digital signature using the the Ed25519 instantiation
of the Edwards-Curve Digital Signature Algorithm (EdDSA).
      </p>
    </section>

    <section id="sotd" class="introductory"><h2>Status of This Document</h2><p><em>This section describes the status of this
      document at the time of its publication. A list of current <abbr title="World Wide Web Consortium">W3C</abbr>
      publications and the latest revision of this technical report can be found
      in the <a href="https://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical reports index</a> at
      https://www.w3.org/TR/.</em></p>
    <p>
    This document was published by the <a href="https://www.w3.org/groups/wg/vc">Verifiable Credentials Working Group</a> as
    a Proposed Recommendation using the
        <a href="https://www.w3.org/policies/process/20231103/#recs-and-notes">Recommendation track</a>. 
  </p><p>Publication as a Proposed Recommendation does not
  imply endorsement by <abbr title="World Wide Web Consortium">W3C</abbr> and its Members. </p><p>
    This is a draft document and may be updated, replaced or obsoleted by other
    documents at any time. It is inappropriate to cite this document as other
    than work in progress.
    
  </p><p>
        The <abbr title="World Wide Web Consortium">W3C</abbr> Membership and other interested parties are invited to review
        the document and send comments through 17 April 2025.
        Advisory Committee Representatives should consult their
        <a href="https://www.w3.org/2002/09/wbs/myQuestionnaires">WBS questionnaires</a>. Note that substantive technical comments were expected during the
        Candidate Recommendation review period that ended
        19 January 2025.
      </p><p>
    
        This document was produced by a group
        operating under the
        <a href="https://www.w3.org/policies/patent-policy/"><abbr title="World Wide Web Consortium">W3C</abbr> Patent
          Policy</a>.
      
    
                <abbr title="World Wide Web Consortium">W3C</abbr> maintains a
                <a rel="disclosure" href="https://www.w3.org/groups/wg/vc/ipr">public list of any patent disclosures</a>
          made in connection with the deliverables of
          the group; that page also includes
          instructions for disclosing a patent. An individual who has actual
          knowledge of a patent which the individual believes contains
          <a href="https://www.w3.org/policies/patent-policy/#def-essential">Essential Claim(s)</a>
          must disclose the information in accordance with
          <a href="https://www.w3.org/policies/patent-policy/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>.
        
  </p><p>
                      This document is governed by the
                      <a id="w3c_process_revision" href="https://www.w3.org/policies/process/20231103/">03 November 2023 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>.
                    </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">1.1 </bdi>Terminology</a></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">1.2 </bdi>Conformance</a></li></ol></li><li class="tocline"><a class="tocxref" href="#data-model"><bdi class="secno">2. </bdi>Data Model</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#verification-methods"><bdi class="secno">2.1 </bdi>Verification Methods</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#multikey"><bdi class="secno">2.1.1 </bdi>Multikey</a></li></ol></li><li class="tocline"><a class="tocxref" href="#proof-representations"><bdi class="secno">2.2 </bdi>Proof Representations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#dataintegrityproof"><bdi class="secno">2.2.1 </bdi>DataIntegrityProof</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#algorithms"><bdi class="secno">3. </bdi>Algorithms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#instantiate-cryptosuite"><bdi class="secno">3.1 </bdi>Instantiate Cryptosuite</a></li><li class="tocline"><a class="tocxref" href="#eddsa-rdfc-2022"><bdi class="secno">3.2 </bdi>eddsa-rdfc-2022</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#create-proof-eddsa-rdfc-2022"><bdi class="secno">3.2.1 </bdi>Create Proof (eddsa-rdfc-2022)</a></li><li class="tocline"><a class="tocxref" href="#verify-proof-eddsa-rdfc-2022"><bdi class="secno">3.2.2 </bdi>Verify Proof (eddsa-rdfc-2022)</a></li><li class="tocline"><a class="tocxref" href="#transformation-eddsa-rdfc-2022"><bdi class="secno">3.2.3 </bdi>Transformation (eddsa-rdfc-2022)</a></li><li class="tocline"><a class="tocxref" href="#hashing-eddsa-rdfc-2022"><bdi class="secno">3.2.4 </bdi>Hashing (eddsa-rdfc-2022)</a></li><li class="tocline"><a class="tocxref" href="#proof-configuration-eddsa-rdfc-2022"><bdi class="secno">3.2.5 </bdi>Proof Configuration (eddsa-rdfc-2022)</a></li><li class="tocline"><a class="tocxref" href="#proof-serialization-eddsa-rdfc-2022"><bdi class="secno">3.2.6 </bdi>Proof Serialization (eddsa-rdfc-2022)</a></li><li class="tocline"><a class="tocxref" href="#proof-verification-eddsa-rdfc-2022"><bdi class="secno">3.2.7 </bdi>Proof Verification (eddsa-rdfc-2022)</a></li></ol></li><li class="tocline"><a class="tocxref" href="#eddsa-jcs-2022"><bdi class="secno">3.3 </bdi>eddsa-jcs-2022</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#create-proof-eddsa-jcs-2022"><bdi class="secno">3.3.1 </bdi>Create Proof (eddsa-jcs-2022)</a></li><li class="tocline"><a class="tocxref" href="#verify-proof-eddsa-jcs-2022"><bdi class="secno">3.3.2 </bdi>Verify Proof (eddsa-jcs-2022)</a></li><li class="tocline"><a class="tocxref" href="#transformation-eddsa-jcs-2022"><bdi class="secno">3.3.3 </bdi>Transformation (eddsa-jcs-2022)</a></li><li class="tocline"><a class="tocxref" href="#hashing-eddsa-jcs-2022"><bdi class="secno">3.3.4 </bdi>Hashing (eddsa-jcs-2022)</a></li><li class="tocline"><a class="tocxref" href="#proof-configuration-eddsa-jcs-2022"><bdi class="secno">3.3.5 </bdi>Proof Configuration (eddsa-jcs-2022)</a></li><li class="tocline"><a class="tocxref" href="#proof-serialization-eddsa-jcs-2022"><bdi class="secno">3.3.6 </bdi>Proof Serialization (eddsa-jcs-2022)</a></li><li class="tocline"><a class="tocxref" href="#proof-verification-eddsa-jcs-2022"><bdi class="secno">3.3.7 </bdi>Proof Verification (eddsa-jcs-2022)</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#security-considerations"><bdi class="secno">4. </bdi>Security Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#security-properties-of-ed25519-implementations"><bdi class="secno">4.1 </bdi>Security Properties of Ed25519 Implementations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#signature-security-properties"><bdi class="secno">4.1.1 </bdi>Signature Security Properties</a></li><li class="tocline"><a class="tocxref" href="#achieving-ed25519-security-properties"><bdi class="secno">4.1.2 </bdi>Achieving Ed25519 Security Properties</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#privacy-considerations"><bdi class="secno">5. </bdi>Privacy Considerations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#selective-and-unlinkable-disclosure"><bdi class="secno">5.1 </bdi>Selective and Unlinkable Disclosure</a></li></ol></li><li class="tocline"><a class="tocxref" href="#the-ed25519signature2020-suite"><bdi class="secno">A. </bdi>The Ed25519Signature2020 Suite</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#data-model-0"><bdi class="secno">A.1 </bdi>Data Model</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#verification-methods-0"><bdi class="secno">A.1.1 </bdi>Verification Methods</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#ed25519verificationkey2020"><bdi class="secno">A.1.1.1 </bdi>Ed25519VerificationKey2020</a></li></ol></li><li class="tocline"><a class="tocxref" href="#proof-representations-0"><bdi class="secno">A.1.2 </bdi>Proof representations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#ed25519signature2020"><bdi class="secno">A.1.2.1 </bdi>Ed25519Signature2020</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#algorithms-0"><bdi class="secno">A.2 </bdi>Algorithms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#ed25519signature2020-0"><bdi class="secno">A.2.1 </bdi>Ed25519Signature2020</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#add-proof-ed25519signature2020"><bdi class="secno">A.2.1.1 </bdi>Add Proof (Ed25519Signature2020)</a></li><li class="tocline"><a class="tocxref" href="#verify-proof-ed25519signature2020"><bdi class="secno">A.2.1.2 </bdi>Verify Proof (Ed25519Signature2020)</a></li><li class="tocline"><a class="tocxref" href="#transformation-ed25519signature2020"><bdi class="secno">A.2.1.3 </bdi>Transformation (Ed25519Signature2020)</a></li><li class="tocline"><a class="tocxref" href="#hashing-ed25519signature2020"><bdi class="secno">A.2.1.4 </bdi>Hashing (Ed25519Signature2020)</a></li><li class="tocline"><a class="tocxref" href="#proof-configuration-ed25519signature2020"><bdi class="secno">A.2.1.5 </bdi>Proof Configuration (Ed25519Signature2020)</a></li><li class="tocline"><a class="tocxref" href="#proof-serialization-ed25519signature2020"><bdi class="secno">A.2.1.6 </bdi>Proof Serialization (Ed25519Signature2020)</a></li><li class="tocline"><a class="tocxref" href="#proof-verification-ed25519signature2020"><bdi class="secno">A.2.1.7 </bdi>Proof Verification (Ed25519Signature2020)</a></li></ol></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#test-vectors"><bdi class="secno">B. </bdi>Test Vectors</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#representation-eddsa-rdfc-2022"><bdi class="secno">B.1 </bdi>Representation: eddsa-rdfc-2022</a></li><li class="tocline"><a class="tocxref" href="#enhanced-example-for-representation-eddsa-rdfc-2022"><bdi class="secno">B.2 </bdi>Enhanced Example for Representation: eddsa-rdfc-2022</a></li><li class="tocline"><a class="tocxref" href="#representation-eddsa-jcs-2022"><bdi class="secno">B.3 </bdi>Representation: eddsa-jcs-2022</a></li><li class="tocline"><a class="tocxref" href="#representation-ed25519signature2020"><bdi class="secno">B.4 </bdi>Representation: Ed25519Signature2020</a></li><li class="tocline"><a class="tocxref" href="#proof-sets-and-chains"><bdi class="secno">B.5 </bdi>Proof Sets and Chains</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#proof-set"><bdi class="secno">B.5.1 </bdi>Proof Set</a></li><li class="tocline"><a class="tocxref" href="#proof-chain-with-multiple-dependencies"><bdi class="secno">B.5.2 </bdi>Proof Chain with Multiple Dependencies</a></li><li class="tocline"><a class="tocxref" href="#extended-proof-chain"><bdi class="secno">B.5.3 </bdi>Extended Proof Chain</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#revision-history"><bdi class="secno">C. </bdi>Revision History</a></li><li class="tocline"><a class="tocxref" href="#acknowledgements"><bdi class="secno">D. </bdi>Acknowledgements</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">E. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">E.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">E.2 </bdi>Informative references</a></li></ol></li></ol></nav>

    <section id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div>
      
      <p>
This specification defines a cryptographic suite for the purpose of creating,
verifying proofs for Ed25519 EdDSA signatures in conformance with the
Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>] specification. The approach is
accepted by the U.S. National Institute of Standards in the latest [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-186-5" title="FIPS PUB 186-5: Digital Signature Standard (DSS)">FIPS-186-5</a></cite>]
publication and meets U.S. Federal Information Processing requirements when
using cryptography to secure digital information.
      </p>
      <p>
The suites described in this specification use the RDF Dataset Canonicalization
Algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-canon" title="RDF Dataset Canonicalization">RDF-CANON</a></cite>] or the JSON Canonicalization Scheme [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8785" title="JSON Canonicalization Scheme (JCS)">RFC8785</a></cite>] to
transform an input document into its canonical form. The canonical
representation is then hashed and signed with a detached signature algorithm.
      </p>

      <section id="terminology"><div class="header-wrapper"><h3 id="x1-1-terminology"><bdi class="secno">1.1 </bdi>Terminology</h3><a class="self-link" href="#terminology" aria-label="Permalink for Section 1.1"></a></div>
        

        <p>
Terminology used throughout this document is defined in the
<a href="https://www.w3.org/TR/vc-data-integrity/#terminology">Terminology</a> section of the
<cite><a data-matched-text="[[[VC-DATA-INTEGRITY]]]" href="https://www.w3.org/TR/vc-data-integrity/">Verifiable Credential Data Integrity 1.0</a></cite> specification.
        </p>

      </section>

      <section id="conformance"><div class="header-wrapper"><h3 id="x1-2-conformance"><bdi class="secno">1.2 </bdi>Conformance</h3><a class="self-link" href="#conformance" aria-label="Permalink for Section 1.2"></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">MUST NOT</em>, and <em class="rfc2119">SHOULD</em> in this document
        are to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p>
        <p>
A <dfn id="dfn-conforming-proof" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">conforming proof</dfn> is any concrete expression of the data model
that complies with the normative statements in this specification. Specifically,
all relevant normative statements in Sections
<a href="#data-model" data-matched-text="[[[#data-model]]]" class="sec-ref"><bdi class="secno">2. </bdi>Data Model</a> and <a href="#algorithms" data-matched-text="[[[#algorithms]]]" class="sec-ref"><bdi class="secno">3. </bdi>Algorithms</a>
of this document <em class="rfc2119">MUST</em> be enforced.
        </p>

        <p>
A <dfn class="lint-ignore" id="dfn-conforming-processor" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">conforming processor</dfn> is any algorithm realized
as software and/or hardware that generates or consumes a
<a href="#dfn-conforming-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-conforming-proof-1">conforming proof</a>. Conforming processors <em class="rfc2119">MUST</em> produce errors when
non-conforming documents are consumed.
        </p>
	<p>
This document contains examples of JSON and JSON-LD data. Some of these examples
are invalid JSON, as they include features such as inline comments (<code>//</code>)
explaining certain portions and ellipses (<code>...</code>) indicating the omission of
information that is irrelevant to the example. These parts would have to be
removed in order to treat the examples as valid JSON or JSON-LD.
        </p>
      </section>

    </section>

    <section id="data-model"><div class="header-wrapper"><h2 id="x2-data-model"><bdi class="secno">2. </bdi>Data Model</h2><a class="self-link" href="#data-model" aria-label="Permalink for Section 2."></a></div>
      

      <p>
The following sections outline the data model that is used by this specification
to express verification methods, such as cryptographic public keys, and
data integrity proofs, such as digital signatures.
      </p>

      <section id="verification-methods"><div class="header-wrapper"><h3 id="x2-1-verification-methods"><bdi class="secno">2.1 </bdi>Verification Methods</h3><a class="self-link" href="#verification-methods" aria-label="Permalink for Section 2.1"></a></div>
        

        <p>
This cryptographic suite is used to verify Data Integrity Proofs
[<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>] produced using Edwards Curve cryptographic key material.
The encoding formats for those key types are provided in this section. Lossless
cryptographic key transformation processes that result in equivalent
cryptographic key material <em class="rfc2119">MAY</em> be used for the processing of digital
signatures.
        </p>

        <section id="multikey"><div class="header-wrapper"><h4 id="x2-1-1-multikey"><bdi class="secno">2.1.1 </bdi>Multikey</h4><a class="self-link" href="#multikey" aria-label="Permalink for Section 2.1.1"></a></div>
          

          <p>
The <a href="https://www.w3.org/TR/cid-1.0/#Multikey">Multikey format</a>, defined in
<cite><a data-matched-text="[[[CID]]]" href="https://www.w3.org/TR/cid-1.0/">Controlled Identifiers v1.0</a></cite>, is used to express public keys for the cryptographic
suites defined in this specification.
          </p>

          <p>
The <code>publicKeyMultibase</code> value of the verification method <em class="rfc2119">MUST</em> start with the
base-58-btc prefix (<code>z</code>), as defined in the
<a href="https://www.w3.org/TR/cid-1.0/#multibase-0">Multibase section</a> of
<cite><a data-matched-text="[[[CID]]]" href="https://www.w3.org/TR/cid-1.0/">Controlled Identifiers v1.0</a></cite>. A Multibase-encoded Ed25519 256-bit public key value
follows, as defined in the
<a href="https://www.w3.org/TR/cid-1.0/#Multikey">Multikey section</a> of
<cite><a data-matched-text="[[[CID]]]" href="https://www.w3.org/TR/cid-1.0/">Controlled Identifiers v1.0</a></cite>. Any other encoding <em class="rfc2119">MUST NOT</em> be allowed.
          </p>

          <p class="advisement">
Developers are advised to not accidentally publish a representation of a private
key. Implementations of this specification will raise errors if they encounter a
Multikey prefix value other than <code>0xed01</code> in a <code>publicKeyMultibase</code> value.
          </p>

          <div class="example" id="example-an-ed25519-public-key-encoded-as-a-multikey">
        <div class="marker">
    <a class="self-link" href="#example-an-ed25519-public-key-encoded-as-a-multikey">Example<bdi> 1</bdi></a><span class="example-title">: An Ed25519 public key encoded as a Multikey</span>
  </div> <pre class="nohighlight">{
  "id": "https://example.com/issuer/123#key-0",
  "type": "Multikey",
  "controller": "https://example.com/issuer/123",
  "publicKeyMultibase": "z6Mkf5rGMoatrSj1f4CyvuHBeXJELe9RPdzo2PKGNCKVtZxP"
}</pre>
      </div>

          <div class="example" id="example-an-ed25519-public-key-encoded-as-a-multikey-in-a-controller-document">
        <div class="marker">
    <a class="self-link" href="#example-an-ed25519-public-key-encoded-as-a-multikey-in-a-controller-document">Example<bdi> 2</bdi></a><span class="example-title">: An Ed25519 public key encoded as a
            Multikey in a controller document</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/multikey/v1"
  ],
  "id": "did:example:123",
  "verificationMethod": [{
    "id": "did:example:123#key-0",
    "type": "Multikey",
    "controller": "did:example:123",
    "publicKeyMultibase": "z6Mkf5rGMoatrSj1f4CyvuHBeXJELe9RPdzo2PKGNCKVtZxP"
  }],
  "authentication": [
    "did:example:123#key-0"
  ],
  "assertionMethod": [
    "did:example:123#key-0"
  ],
  "capabilityDelegation": [
    "did:example:123#key-0"
  ],
  "capabilityInvocation": [
    "did:example:123#key-0"
  ]
}</pre>
      </div>

          <p>
The <code>secretKeyMultibase</code> value of the verification method <em class="rfc2119">MUST</em> start with the
base-58-btc prefix (<code>z</code>), as defined in the
<a href="https://www.w3.org/TR/cid-1.0/#multibase-0">Multibase section</a> of
<cite><a data-matched-text="[[[CID]]]" href="https://www.w3.org/TR/cid-1.0/">Controlled Identifiers v1.0</a></cite>. A Multibase-encoded Ed25519 256-bit secret key value
follows, as defined in the
<a href="https://www.w3.org/TR/cid-1.0/#Multikey">Multikey section</a> of
<cite><a data-matched-text="[[[CID]]]" href="https://www.w3.org/TR/cid-1.0/">Controlled Identifiers v1.0</a></cite>. Any other encoding <em class="rfc2119">MUST NOT</em> be allowed.
          </p>

          <p class="advisement">
Developers are advised to prevent accidental publication of a representation of
a secret key, and to not export the <code>secretKeyMultibase</code> property by default,
when serializing key pairs to Multikey.
          </p>

        </section>

      </section>

      <section id="proof-representations"><div class="header-wrapper"><h3 id="x2-2-proof-representations"><bdi class="secno">2.2 </bdi>Proof Representations</h3><a class="self-link" href="#proof-representations" aria-label="Permalink for Section 2.2"></a></div>
        

        <p>
This section details the proof representation formats that are defined by
this specification.
        </p>

        <section id="dataintegrityproof"><div class="header-wrapper"><h4 id="x2-2-1-dataintegrityproof"><bdi class="secno">2.2.1 </bdi>DataIntegrityProof</h4><a class="self-link" href="#dataintegrityproof" aria-label="Permalink for Section 2.2.1"></a></div>
          

          <p>
A proof contains the attributes specified in the
<a href="https://www.w3.org/TR/vc-data-integrity/#proofs">Proofs section</a>
of [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>] with the following restrictions.
          </p>
          <p>
The <code>type</code> property <em class="rfc2119">MUST</em> be <code>DataIntegrityProof</code>.
          </p>
          <p>
The <code>cryptosuite</code> property of the proof <em class="rfc2119">MUST</em> be <code>eddsa-rdfc-2022</code> or <code>eddsa-jcs-2022</code>.
          </p>
          <p>
The <code>proofValue</code> property of the proof <em class="rfc2119">MUST</em> be a detached EdDSA signature
produced according to [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>], encoded using the base-58-btc header and
alphabet as described in the
<a href="https://www.w3.org/TR/cid-1.0/#multibase-0">Multibase section</a> of
<cite><a data-matched-text="[[[CID]]]" href="https://www.w3.org/TR/cid-1.0/">Controlled Identifiers v1.0</a></cite>.
          </p>

          <div class="example" id="example-an-ed25519-digital-signature-expressed-as-a-dataintegrityproof">
        <div class="marker">
    <a class="self-link" href="#example-an-ed25519-digital-signature-expressed-as-a-dataintegrityproof">Example<bdi> 3</bdi></a><span class="example-title">: An Ed25519 digital signature expressed as a
              DataIntegrityProof</span>
  </div> <pre class="nohighlight">{
  "@context": [
    {"myWebsite": "https://vocabulary.example/myWebsite"},
    "https://www.w3.org/ns/credentials/v2"
  ],
  "myWebsite": "https://hello.world.example/",
  "proof": {
    "type": "DataIntegrityProof",
    "cryptosuite": "eddsa-rdfc-2022",
    "created": "2023-02-24T23:36:38Z",
    "verificationMethod": "https://vc.example/issuers/5678#z6MkrJVnaZkeFzdQyMZu1
      cgjg7k1pZZ6pvBQ7XJPt4swbTQ2",
    "proofPurpose": "assertionMethod",
    "proofValue": "z5C5b1uzYJN6pDR3aWgAqUMoSB1JY29epA74qyjaie9qh4okm9DZP6y77eTNq
      5NfYyMwNu9bpQQWUHKH5zAmEtszK"
  }
}</pre>
      </div>

        </section>

      </section>
    </section>

    <section id="algorithms"><div class="header-wrapper"><h2 id="x3-algorithms"><bdi class="secno">3. </bdi>Algorithms</h2><a class="self-link" href="#algorithms" aria-label="Permalink for Section 3."></a></div>
      

      <p>
The following section describes multiple Data Integrity cryptographic suites
that use the Edwards-Curve Digital Signature Algorithm.
      </p>

      <section id="instantiate-cryptosuite"><div class="header-wrapper"><h3 id="x3-1-instantiate-cryptosuite"><bdi class="secno">3.1 </bdi>Instantiate Cryptosuite</h3><a class="self-link" href="#instantiate-cryptosuite" aria-label="Permalink for Section 3.1"></a></div>
        

        <p>
This algorithm is used to configure a cryptographic suite to be used by the
<a href="https://www.w3.org/TR/vc-data-integrity/#add-proof">Add Proof</a> and
<a href="https://www.w3.org/TR/vc-data-integrity/#verify-proof">Verify Proof</a>
functions in <cite><a data-matched-text="[[[VC-DATA-INTEGRITY]]]" href="https://www.w3.org/TR/vc-data-integrity/">Verifiable Credential Data Integrity 1.0</a></cite>. The algorithm takes an options object
(<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>options</var>) as input and returns a <a data-link-type="dfn" data-lt="data integrity cryptographic suite instance" href="https://www.w3.org/TR/vc-data-integrity/#dfn-data-integrity-cryptographic-suite-instance">cryptosuite instance</a> (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct">struct</a> <var>cryptosuite</var>).
        </p>

        <ol class="algorithm">
          <li>
Initialize <var>cryptosuite</var> to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct">struct</a>.
          </li>
          <li>
If <var>options</var>.<var>type</var> does not equal <code>DataIntegrityProof</code>, return <var>cryptosuite</var>.
          </li>
          <li>
If <var>options</var>.<var>cryptosuite</var> is <code>eddsa-rdfc-2022</code>:
            <ol class="algorithm">
              <li>
Set <var>cryptosuite</var>.<var>createProof</var> to the algorithm in Section
<a href="#create-proof-eddsa-rdfc-2022" data-matched-text="[[[#create-proof-eddsa-rdfc-2022]]]" class="sec-ref"><bdi class="secno">3.2.1 </bdi>Create Proof (eddsa-rdfc-2022)</a>.
              </li>
              <li>
Set <var>cryptosuite</var>.<var>verifyProof</var> to the algorithm in Section
<a href="#verify-proof-eddsa-rdfc-2022" data-matched-text="[[[#verify-proof-eddsa-rdfc-2022]]]" class="sec-ref"><bdi class="secno">3.2.2 </bdi>Verify Proof (eddsa-rdfc-2022)</a>.
              </li>
            </ol>
          </li>
          <li>
If <var>options</var>.<var>cryptosuite</var> is <code>eddsa-jcs-2022</code>:
            <ol class="algorithm">
              <li>
Set <var>cryptosuite</var>.<var>createProof</var> to the algorithm in Section
<a href="#create-proof-eddsa-jcs-2022" data-matched-text="[[[#create-proof-eddsa-jcs-2022]]]" class="sec-ref"><bdi class="secno">3.3.1 </bdi>Create Proof (eddsa-jcs-2022)</a>.
              </li>
              <li>
Set <var>cryptosuite</var>.<var>verifyProof</var> to the algorithm in Section
<a href="#verify-proof-eddsa-jcs-2022" data-matched-text="[[[#verify-proof-eddsa-jcs-2022]]]" class="sec-ref"><bdi class="secno">3.3.2 </bdi>Verify Proof (eddsa-jcs-2022)</a>.
              </li>
            </ol>
          </li>
          <li>
Return <var>cryptosuite</var>.
          </li>
        </ol>

      </section>

      <section id="eddsa-rdfc-2022"><div class="header-wrapper"><h3 id="x3-2-eddsa-rdfc-2022"><bdi class="secno">3.2 </bdi>eddsa-rdfc-2022</h3><a class="self-link" href="#eddsa-rdfc-2022" aria-label="Permalink for Section 3.2"></a></div>
        

        <p>
The <code>eddsa-rdfc-2022</code> cryptographic suite takes an input document, canonicalizes
the document using the RDF Dataset Canonicalization algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-canon" title="RDF Dataset Canonicalization">RDF-CANON</a></cite>], and then
cryptographically hashes and signs the output
resulting in the production of a data integrity proof. The algorithms in this
section also include the verification of such a data integrity proof.
        </p>

        <p class="advisement">
When the RDF Dataset Canonicalization Algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-canon" title="RDF Dataset Canonicalization">RDF-CANON</a></cite>] is used,
implementations will detect <a href="https://www.w3.org/TR/rdf-canon/#dataset-poisoning">
dataset poisoning</a> by default, and abort processing upon such detection.
        </p>

        <section id="create-proof-eddsa-rdfc-2022"><div class="header-wrapper"><h4 id="x3-2-1-create-proof-eddsa-rdfc-2022"><bdi class="secno">3.2.1 </bdi>Create Proof (eddsa-rdfc-2022)</h4><a class="self-link" href="#create-proof-eddsa-rdfc-2022" aria-label="Permalink for Section 3.2.1"></a></div>
          

          <p>
The following algorithm specifies how to create a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-data-integrity-proof">data integrity proof</a> given
an <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-unsecured-data-document">unsecured data document</a>. Required inputs are an
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-unsecured-data-document">unsecured data document</a> (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>unsecuredDocument</var>), and a set of proof
options (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>options</var>). A <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-data-integrity-proof">data integrity proof</a> (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>), or an error,
is produced as output.
          </p>

          <ol class="algorithm">
            <li>
Let <var>proof</var> be a clone of the proof options, <var>options</var>.
            </li>
            <li>
Let <var>proofConfig</var> be the result of running the algorithm in
Section <a href="#proof-configuration-eddsa-rdfc-2022" data-matched-text="[[[#proof-configuration-eddsa-rdfc-2022]]]" class="sec-ref"><bdi class="secno">3.2.5 </bdi>Proof Configuration (eddsa-rdfc-2022)</a> with
<var>options</var> passed as a parameter.
            </li>
            <li>
Let <var>transformedData</var> be the result of running the algorithm in Section <a href="#transformation-eddsa-rdfc-2022" class="sec-ref"><bdi class="secno">3.2.3 </bdi>Transformation (eddsa-rdfc-2022)</a> with <var>unsecuredDocument</var>,
<var>proofConfig</var>, and <var>options</var> passed as parameters.
            </li>
            <li>
Let <var>hashData</var> be the result of running the algorithm in Section
<a href="#hashing-eddsa-rdfc-2022" data-matched-text="[[[#hashing-eddsa-rdfc-2022]]]" class="sec-ref"><bdi class="secno">3.2.4 </bdi>Hashing (eddsa-rdfc-2022)</a> with <var>transformedData</var> and <var>proofConfig</var>
passed as a parameters.
            </li>
            <li>
Let <var>proofBytes</var> be the result of running the algorithm in Section
<a href="#proof-serialization-eddsa-rdfc-2022" data-matched-text="[[[#proof-serialization-eddsa-rdfc-2022]]]" class="sec-ref"><bdi class="secno">3.2.6 </bdi>Proof Serialization (eddsa-rdfc-2022)</a> with <var>hashData</var> and
<var>options</var> passed as parameters.
            </li>
            <li>
Let <var>proof</var>.<var>proofValue</var> be a <a href="https://www.w3.org/TR/cid-1.0/#multibase-0">
base58-btc-encoded Multibase value</a> of the <var>proofBytes</var>.
            </li>
            <li>
Return <var>proof</var> as the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-data-integrity-proof">data integrity proof</a>.
            </li>
          </ol>

        </section>

        <section id="verify-proof-eddsa-rdfc-2022"><div class="header-wrapper"><h4 id="x3-2-2-verify-proof-eddsa-rdfc-2022"><bdi class="secno">3.2.2 </bdi>Verify Proof (eddsa-rdfc-2022)</h4><a class="self-link" href="#verify-proof-eddsa-rdfc-2022" aria-label="Permalink for Section 3.2.2"></a></div>
          

          <p>
The following algorithm specifies how to verify a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-data-integrity-proof">data integrity proof</a> given
an <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-secured-data-document">secured data document</a>. Required inputs are an
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-secured-data-document">secured data document</a> (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>securedDocument</var>). This algorithm returns
a <dfn id="dfn-verification-result" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verification result</dfn>, which is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct">struct</a> whose
<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item">items</a> are:
          </p>
          <dl>
            <dt><dfn data-dfn-for="verification result" id="dfn-verified" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verified</dfn></dt>
            <dd><code>true</code> or <code>false</code></dd>
            <dt><dfn data-dfn-for="verification result" id="dfn-verifieddocument" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verifiedDocument</dfn></dt>
            <dd>
if <a data-link-type="dfn|abstract-op" href="#dfn-verified" class="internalDFN" id="ref-for-dfn-verified-1">verified</a> is <code>false</code>, <a href="https://infra.spec.whatwg.org/#nulls">Null</a>;
otherwise, an <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-unsecured-data-document">unsecured data document</a>
            </dd>
          </dl>

          <ol class="algorithm">
          <li>
Let <var>unsecuredDocument</var> be a copy of <var>securedDocument</var> with
the <code>proof</code> value removed.
          </li>
          <li>
Let <var>proofOptions</var> be the result of a copy of <var>securedDocument</var>.<var>proof</var> with <code>proofValue</code>
removed.
          </li>
          <li>
Let <var>proofBytes</var> be the
<a href="https://www.w3.org/TR/cid-1.0/#multibase-0">Multibase decoded base58-btc
value</a> in <var>securedDocument</var>.<var>proof</var>.<var>proofValue</var>.
          </li>
          <li>
Let <var>transformedData</var> be the result of running the algorithm in Section <a href="#transformation-eddsa-rdfc-2022" class="sec-ref"><bdi class="secno">3.2.3 </bdi>Transformation (eddsa-rdfc-2022)</a> with <var>unsecuredDocument</var> and
<var>proofOptions</var> passed as parameters.
          </li>
          <li>
Let <var>proofConfig</var> be the result of running the algorithm in Section <a href="#proof-configuration-eddsa-rdfc-2022" class="sec-ref"><bdi class="secno">3.2.5 </bdi>Proof Configuration (eddsa-rdfc-2022)</a> with <var>unsecuredDocument</var> and
<var>proofOptions</var> passed as parameters.
          </li>
          <li>
Let <var>hashData</var> be the result of running the algorithm in Section
<a href="#hashing-eddsa-rdfc-2022" data-matched-text="[[[#hashing-eddsa-rdfc-2022]]]" class="sec-ref"><bdi class="secno">3.2.4 </bdi>Hashing (eddsa-rdfc-2022)</a> with <var>transformedData</var> and <var>proofConfig</var>
passed as a parameters.
          </li>
          <li>
Let <var data-type="boolean">verified</var> be the result of running the algorithm in Section
<a href="#proof-verification-eddsa-rdfc-2022" data-matched-text="[[[#proof-verification-eddsa-rdfc-2022]]]" class="sec-ref"><bdi class="secno">3.2.7 </bdi>Proof Verification (eddsa-rdfc-2022)</a> algorithm on <var>hashData</var>,
<var>proofBytes</var>, and <var>proofConfig</var>.
            </li>
            <li>
Return a <a data-link-type="dfn|abstract-op" href="#dfn-verification-result" class="internalDFN" id="ref-for-dfn-verification-result-1">verification result</a> with <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item">items</a>:
              <dl data-link-for="verification result">
                <dt><a data-link-type="dfn|abstract-op" href="#dfn-verified" class="internalDFN" id="ref-for-dfn-verified-2">verified</a></dt>
                <dd><var data-type="boolean">verified</var></dd>
                <dt><a data-link-type="dfn|abstract-op" href="#dfn-verifieddocument" class="internalDFN" id="ref-for-dfn-verifieddocument-1">verifiedDocument</a></dt>
                <dd>
if <var data-type="boolean">verified</var> is <code>true</code>, <var>unsecuredDocument</var>;
otherwise, <a href="https://infra.spec.whatwg.org/#nulls">Null</a></dd>
              </dl>
            </li>
          </ol>

        </section>

        <section id="transformation-eddsa-rdfc-2022"><div class="header-wrapper"><h4 id="x3-2-3-transformation-eddsa-rdfc-2022"><bdi class="secno">3.2.3 </bdi>Transformation (eddsa-rdfc-2022)</h4><a class="self-link" href="#transformation-eddsa-rdfc-2022" aria-label="Permalink for Section 3.2.3"></a></div>
          

          <p>
The following algorithm specifies how to transform an unsecured input document
into a transformed document that is ready to be provided as input to the
hashing algorithm in Section <a href="#hashing-eddsa-rdfc-2022" data-matched-text="[[[#hashing-eddsa-rdfc-2022]]]" class="sec-ref"><bdi class="secno">3.2.4 </bdi>Hashing (eddsa-rdfc-2022)</a>.
          </p>

          <p>
Required inputs to this algorithm are an
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-unsecured-data-document">
unsecured data document</a> (<code>unsecuredDocument</code>) and
transformation options (<code>options</code>). The
transformation options <em class="rfc2119">MUST</em> contain a type identifier for the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-cryptosuite">
cryptographic suite</a> (<code>type</code>) and a cryptosuite
identifier (<code>cryptosuite</code>). A <em>transformed data document</em> is
produced as output. Whenever this algorithm encodes strings, it <em class="rfc2119">MUST</em> use UTF-8
encoding.
          </p>

          <ol class="algorithm">
            <li>
If <code>options</code>.<code>type</code> is not set to the string
<code>DataIntegrityProof</code> and <code>options</code>.<code>cryptosuite</code> is not
set to the string <code>eddsa-rdfc-2022</code>,
an error <em class="rfc2119">MUST</em> be raised that <em class="rfc2119">SHOULD</em> convey an error type of
<a href="https://www.w3.org/TR/vc-data-integrity/#PROOF_TRANSFORMATION_ERROR">PROOF_TRANSFORMATION_ERROR</a>.
            </li>
            <li>
Let <var>canonicalDocument</var> be the result of converting <var>unsecuredDocument</var>
<a href="https://www.w3.org/TR/json-ld11-api/#deserialize-json-ld-to-rdf-algorithm">
to RDF statements</a>, applying the <a href="https://www.w3.org/TR/rdf-canon/#canon-algorithm">RDF Dataset Canonicalization
Algorithm</a>&nbsp;[<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-canon" title="RDF Dataset Canonicalization">RDF-CANON</a></cite>] to the result, and then serializing the result to a
<a href="https://www.w3.org/TR/rdf-canon/#dfn-serialized-canonical-form">serialized canonical form</a>&nbsp;[<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-canon" title="RDF Dataset Canonicalization">RDF-CANON</a></cite>].
            </li>
            <li>
Return <code>canonicalDocument</code> as the <em>transformed data document</em>.
            </li>
          </ol>
        </section>

        <section id="hashing-eddsa-rdfc-2022"><div class="header-wrapper"><h4 id="x3-2-4-hashing-eddsa-rdfc-2022"><bdi class="secno">3.2.4 </bdi>Hashing (eddsa-rdfc-2022)</h4><a class="self-link" href="#hashing-eddsa-rdfc-2022" aria-label="Permalink for Section 3.2.4"></a></div>
          

          <p>
The following algorithm specifies how to cryptographically hash a
<em>transformed data document</em> and <em>proof configuration</em>
into cryptographic hash data that is ready to be provided as input to the
algorithms in Section <a href="#proof-serialization-eddsa-rdfc-2022" data-matched-text="[[[#proof-serialization-eddsa-rdfc-2022]]]" class="sec-ref"><bdi class="secno">3.2.6 </bdi>Proof Serialization (eddsa-rdfc-2022)</a> or
Section <a href="#proof-verification-eddsa-rdfc-2022" data-matched-text="[[[#proof-verification-eddsa-rdfc-2022]]]" class="sec-ref"><bdi class="secno">3.2.7 </bdi>Proof Verification (eddsa-rdfc-2022)</a>.
          </p>

          <p>
The required inputs to this algorithm are a <em>transformed data document</em>
(<code>transformedDocument</code>) and <em>canonical proof configuration</em>
(<code>canonicalProofConfig</code>). A single <em>hash data</em> value represented as
series of bytes is produced as output.
          </p>

          <ol class="algorithm">
            <li>
Let <code>proofConfigHash</code> be the result of applying the
SHA-256 (SHA-2 with 256-bit output) cryptographic hashing algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6234" title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">RFC6234</a></cite>]
to the <code>canonicalProofConfig</code>. <code>proofConfigHash</code> will be
exactly 32 bytes in size.
            </li>
            <li>
Let <code>transformedDocumentHash</code> be the result of applying the
SHA-256 (SHA-2 with 256-bit output) cryptographic hashing algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6234" title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">RFC6234</a></cite>]
to the <code>transformedDocument</code>. <code>transformedDocumentHash</code> will
be exactly 32 bytes in size.
            </li>
            <li>
Let <code>hashData</code> be the result of concatenating <code>proofConfigHash</code>
(the first hash produced above) followed by <code>transformedDocumentHash</code>
(the second hash produced above).
            </li>
            <li>
Return <code>hashData</code> as the <em>hash data</em>.
            </li>
          </ol>

        </section>

        <section id="proof-configuration-eddsa-rdfc-2022"><div class="header-wrapper"><h4 id="x3-2-5-proof-configuration-eddsa-rdfc-2022"><bdi class="secno">3.2.5 </bdi>Proof Configuration (eddsa-rdfc-2022)</h4><a class="self-link" href="#proof-configuration-eddsa-rdfc-2022" aria-label="Permalink for Section 3.2.5"></a></div>
          

          <p>
The following algorithm specifies how to generate a
<em>proof configuration</em> from a set of <em>proof options</em>
that is used as input to the <a href="#hashing-eddsa-rdfc-2022">proof hashing algorithm</a>.
          </p>

          <p>
The required inputs to this algorithm are the <em>document</em>
(<var>unsecuredDocument</var>) and the <em>proof options</em>
(<code>options</code>). The <em>proof options</em> <em class="rfc2119">MUST</em> contain a type identifier
for the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-cryptosuite">
cryptographic suite</a> (<code>type</code>) and <em class="rfc2119">MUST</em> contain a cryptosuite
identifier (<code>cryptosuite</code>). A <em>proof configuration</em>
object is produced as output.
          </p>
          <ol class="algorithm">
            <li>
Let <var>proofConfig</var> be a clone of the <var>options</var> object.
            </li>
            <li>
If <var>proofConfig</var>.<var>type</var> is not set to <code>DataIntegrityProof</code> and/or
<var>proofConfig</var>.<var>cryptosuite</var> is not set to <code>eddsa-rdfc-2022</code>, an
error <em class="rfc2119">MUST</em> be raised and <em class="rfc2119">SHOULD</em> convey an error type of
<a href="https://www.w3.org/TR/vc-data-integrity/#PROOF_GENERATION_ERROR">PROOF_GENERATION_ERROR</a>.
            </li>
            <li>
If <var>proofConfig</var>.<var>created</var> is present and set to a value that is not a
valid [<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlschema11-2" title="W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes">XMLSCHEMA11-2</a></cite>] datetime, an error <em class="rfc2119">MUST</em> be
raised and <em class="rfc2119">SHOULD</em> convey an error type of
<a href="https://www.w3.org/TR/vc-data-integrity/#PROOF_GENERATION_ERROR">PROOF_GENERATION_ERROR</a>.
            </li>
            <li>
Set <var>proofConfig</var>.<code>@context </code>to
<var>unsecuredDocument</var>.<var>@context</var>.
            </li>
            <li>
Let <var>canonicalProofConfig</var> be the result of applying the
RDF Dataset Canonicalization Algorithm
[<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-canon" title="RDF Dataset Canonicalization">RDF-CANON</a></cite>] to the <var>proofConfig</var>.
            </li>
            <li>
Return <var>canonicalProofConfig</var>.
            </li>
          </ol>

        </section>

        <section id="proof-serialization-eddsa-rdfc-2022"><div class="header-wrapper"><h4 id="x3-2-6-proof-serialization-eddsa-rdfc-2022"><bdi class="secno">3.2.6 </bdi>Proof Serialization (eddsa-rdfc-2022)</h4><a class="self-link" href="#proof-serialization-eddsa-rdfc-2022" aria-label="Permalink for Section 3.2.6"></a></div>
          

          <p>
The following algorithm specifies how to serialize a digital signature from
a set of cryptographic hash data. This
algorithm is designed to be used in conjunction with the algorithms defined
in the Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>] specification,
<a href="https://www.w3.org/TR/vc-data-integrity/#algorithms">
Section 4: Algorithms</a>. Required inputs are
cryptographic hash data (<code>hashData</code>) and
<em>proof options</em> (<code>options</code>). The
<em>proof options</em> <em class="rfc2119">MUST</em> contain a type identifier for the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-cryptosuite">
cryptographic suite</a> (<code>type</code>) and <em class="rfc2119">MAY</em> contain a cryptosuite
identifier (<code>cryptosuite</code>). A single <em>digital proof</em> value
represented as series of bytes is produced as output.
          </p>

          <ol class="algorithm">
            <li>
Let <var>privateKeyBytes</var> be the result of retrieving the
private key bytes (or a signing interface enabling the use of the private key
bytes) associated with the verification method identified by the
<var>options</var>.<var>verificationMethod</var> value.
            </li>
            <li>
Let <code>proofBytes</code> be the result of applying the Edwards-Curve Digital
Signature Algorithm (EdDSA) [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>], using the <code>Ed25519</code> variant
(Pure EdDSA), with <code>hashData</code> as the data to be signed using
the private key specified by <code>privateKeyBytes</code>.
<code>proofBytes</code> will be exactly 64 bytes in size.
            </li>
            <li>
Return <code>proofBytes</code> as the <em>digital proof</em>.
            </li>
          </ol>

        </section>

        <section id="proof-verification-eddsa-rdfc-2022"><div class="header-wrapper"><h4 id="x3-2-7-proof-verification-eddsa-rdfc-2022"><bdi class="secno">3.2.7 </bdi>Proof Verification (eddsa-rdfc-2022)</h4><a class="self-link" href="#proof-verification-eddsa-rdfc-2022" aria-label="Permalink for Section 3.2.7"></a></div>
          

          <p>
The following algorithm specifies how to verify a digital signature from
a set of cryptographic hash data. This
algorithm is designed to be used in conjunction with the algorithms defined
in the Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>] specification,
<a href="https://www.w3.org/TR/vc-data-integrity/#algorithms">
Section 4: Algorithms</a>. Required inputs are
cryptographic hash data (<code>hashData</code>),
a digital signature (<code>proofBytes</code>) and
proof options (<code>options</code>). A <em>verification result</em>
represented as a boolean value is produced as output.
          </p>

          <ol class="algorithm">
            <li>
Let <code>publicKeyBytes</code> be the result of retrieving the
public key bytes associated with the
<code>options</code>.<code>verificationMethod</code> value as described in the
<a href="https://www.w3.org/TR/cid-1.0/#retrieve-verification-method">Retrieve
Verification Method</a> section of the <cite><a data-matched-text="[[[CID]]]" href="https://www.w3.org/TR/cid-1.0/">Controlled Identifiers v1.0</a></cite> specification.
            </li>
            <li>
Let <code>verificationResult</code> be the result of applying the verification
algorithm for the Edwards-Curve Digital Signature Algorithm (EdDSA)
[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>], using the <code>Ed25519</code> variant (Pure EdDSA),
with <code>hashData</code> as the data to be verified against the
<code>proofBytes</code> using the public key specified by
<code>publicKeyBytes</code>.
            </li>
            <li>
Return <code>verificationResult</code> as the <em>verification result</em>.
            </li>
          </ol>

        </section>
      </section>

      <section id="eddsa-jcs-2022"><div class="header-wrapper"><h3 id="x3-3-eddsa-jcs-2022"><bdi class="secno">3.3 </bdi>eddsa-jcs-2022</h3><a class="self-link" href="#eddsa-jcs-2022" aria-label="Permalink for Section 3.3"></a></div>
        

          <p>
The <code>eddsa-jcs-2022</code> cryptographic suite takes an input document, canonicalizes
the document using the JSON Canonicalization Scheme [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8785" title="JSON Canonicalization Scheme (JCS)">RFC8785</a></cite>], and then
cryptographically hashes and signs the output resulting in the production of a
data integrity proof.
          </p>



          <section id="create-proof-eddsa-jcs-2022"><div class="header-wrapper"><h4 id="x3-3-1-create-proof-eddsa-jcs-2022"><bdi class="secno">3.3.1 </bdi>Create Proof (eddsa-jcs-2022)</h4><a class="self-link" href="#create-proof-eddsa-jcs-2022" aria-label="Permalink for Section 3.3.1"></a></div>
            

            <p>
The following algorithm specifies how to create a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-data-integrity-proof">data integrity proof</a> given
an <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-unsecured-data-document">unsecured data document</a>. Required inputs are an
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-unsecured-data-document">unsecured data document</a> (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>unsecuredDocument</var>), and a set of proof
options (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>options</var>). A <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-data-integrity-proof">data integrity proof</a> (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a>), or an error,
is produced as output.
            </p>

            <ol class="algorithm">
              <li>
Let <var>proof</var> be a clone of the proof options, <var>options</var>.
              </li>
              <li>
If <code>unsecuredDocument</code>.<var>@context</var> is present,
set <code>proof</code>.<var>@context</var> to
<code>unsecuredDocument</code>.<var>@context</var>.
              </li>
              <li>
Let <var>proofConfig</var> be the result of running the algorithm in
Section <a href="#proof-configuration-eddsa-jcs-2022" data-matched-text="[[[#proof-configuration-eddsa-jcs-2022]]]" class="sec-ref"><bdi class="secno">3.3.5 </bdi>Proof Configuration (eddsa-jcs-2022)</a> with
<var>proof</var> passed as the <em>proof options</em> parameter.
              </li>
              <li>
Let <var>transformedData</var> be the result of running the algorithm in Section
<a href="#transformation-eddsa-jcs-2022" data-matched-text="[[[#transformation-eddsa-jcs-2022]]]" class="sec-ref"><bdi class="secno">3.3.3 </bdi>Transformation (eddsa-jcs-2022)</a> with <var>unsecuredDocument</var>
and <var>options</var> passed as parameters.
              </li>
              <li>
Let <var>hashData</var> be the result of running the algorithm in Section
<a href="#hashing-eddsa-jcs-2022" data-matched-text="[[[#hashing-eddsa-jcs-2022]]]" class="sec-ref"><bdi class="secno">3.3.4 </bdi>Hashing (eddsa-jcs-2022)</a> with <var>transformedData</var> and <var>proofConfig</var>
passed as a parameters.
              </li>
              <li>
Let <var>proofBytes</var> be the result of running the algorithm in Section
<a href="#proof-serialization-eddsa-jcs-2022" data-matched-text="[[[#proof-serialization-eddsa-jcs-2022]]]" class="sec-ref"><bdi class="secno">3.3.6 </bdi>Proof Serialization (eddsa-jcs-2022)</a> with <var>hashData</var> and
<var>options</var> passed as parameters.
              </li>
              <li>
Let <var>proof</var>.<var>proofValue</var> be a <a href="https://www.w3.org/TR/cid-1.0/#multibase-0">
base58-btc-encoded Multibase value</a> of the <var>proofBytes</var>.
              </li>
              <li>
Return <var>proof</var> as the <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-data-integrity-proof">data integrity proof</a>.
              </li>
            </ol>

            <div class="note" role="note" id="issue-container-generatedID"><div role="heading" class="note-title marker" id="h-note" aria-level="5"><span>Note</span><span class="issue-label">: Not implementing step 2 can lead to interoperability failures</span></div><p class="">
Implementers are warned that while step 2 is not strictly necessary when
generating proofs that will not be included in a proof set or a proof chain,
that it is not always possible to be certain of where generated proofs will be
used, or how they might be combined with other proofs at the application layer.
It is strongly advised to always implement step 2, though some implementers have
signaled that their software might not always implement step 2.
            </p></div>

          </section>

          <section id="verify-proof-eddsa-jcs-2022"><div class="header-wrapper"><h4 id="x3-3-2-verify-proof-eddsa-jcs-2022"><bdi class="secno">3.3.2 </bdi>Verify Proof (eddsa-jcs-2022)</h4><a class="self-link" href="#verify-proof-eddsa-jcs-2022" aria-label="Permalink for Section 3.3.2"></a></div>
            

          <p>
The following algorithm specifies how to verify a <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-data-integrity-proof">data integrity proof</a> given
an <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-secured-data-document">secured data document</a>. Required inputs are an
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-secured-data-document">secured data document</a> (<a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map">map</a> <var>securedDocument</var>). This algorithm returns
a <a data-link-type="dfn|abstract-op" href="#dfn-verification-result" class="internalDFN" id="ref-for-dfn-verification-result-2">verification result</a>, which is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct">struct</a> whose <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item">items</a> are:
          </p>
          <dl>
            <dt><a data-link-type="dfn|abstract-op" href="#dfn-verified" class="internalDFN" id="ref-for-dfn-verified-3">verified</a></dt>
            <dd><code>true</code> or <code>false</code></dd>
            <dt><a data-link-type="dfn|abstract-op" href="#dfn-verifieddocument" class="internalDFN" id="ref-for-dfn-verifieddocument-2">verifiedDocument</a></dt>
            <dd>
if <a data-link-type="dfn|abstract-op" href="#dfn-verified" class="internalDFN" id="ref-for-dfn-verified-4">verified</a> is <code>true</code>, an <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-integrity/#dfn-unsecured-data-document">unsecured data document</a>;
otherwise <a href="https://infra.spec.whatwg.org/#nulls">Null</a>
            </dd>
          </dl>

          <ol class="algorithm">
            <li>
Let <var>unsecuredDocument</var> be a copy of <var>securedDocument</var> with the <code>proof</code> value
removed.
            </li>
            <li>
Let <var>proofOptions</var> be the result of a copy of <var>securedDocument</var>.<var>proof</var> with
<code>proofValue</code> removed.
            </li>
            <li>
Let <var>proofBytes</var> be the
<a href="https://www.w3.org/TR/cid-1.0/#multibase-0">Multibase decoded base58-btc
value</a> in <var>securedDocument</var>.<var>proof</var>.<var>proofValue</var>.
            </li>
            <li>
If <var>proofOptions</var>.<var>@context</var> exists:
              <ol class="algorithm">
                <li>
Check that the <var>securedDocument</var>.<var>@context</var> starts with all values
contained in the <var>proofOptions</var>.<var>@context</var> in the same order.
Otherwise, set <var>verified</var> to <code>false</code> and skip to the last step.
                </li>
                <li>
Set <var>unsecuredDocument</var>.<var>@context</var> equal to
<var>proofOptions</var>.<var>@context</var>.
                </li>
              </ol>
            </li>
            <li>
Let <var>transformedData</var> be the result of running the algorithm in Section
<a href="#transformation-eddsa-jcs-2022" data-matched-text="[[[#transformation-eddsa-jcs-2022]]]" class="sec-ref"><bdi class="secno">3.3.3 </bdi>Transformation (eddsa-jcs-2022)</a> with <var>unsecuredDocument</var> and
<var>proofOptions</var> passed as parameters.
              </li>
            <li>
Let <var>proofConfig</var> be the result of running the algorithm in Section
<a href="#proof-configuration-eddsa-jcs-2022" data-matched-text="[[[#proof-configuration-eddsa-jcs-2022]]]" class="sec-ref"><bdi class="secno">3.3.5 </bdi>Proof Configuration (eddsa-jcs-2022)</a> with <var>proofOptions</var> passed
as the parameter.
            </li>
            <li>
Let <var>hashData</var> be the result of running the algorithm in Section
<a href="#hashing-eddsa-jcs-2022" data-matched-text="[[[#hashing-eddsa-jcs-2022]]]" class="sec-ref"><bdi class="secno">3.3.4 </bdi>Hashing (eddsa-jcs-2022)</a> with <var>transformedData</var> and <var>proofConfig</var> passed as
a parameters.
            </li>
            <li>
Let <var data-type="boolean">verified</var> be the result of running the algorithm in Section
<a href="#proof-verification-eddsa-jcs-2022" data-matched-text="[[[#proof-verification-eddsa-jcs-2022]]]" class="sec-ref"><bdi class="secno">3.3.7 </bdi>Proof Verification (eddsa-jcs-2022)</a> on <var>hashData</var>, <var>proofBytes</var>,
and <var>proofConfig</var>.
              </li>
              <li>
Return a <a data-link-type="dfn|abstract-op" href="#dfn-verification-result" class="internalDFN" id="ref-for-dfn-verification-result-3">verification result</a> with <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item">items</a>:
                <dl data-link-for="verification result">
                  <dt><a data-link-type="dfn|abstract-op" href="#dfn-verified" class="internalDFN" id="ref-for-dfn-verified-5">verified</a></dt>
                  <dd><var data-type="boolean">verified</var></dd>
                  <dt><a data-link-type="dfn|abstract-op" href="#dfn-verifieddocument" class="internalDFN" id="ref-for-dfn-verifieddocument-3">verifiedDocument</a></dt>
                  <dd>
if <var data-type="boolean">verified</var> is <code>true</code>, <var>unsecuredDocument</var>;
otherwise, <a href="https://infra.spec.whatwg.org/#nulls">Null</a></dd>
                </dl>
              </li>
            </ol>
        </section>
        <section id="transformation-eddsa-jcs-2022"><div class="header-wrapper"><h4 id="x3-3-3-transformation-eddsa-jcs-2022"><bdi class="secno">3.3.3 </bdi>Transformation (eddsa-jcs-2022)</h4><a class="self-link" href="#transformation-eddsa-jcs-2022" aria-label="Permalink for Section 3.3.3"></a></div>
          

          <p>
The following algorithm specifies how to transform an unsecured input document
into a transformed document that is ready to be provided as input to the
hashing algorithm in Section <a href="#hashing-eddsa-jcs-2022" data-matched-text="[[[#hashing-eddsa-jcs-2022]]]" class="sec-ref"><bdi class="secno">3.3.4 </bdi>Hashing (eddsa-jcs-2022)</a>.
          </p>

          <p>
Required inputs to this algorithm are an
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-unsecured-data-document">
unsecured data document</a> (<code>unsecuredDocument</code>) and
transformation options (<code>options</code>). The
transformation options <em class="rfc2119">MUST</em> contain a type identifier for the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-cryptosuite">
cryptographic suite</a> (<code>type</code>) and a cryptosuite
identifier (<code>cryptosuite</code>). A <em>transformed data document</em> is
produced as output. Whenever this algorithm encodes strings, it <em class="rfc2119">MUST</em> use UTF-8
encoding.
          </p>

          <ol class="algorithm">
            <li>
If <code>options</code>.<code>type</code> is not set to the string
<code>DataIntegrityProof</code> and <code>options</code>.<code>cryptosuite</code> is not
set to the string <code>eddsa-jcs-2022</code>,
an error <em class="rfc2119">MUST</em> be raised that <em class="rfc2119">SHOULD</em> convey an error type of
<a href="https://www.w3.org/TR/vc-data-integrity/#PROOF_VERIFICATION_ERROR">PROOF_VERIFICATION_ERROR</a>.
            </li>
            <li>
Let <code>canonicalDocument</code> be the result of applying the
JSON Canonicalization Scheme [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8785" title="JSON Canonicalization Scheme (JCS)">RFC8785</a></cite>] to a JSON serialization of the
<code>unsecuredDocument</code>.
            </li>
            <li>
Return <code>canonicalDocument</code> as the <em>transformed data document</em>.
            </li>
          </ol>
        </section>
        <section id="hashing-eddsa-jcs-2022"><div class="header-wrapper"><h4 id="x3-3-4-hashing-eddsa-jcs-2022"><bdi class="secno">3.3.4 </bdi>Hashing (eddsa-jcs-2022)</h4><a class="self-link" href="#hashing-eddsa-jcs-2022" aria-label="Permalink for Section 3.3.4"></a></div>
          

          <p>
The following algorithm specifies how to cryptographically hash a
<em>transformed data document</em> and <em>proof configuration</em>
into cryptographic hash data that is ready to be provided as input to the
algorithms in Section <a href="#proof-serialization-eddsa-jcs-2022" data-matched-text="[[[#proof-serialization-eddsa-jcs-2022]]]" class="sec-ref"><bdi class="secno">3.3.6 </bdi>Proof Serialization (eddsa-jcs-2022)</a> or
Section <a href="#proof-verification-eddsa-jcs-2022" data-matched-text="[[[#proof-verification-eddsa-jcs-2022]]]" class="sec-ref"><bdi class="secno">3.3.7 </bdi>Proof Verification (eddsa-jcs-2022)</a>.
          </p>

          <p>
The required inputs to this algorithm are a <em>transformed data document</em>
(<code>transformedDocument</code>) and <em>canonical proof configuration</em>
(<code>canonicalProofConfig</code>). A single <em>hash data</em> value represented as
series of bytes is produced as output.
          </p>

          <ol class="algorithm">
            <li>
Let <code>transformedDocumentHash</code> be the result of applying the
SHA-256 (SHA-2 with 256-bit output) cryptographic hashing algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6234" title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">RFC6234</a></cite>]
to the <code>transformedDocument</code>. <code>transformedDocumentHash</code> will
be exactly 32 bytes in size.
            </li>
            <li>
Let <code>proofConfigHash</code> be the result of applying the
SHA-256 (SHA-2 with 256-bit output) cryptographic hashing algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6234" title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">RFC6234</a></cite>]
to the <code>canonicalProofConfig</code>. <code>proofConfigHash</code> will be
exactly 32 bytes in size.
            </li>
            <li>
Let <code>hashData</code> be the result of joining <code>proofConfigHash</code> (the
first hash) with <code>transformedDocumentHash</code> (the second hash).
            </li>
            <li>
Return <code>hashData</code> as the <em>hash data</em>.
            </li>
          </ol>

        </section>
        <section id="proof-configuration-eddsa-jcs-2022"><div class="header-wrapper"><h4 id="x3-3-5-proof-configuration-eddsa-jcs-2022"><bdi class="secno">3.3.5 </bdi>Proof Configuration (eddsa-jcs-2022)</h4><a class="self-link" href="#proof-configuration-eddsa-jcs-2022" aria-label="Permalink for Section 3.3.5"></a></div>
          

          <p>
The following algorithm specifies how to generate a
<em>proof configuration</em> from a set of <em>proof options</em>
that is used as input to the <a href="#hashing-eddsa-jcs-2022">proof hashing algorithm</a>.
          </p>

          <p>
The required inputs to this algorithm are <em>proof options</em>
(<code>options</code>). The <em>proof options</em> <em class="rfc2119">MUST</em> contain a type identifier
for the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-cryptosuite">
cryptographic suite</a> (<code>type</code>) and <em class="rfc2119">MUST</em> contain a cryptosuite
identifier (<code>cryptosuite</code>). A <em>proof configuration</em>
object is produced as output.
          </p>

          <ol class="algorithm">
            <li>
Let <code>proofConfig</code> be a clone of the <code>options</code> object.
            </li>
            <li>
If <code>proofConfig</code>.<code>type</code> is not set to <code>DataIntegrityProof</code> or
<code>proofConfig</code>.<code>cryptosuite</code> is not set to <code>eddsa-jcs-2022</code>,
an error <em class="rfc2119">MUST</em> be raised that <em class="rfc2119">SHOULD</em> convey an error type of
<a href="https://www.w3.org/TR/vc-data-integrity/#PROOF_GENERATION_ERROR">PROOF_GENERATION_ERROR</a>.
            </li>
            <li>
If <var>proofConfig</var>.<var>created</var> is set to a value that is not a
valid [<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlschema11-2" title="W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes">XMLSCHEMA11-2</a></cite>] datetime, an error <em class="rfc2119">MUST</em> be
raised and <em class="rfc2119">SHOULD</em> convey an error type of
<a href="https://www.w3.org/TR/vc-data-integrity/#PROOF_GENERATION_ERROR">PROOF_GENERATION_ERROR</a>.
            </li>
            <li>
Let <code>canonicalProofConfig</code> be the result of applying the
JSON Canonicalization Scheme [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8785" title="JSON Canonicalization Scheme (JCS)">RFC8785</a></cite>] to the <code>proofConfig</code>.
            </li>
            <li>
Return <code>canonicalProofConfig</code>.
            </li>
          </ol>

        </section>
        <section id="proof-serialization-eddsa-jcs-2022"><div class="header-wrapper"><h4 id="x3-3-6-proof-serialization-eddsa-jcs-2022"><bdi class="secno">3.3.6 </bdi>Proof Serialization (eddsa-jcs-2022)</h4><a class="self-link" href="#proof-serialization-eddsa-jcs-2022" aria-label="Permalink for Section 3.3.6"></a></div>
          

          <p>
The following algorithm specifies how to serialize a digital signature from
a set of cryptographic hash data. This
algorithm is designed to be used in conjunction with the algorithms defined
in the Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>] specification,
<a href="https://www.w3.org/TR/vc-data-integrity/#algorithms">
Section 4: Algorithms</a>. Required inputs are
cryptographic hash data (<code>hashData</code>) and
<em>proof options</em> (<code>options</code>). The
<em>proof options</em> <em class="rfc2119">MUST</em> contain a type identifier for the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-cryptosuite">
cryptographic suite</a> (<code>type</code>) and <em class="rfc2119">MAY</em> contain a cryptosuite
identifier (<code>cryptosuite</code>). A single <em>digital proof</em> value
represented as series of bytes is produced as output.
          </p>

          <ol class="algorithm">
            <li>
Let <var>privateKeyBytes</var> be the result of retrieving the
private key bytes (or a signing interface enabling the use of the private key
bytes) associated with the verification method identified by the
<var>options</var>.<var>verificationMethod</var> value.
            </li>
            <li>
Let <code>proofBytes</code> be the result of applying the Edwards-Curve Digital
Signature Algorithm (EdDSA) [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>], using the <code>Ed25519</code> variant
(Pure EdDSA), with <code>hashData</code> as the data to be signed using
the private key specified by <code>privateKeyBytes</code>.
<code>proofBytes</code> will be exactly 64 bytes in size.
            </li>
            <li>
Return <code>proofBytes</code> as the <em>digital proof</em>.
            </li>
          </ol>

        </section>
        <section id="proof-verification-eddsa-jcs-2022"><div class="header-wrapper"><h4 id="x3-3-7-proof-verification-eddsa-jcs-2022"><bdi class="secno">3.3.7 </bdi>Proof Verification (eddsa-jcs-2022)</h4><a class="self-link" href="#proof-verification-eddsa-jcs-2022" aria-label="Permalink for Section 3.3.7"></a></div>
          

          <p>
The following algorithm specifies how to verify a digital signature from
a set of cryptographic hash data. This
algorithm is designed to be used in conjunction with the algorithms defined
in the Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>] specification,
<a href="https://www.w3.org/TR/vc-data-integrity/#algorithms">
Section 4: Algorithms</a>. Required inputs are
cryptographic hash data (<code>hashData</code>),
a digital signature (<code>proofBytes</code>) and
proof options (<code>options</code>). A <em>verification result</em>
represented as a boolean value is produced as output.
          </p>

          <ol class="algorithm">
            <li>
Let <code>publicKeyBytes</code> be the result of retrieving the
public key bytes associated with the
<code>options</code>.<code>verificationMethod</code> value as described in the
<a href="https://www.w3.org/TR/cid-1.0/#retrieve-verification-method">Retrieve
Verification Method</a> section of the <cite><a data-matched-text="[[[CID]]]" href="https://www.w3.org/TR/cid-1.0/">Controlled Identifiers v1.0</a></cite> specification.
            </li>
            <li>
Let <code>verificationResult</code> be the result of applying the verification
algorithm for the Edwards-Curve Digital Signature Algorithm (EdDSA)
[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>], using the <code>Ed25519</code> variant (Pure EdDSA),
with <code>hashData</code> as the data to be verified against the
<code>proofBytes</code> using the public key specified by
<code>publicKeyBytes</code>.
            </li>
            <li>
Return <code>verificationResult</code> as the <em>verification result</em>.
            </li>
          </ol>

        </section>
      </section>

    </section>

    <section id="security-considerations"><div class="header-wrapper"><h2 id="x4-security-considerations"><bdi class="secno">4. </bdi>Security Considerations</h2><a class="self-link" href="#security-considerations" aria-label="Permalink for Section 4."></a></div>
      

      <p class="advisement">
Before reading this section, readers are urged to familiarize themselves
with general security advice provided in the
<a href="https://www.w3.org/TR/vc-data-integrity/#security-considerations">
Security Considerations section of the Data Integrity specification</a>.
      </p>

      <p>
The following section describes security considerations that developers
implementing this specification should be aware of in order to create secure
software.
      </p>

      <section class="informative" id="security-properties-of-ed25519-implementations"><div class="header-wrapper"><h3 id="x4-1-security-properties-of-ed25519-implementations"><bdi class="secno">4.1 </bdi>Security Properties of Ed25519 Implementations</h3><a class="self-link" href="#security-properties-of-ed25519-implementations" aria-label="Permalink for Section 4.1"></a></div><p><em>This section is non-normative.</em></p>
        
        <p>
Ed25519 signatures (EdDSA algorithm with edwards25519 curve) have
been widely adopted, due both to the compact size of the keys and
signatures and to the speed at
which signatures can be produced and verified. Many libraries exist that can
create and verify Ed25519 signatures. Since the publication of [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>],
security properties of Ed25519 signatures have been rigorously proven (see
[<cite><a class="bibref" data-link-type="biblio" href="#bib-provable_ed25519" title="The Provable Security of Ed25519: Theory and Practice">Provable_Ed25519</a></cite>] and [<cite><a class="bibref" data-link-type="biblio" href="#bib-taming_eddsas" title="Taming the many EdDSAs">Taming_EdDSAs</a></cite>]). However, it has been observed that a
significant number of libraries do not achieve these security levels, due to
missing input validity checks during the signature verification process. In
this section, we summarize the security levels achievable with Ed25519
signatures, and indicate how one can determine whether a library will support those
levels.
        </p>
        <section id="signature-security-properties"><div class="header-wrapper"><h4 id="x4-1-1-signature-security-properties"><bdi class="secno">4.1.1 </bdi>Signature Security Properties</h4><a class="self-link" href="#signature-security-properties" aria-label="Permalink for Section 4.1.1"></a></div>
          
          <p>
Digital signatures might exhibit a number of desirable cryptographic
properties [<cite><a class="bibref" data-link-type="biblio" href="#bib-taming_eddsas" title="Taming the many EdDSAs">Taming_EdDSAs</a></cite>] among these are:
          </p>
          <p>
<strong>EUF-CMA</strong> (<em>existential unforgeability under
chosen message attacks</em>) is usually the minimal security property required
of a signature scheme. It guarantees that any efficient adversary who has the
public key
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mi>p</mi>
            <mi>k</mi>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math> of the signer and received an arbitrary number of signatures on
messages of its choice (in an adaptive manner):
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mo fence="false" stretchy="false">{</mo>
            <msub>
              <mi>m</mi>
              <mi>i</mi>
            </msub>
            <mo>,</mo>
            <msub>
              <mi>σ</mi>
              <mi>i</mi>
            </msub>
            <msubsup>
              <mo fence="false" stretchy="false">}</mo>
              <mrow data-mjx-texclass="ORD">
                <mi>i</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>N</mi>
            </msubsup>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>,
cannot output a valid signature
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <msup>
              <mi>σ</mi>
              <mo>∗</mo>
            </msup>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>
for a new message
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <msup>
              <mi>m</mi>
              <mo>∗</mo>
            </msup>
            <mo>∉</mo>
            <mo fence="false" stretchy="false">{</mo>
            <msub>
              <mi>m</mi>
              <mi>i</mi>
            </msub>
            <msubsup>
              <mo fence="false" stretchy="false">}</mo>
              <mrow data-mjx-texclass="ORD">
                <mi>i</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>N</mi>
            </msubsup>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>
(except with negligible probability). If the attacker outputs a valid
signature on a new message:
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mo stretchy="false">(</mo>
            <msup>
              <mi>m</mi>
              <mo>∗</mo>
            </msup>
            <mo>,</mo>
            <msup>
              <mi>σ</mi>
              <mo>∗</mo>
            </msup>
            <mo stretchy="false">)</mo>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>,
it is called an <em>existential
forgery</em>.
          </p>
          <p>
<strong>SUF-CMA</strong> (<em>strong unforgeability under chosen
message attacks</em>) is a stronger notion than <em>EUF-CMA</em>. It guarantees
that for any efficient adversary who has the public key
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mi>p</mi>
            <mi>k</mi>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>
of the signer and
received an arbitrary number of signatures on messages of its choice:
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mo fence="false" stretchy="false">{</mo>
            <msub>
              <mi>m</mi>
              <mi>i</mi>
            </msub>
            <mo>,</mo>
            <msub>
              <mi>σ</mi>
              <mi>i</mi>
            </msub>
            <msubsup>
              <mo fence="false" stretchy="false">}</mo>
              <mrow data-mjx-texclass="ORD">
                <mi>i</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>N</mi>
            </msubsup>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>,
it cannot output a new valid signature pair
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mo stretchy="false">(</mo>
            <msup>
              <mi>m</mi>
              <mo>∗</mo>
            </msup>
            <mo>,</mo>
            <msup>
              <mi>σ</mi>
              <mo>∗</mo>
            </msup>
            <mo stretchy="false">)</mo>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>,
such that
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mo stretchy="false">(</mo>
            <msup>
              <mi>m</mi>
              <mo>∗</mo>
            </msup>
            <mo>,</mo>
            <msup>
              <mi>σ</mi>
              <mo>∗</mo>
            </msup>
            <mo stretchy="false">)</mo>
            <mo>∉</mo>
            <mo fence="false" stretchy="false">{</mo>
            <msup>
              <mi>m</mi>
              <mi>i</mi>
            </msup>
            <mo>,</mo>
            <msup>
              <mi>σ</mi>
              <mi>i</mi>
            </msup>
            <msubsup>
              <mo fence="false" stretchy="false">}</mo>
              <mrow data-mjx-texclass="ORD">
                <mi>i</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>N</mi>
            </msubsup>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>
(except with negligible probability). Strong unforgeability implies that an
adversary not only cannot sign new messages, but also cannot find a new signature
on an old message. See [<cite><a class="bibref" data-link-type="biblio" href="#bib-provable_ed25519" title="The Provable Security of Ed25519: Theory and Practice">Provable_Ed25519</a></cite>] for a real world attack that would
have been circumvented with SUF-CMA security over EUF-CMA security.
          </p>
          <p>
<strong>Binding signature</strong> (BS) We say that a signature
scheme is <em>binding</em> if no efficient signer can output a tuple
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mo stretchy="false">[</mo>
            <mi>p</mi>
            <mi>k</mi>
            <mo>,</mo>
            <mi>m</mi>
            <mo>,</mo>
            <msup>
              <mi>m</mi>
              <mi data-mjx-alternate="1">′</mi>
            </msup>
            <mo>,</mo>
            <mi>σ</mi>
            <mo stretchy="false">]</mo>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>,
where both
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mo stretchy="false">(</mo>
            <mi>m</mi>
            <mo>,</mo>
            <mi>σ</mi>
            <mo stretchy="false">)</mo>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>
and
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mo stretchy="false">(</mo>
            <msup>
              <mi>m</mi>
              <mi data-mjx-alternate="1">′</mi>
            </msup>
            <mo>,</mo>
            <mi>σ</mi>
            <mo stretchy="false">)</mo>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>
are valid message signature pairs under the public key
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mi>p</mi>
            <mi>k</mi>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>
and
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mi>m</mi>
            <mo>≠</mo>
            <msup>
              <mi>m</mi>
              <mi data-mjx-alternate="1">′</mi>
            </msup>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>
(except with negligible probability). A binding signature makes it impossible
for the signer to claim later that it has signed a different message; the
signature <em>binds</em> the signer to the message.
          </p>
          <p>
<strong>Strongly Binding signature</strong> (SBS) Certain
applications may require a signature to not only be binding to the message but
also be binding to the public key. We say that a signature scheme is
strongly-binding if any efficient signer cannot output a tuple
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mo stretchy="false">[</mo>
            <mi>p</mi>
            <mi>k</mi>
            <mo>,</mo>
            <mi>m</mi>
            <mo>,</mo>
            <mi>p</mi>
            <msup>
              <mi>k</mi>
              <mi data-mjx-alternate="1">′</mi>
            </msup>
            <mo>,</mo>
            <msup>
              <mi>m</mi>
              <mi data-mjx-alternate="1">′</mi>
            </msup>
            <mo>,</mo>
            <mi>σ</mi>
            <mo stretchy="false">]</mo>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>,
where
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mo stretchy="false">(</mo>
            <mi>m</mi>
            <mo>,</mo>
            <mi>σ</mi>
            <mo stretchy="false">)</mo>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>
is a valid signature for the public key
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mi>p</mi>
            <mi>k</mi>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>
and
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mo stretchy="false">(</mo>
            <msup>
              <mi>m</mi>
              <mi data-mjx-alternate="1">′</mi>
            </msup>
            <mo>,</mo>
            <mi>σ</mi>
            <mo stretchy="false">)</mo>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>
is a valid signature for the public key
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mi>p</mi>
            <msup>
              <mi>k</mi>
              <mi data-mjx-alternate="1">′</mi>
            </msup>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>
and either
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <msup>
              <mi>m</mi>
              <mi data-mjx-alternate="1">′</mi>
            </msup>
            <mo>≠</mo>
            <mi>m</mi>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>
or
<math xmlns="http://www.w3.org/1998/Math/MathML" display="inline">
  <mstyle displaystyle="true" scriptlevel="0">
    <mrow data-mjx-texclass="ORD">
      <mtable rowspacing=".5em" columnspacing="1em" displaystyle="true">
        <mtr>
          <mtd>
            <mi>p</mi>
            <mi>k</mi>
            <mo>≠</mo>
            <mi>p</mi>
            <msup>
              <mi>k</mi>
              <mi data-mjx-alternate="1">′</mi>
            </msup>
          </mtd>
        </mtr>
      </mtable>
    </mrow>
  </mstyle>
</math>,
or both (except with negligible probability). See [<cite><a class="bibref" data-link-type="biblio" href="#bib-provable_ed25519" title="The Provable Security of Ed25519: Theory and Practice">Provable_Ed25519</a></cite>] for real
world attacks that would have been circumvented with the SBS property.
          </p>
          <p>Note that the <em>BS</em> and <em>SBS</em> properties are forms of
<em>non-repudiation</em>.
          </p>
        </section>
        <section id="achieving-ed25519-security-properties"><div class="header-wrapper"><h4 id="x4-1-2-achieving-ed25519-security-properties"><bdi class="secno">4.1.2 </bdi>Achieving Ed25519 Security Properties</h4><a class="self-link" href="#achieving-ed25519-security-properties" aria-label="Permalink for Section 4.1.2"></a></div>
          
          <p>
As pointed out in [<cite><a class="bibref" data-link-type="biblio" href="#bib-taming_eddsas" title="Taming the many EdDSAs">Taming_EdDSAs</a></cite>], flaws in Ed25519 libraries
primarily occur on the signature verification side, where edge cases
are sometimes not properly checked. An Ed25519 signature library that is in conformance
with [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>] or [<cite><a class="bibref" data-link-type="biblio" href="#bib-fips-186-5" title="FIPS PUB 186-5: Digital Signature Standard (DSS)">FIPS-186-5</a></cite>], i.e., one that performs <strong>all
</strong> specified validation checks, will have the <strong>SUF-CMA</strong>
property in addition to <strong>EUF-CMA</strong>.
          </p>
          <p>
Reference [<cite><a class="bibref" data-link-type="biblio" href="#bib-taming_eddsas" title="Taming the many EdDSAs">Taming_EdDSAs</a></cite>] achieves the <strong>BS</strong> and
<strong>SBS</strong> properties along with <strong>SUF-CMA</strong> in their
"signature verification algorithm 2" where an additional check is
performed against the public key <em>A</em> to make sure that it is not one of
eight "small order points". These additional checks incur minimal processing overhead.
          </p>
          <p>
Reference [<cite><a class="bibref" data-link-type="biblio" href="#bib-taming_eddsas" title="Taming the many EdDSAs">Taming_EdDSAs</a></cite>] included a set of twelve test vectors
to test various Ed25519 libraries available at the time of publication. They
found that a significant portion missed edge cases and hence did not achieve
<strong>SUF-CMA</strong> (just EUF-CMA), and only two libraries out of sixteen
achieved all the security properties. Since the time of publication, more
Ed25519 libraries have been created, and some of the libraries have been updated
to include all verification checks. Implementers are recommended to test the
Ed25519 library they are using against the test vectors of [<cite><a class="bibref" data-link-type="biblio" href="#bib-taming_eddsas" title="Taming the many EdDSAs">Taming_EdDSAs</a></cite>].
          </p>
        </section>
      </section>

    </section>

    <section id="privacy-considerations"><div class="header-wrapper"><h2 id="x5-privacy-considerations"><bdi class="secno">5. </bdi>Privacy Considerations</h2><a class="self-link" href="#privacy-considerations" aria-label="Permalink for Section 5."></a></div>
      

      <p class="advisement">
Before reading this section, readers are urged to familiarize themselves
with general privacy advice provided in the
<a href="https://www.w3.org/TR/vc-data-integrity/#privacy-considerations">
Privacy Considerations section of the Data Integrity specification</a>.
      </p>

      <p>
The following section describes privacy considerations that developers
implementing this specification should be aware of in order to avoid violating
privacy assumptions.
      </p>

    <section id="selective-and-unlinkable-disclosure"><div class="header-wrapper"><h3 id="x5-1-selective-and-unlinkable-disclosure"><bdi class="secno">5.1 </bdi>Selective and Unlinkable Disclosure</h3><a class="self-link" href="#selective-and-unlinkable-disclosure" aria-label="Permalink for Section 5.1"></a></div>
      

      <p>
The cryptographic suites described in this specification do not support
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-selective-disclosure">selective disclosure</a> or <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-unlinkable-disclosure">unlinkable disclosure</a>. If
<a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-selective-disclosure">selective disclosure</a> is a desired feature, readers might find the
<cite><a data-matched-text="[[[?VC-DI-ECDSA]]]" href="https://www.w3.org/TR/vc-di-ecdsa/">Data Integrity ECDSA Cryptosuites v1.0</a></cite> specification useful. If <a data-link-type="dfn" href="https://www.w3.org/TR/vc-data-model-2.0/#dfn-unlinkable-disclosure">unlinkable disclosure</a> is of
interest, the <cite><a data-matched-text="[[[?VC-DI-BBS]]]" href="https://www.w3.org/TR/vc-di-bbs/">Data Integrity BBS Cryptosuites v1.0</a></cite> specification provides an unlinkable digital
signature mechanism.
      </p>

    </section>
    </section>

    <section class="appendix" id="the-ed25519signature2020-suite"><div class="header-wrapper"><h2 id="a-the-ed25519signature2020-suite"><bdi class="secno">A. </bdi>The Ed25519Signature2020 Suite</h2><a class="self-link" href="#the-ed25519signature2020-suite" aria-label="Permalink for Appendix A."></a></div>
      

      <p>
<code>Ed25519Signature2020</code> is an earlier version of a cryptographic suite
for use of the EdDSA algorithm and Curve25519. While it has
been used in production systems, new implementations should instead use
<a href="#eddsa-rdfc-2022"><code>eddsa-rdfc-2022</code></a>. <code>Ed25519Signature2020</code> has
been kept in this specification to provide a stable reference.
      </p>

      <section id="data-model-0"><div class="header-wrapper"><h3 id="a-1-data-model"><bdi class="secno">A.1 </bdi>Data Model</h3><a class="self-link" href="#data-model-0" aria-label="Permalink for Appendix A.1"></a></div>
        
        <section id="verification-methods-0"><div class="header-wrapper"><h4 id="a-1-1-verification-methods"><bdi class="secno">A.1.1 </bdi>Verification Methods</h4><a class="self-link" href="#verification-methods-0" aria-label="Permalink for Appendix A.1.1"></a></div>
          
          <section id="ed25519verificationkey2020"><div class="header-wrapper"><h5 id="a-1-1-1-ed25519verificationkey2020"><bdi class="secno">A.1.1.1 </bdi>Ed25519VerificationKey2020</h5><a class="self-link" href="#ed25519verificationkey2020" aria-label="Permalink for Appendix A.1.1.1"></a></div>
            

            <p>
The key format described in this section is provided to document a legacy
mechanism that has been deployed to production. The key format described in
section <a href="#multikey" data-matched-text="[[[#multikey]]]" class="sec-ref"><bdi class="secno">2.1.1 </bdi>Multikey</a> supercedes the one described in this section. New
applications are strongly urged to use the newer key format.
            </p>

            <p>
The <code>type</code> of the verification method <em class="rfc2119">MUST</em> be
<a href="#ed25519verificationkey2020">Ed25519VerificationKey2020</a>.
            </p>

            <p>
The <code>controller</code> of the verification method <em class="rfc2119">MUST</em> be a URL.
            </p>

            <p>
The <code>publicKeyMultibase</code> value of the verification method <em class="rfc2119">MUST</em> start with the
base-58-btc prefix (<code>z</code>), as defined in the
<a href="https://www.w3.org/TR/cid-1.0/#multibase-0">Multibase section</a> of
[<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>]. A Multibase-encoded Multikey value follows, which <em class="rfc2119">MUST</em>
consist of a binary value that starts with the two-byte prefix <code>0xed01</code>, which
is the Multikey header for an Ed25519 public key, followed by the 32-byte
public key data, all of which is then encoded using base-58-btc. Any other
encoding <em class="rfc2119">MUST NOT</em> be allowed.
            </p>

            <p class="advisement">
Developers are advised to not accidentally publish a representation of a private
key. Implementations of this specification will raise errors in the event of a
Multikey header value other than <code>0xed01</code> being used in a
<code>publicKeyMultibase</code> value.
            </p>

            <div class="example" id="example-an-ed25519-public-key-encoded-as-an-ed25519verificationkey2020">
        <div class="marker">
    <a class="self-link" href="#example-an-ed25519-public-key-encoded-as-an-ed25519verificationkey2020">Example<bdi> 4</bdi></a><span class="example-title">: An Ed25519 public key encoded as an
              Ed25519VerificationKey2020</span>
  </div> <pre class="nohighlight">{
  "id": "https://example.com/issuer/123#key-0",
  "type": "Ed25519VerificationKey2020",
  "controller": "https://example.com/issuer/123",
  "publicKeyMultibase": "z6Mkf5rGMoatrSj1f4CyvuHBeXJELe9RPdzo2PKGNCKVtZxP"
}</pre>
      </div>

            <div class="example" id="example-an-ed25519-public-key-encoded-as-an-ed25519verificationkey2020-in-a-controller-document">
        <div class="marker">
    <a class="self-link" href="#example-an-ed25519-public-key-encoded-as-an-ed25519verificationkey2020-in-a-controller-document">Example<bdi> 5</bdi></a><span class="example-title">: An Ed25519 public key encoded as an
              Ed25519VerificationKey2020 in a controller document.</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/suites/ed25519-2020/v1"
  ],
  "id": "did:example:123",
  "verificationMethod": [{
    "id": "did:example:123#key-0",
    "type": "Ed25519VerificationKey2020",
    "controller": "did:example:123",
    "publicKeyMultibase": "z6Mkf5rGMoatrSj1f4CyvuHBeXJELe9RPdzo2PKGNCKVtZxP"
  }],
  "authentication": [
    "did:example:123#key-0"
  ],
  "assertionMethod": [
    "did:example:123#key-0"
  ],
  "capabilityDelegation": [
    "did:example:123#key-0"
  ],
  "capabilityInvocation": [
    "did:example:123#key-0"
  ]
}</pre>
      </div>
          </section>

        </section>
        <section id="proof-representations-0"><div class="header-wrapper"><h4 id="a-1-2-proof-representations"><bdi class="secno">A.1.2 </bdi>Proof representations</h4><a class="self-link" href="#proof-representations-0" aria-label="Permalink for Appendix A.1.2"></a></div>
          
          <section id="ed25519signature2020"><div class="header-wrapper"><h5 id="a-1-2-1-ed25519signature2020"><bdi class="secno">A.1.2.1 </bdi>Ed25519Signature2020</h5><a class="self-link" href="#ed25519signature2020" aria-label="Permalink for Appendix A.1.2.1"></a></div>
            

            <p>
The proof format described in this section is provided to document a legacy
mechanism that has been deployed to production. The <code>DataIntegrityProof</code> formats
described in section <a href="#dataintegrityproof" data-matched-text="[[[#dataintegrityproof]]]" class="sec-ref"><bdi class="secno">2.2.1 </bdi>DataIntegrityProof</a> supercede the one described in
this section. New applications are strongly urged to use the newer proof format.
            </p>

            <p>
The <code>verificationMethod</code> property of the proof <em class="rfc2119">MUST</em> be a URL.
Dereferencing the <code>verificationMethod</code> <em class="rfc2119">MUST</em> result in an object
containing a <code>type</code> property with the value set to
<code>Ed25519VerificationKey2020</code>.
            </p>

            <p>
The <code>type</code> property of the proof <em class="rfc2119">MUST</em> be <code>Ed25519Signature2020</code>.
            </p>
            <p>
The <code>created</code> property of the proof <em class="rfc2119">MUST</em> be an [<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlschema11-2" title="W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes">XMLSCHEMA11-2</a></cite>]
formatted date string.
            </p>
            <p>
The <code>proofPurpose</code> property of the proof <em class="rfc2119">MUST</em> be a string, and <em class="rfc2119">MUST</em>
match the verification relationship expressed by the verification method
<code>controller</code>.
            </p>
            <p>
The <code>proofValue</code> property of the proof <em class="rfc2119">MUST</em> be a detached EdDSA
produced according to [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>], encoded using
the base-58-btc header and alphabet as described in the
<a href="https://www.w3.org/TR/cid-1.0/#multibase-0">
Multibase section</a> of [<cite><a class="bibref" data-link-type="biblio" href="#bib-cid" title="Controlled Identifiers v1.0">CID</a></cite>].
            </p>

            <div class="example" id="example-an-ed25519-digital-signature-expressed-as-a-ed25519signature2020">
        <div class="marker">
    <a class="self-link" href="#example-an-ed25519-digital-signature-expressed-as-a-ed25519signature2020">Example<bdi> 6</bdi></a><span class="example-title">: An Ed25519 digital signature expressed as a
              Ed25519Signature2020</span>
  </div> <pre class="nohighlight">{
  "@context": [
    {"myWebsite": "https://vocabulary.example/myWebsite"},
    "https://w3id.org/security/suites/ed25519-2020/v1"
  ],
  "myWebsite": "https://hello.world.example/",
  "proof": {
    "type": "Ed25519Signature2020",
    "created": "2020-11-05T19:23:24Z",
    "verificationMethod": "https://di.example/issuer#z6MkjLrk3gKS2nnkeWcmcxiZPGskmesDpuwRBorgHxUXfxnG",
    "proofPurpose": "assertionMethod",
    "proofValue": "z4oey5q2M3XKaxup3tmzN4DRFTLVqpLMweBrSxMY2xHX5XTYVQeVbY8nQAVHMrXFkXJpmEcqdoDwLWxaqA3Q1geV6"
  }
}</pre>
      </div>

          </section>

        </section>
      </section>

      <section id="algorithms-0"><div class="header-wrapper"><h3 id="a-2-algorithms"><bdi class="secno">A.2 </bdi>Algorithms</h3><a class="self-link" href="#algorithms-0" aria-label="Permalink for Appendix A.2"></a></div>
        
        <section id="ed25519signature2020-0"><div class="header-wrapper"><h4 id="a-2-1-ed25519signature2020"><bdi class="secno">A.2.1 </bdi>Ed25519Signature2020</h4><a class="self-link" href="#ed25519signature2020-0" aria-label="Permalink for Appendix A.2.1"></a></div>
          

          <p>
The <code>Ed25519Signature2020</code> cryptographic suite takes an input document,
canonicalizes the document using the RDF Dataset Canonicalization algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-canon" title="RDF Dataset Canonicalization">RDF-CANON</a></cite>],
and then cryptographically hashes and signs the output
resulting in the production of a data integrity proof. The algorithms in this
section also include the verification of such a data integrity proof.
          </p>

          <section id="add-proof-ed25519signature2020"><div class="header-wrapper"><h5 id="a-2-1-1-add-proof-ed25519signature2020"><bdi class="secno">A.2.1.1 </bdi>Add Proof (Ed25519Signature2020)</h5><a class="self-link" href="#add-proof-ed25519signature2020" aria-label="Permalink for Appendix A.2.1.1"></a></div>
            

            <p>
To generate a proof, the algorithm in
<a href="https://www.w3.org/TR/vc-data-integrity/#add-proof">
Section 4.1: Add Proof</a> in the Data Integrity
[<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>] specification <em class="rfc2119">MUST</em> be executed.
For that algorithm, the cryptographic suite specific
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-transformation-algorithm">
transformation algorithm</a> is defined in Section
<a href="#transformation-ed25519signature2020" data-matched-text="[[[#transformation-ed25519signature2020]]]" class="sec-ref"><bdi class="secno">A.2.1.3 </bdi>Transformation (Ed25519Signature2020)</a>, the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-hashing-algorithm">
hashing algorithm</a> is defined in Section
<a href="#hashing-ed25519signature2020" data-matched-text="[[[#hashing-ed25519signature2020]]]" class="sec-ref"><bdi class="secno">A.2.1.4 </bdi>Hashing (Ed25519Signature2020)</a>, and the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-proof-serialization-algorithm">
proof serialization algorithm</a> is defined in Section
<a href="#proof-serialization-ed25519signature2020" data-matched-text="[[[#proof-serialization-ed25519signature2020]]]" class="sec-ref"><bdi class="secno">A.2.1.6 </bdi>Proof Serialization (Ed25519Signature2020)</a>.
            </p>
          </section>

          <section id="verify-proof-ed25519signature2020"><div class="header-wrapper"><h5 id="a-2-1-2-verify-proof-ed25519signature2020"><bdi class="secno">A.2.1.2 </bdi>Verify Proof (Ed25519Signature2020)</h5><a class="self-link" href="#verify-proof-ed25519signature2020" aria-label="Permalink for Appendix A.2.1.2"></a></div>
            

            <p>
To verify a proof, the algorithm in
<a href="https://www.w3.org/TR/vc-data-integrity/#verify-proof">
Section 4.2: Verify Proof</a> in the Data Integrity
[<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>] specification <em class="rfc2119">MUST</em> be executed.
For that algorithm, the cryptographic suite specific
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-transformation-algorithm">
transformation algorithm</a> is defined in Section
<a href="#transformation-ed25519signature2020" data-matched-text="[[[#transformation-ed25519signature2020]]]" class="sec-ref"><bdi class="secno">A.2.1.3 </bdi>Transformation (Ed25519Signature2020)</a>, the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-hashing-algorithm">
hashing algorithm</a> is defined in Section <a href="#hashing-ed25519signature2020" data-matched-text="[[[#hashing-ed25519signature2020]]]" class="sec-ref"><bdi class="secno">A.2.1.4 </bdi>Hashing (Ed25519Signature2020)</a>,
and the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-proof-serialization-algorithm">
proof verification algorithm</a> is defined in Section
<a href="#proof-verification-ed25519signature2020" data-matched-text="[[[#proof-verification-ed25519signature2020]]]" class="sec-ref"><bdi class="secno">A.2.1.7 </bdi>Proof Verification (Ed25519Signature2020)</a>.
            </p>
          </section>

          <section id="transformation-ed25519signature2020"><div class="header-wrapper"><h5 id="a-2-1-3-transformation-ed25519signature2020"><bdi class="secno">A.2.1.3 </bdi>Transformation (Ed25519Signature2020)</h5><a class="self-link" href="#transformation-ed25519signature2020" aria-label="Permalink for Appendix A.2.1.3"></a></div>
            

            <p>
The following algorithm specifies how to transform an unsecured input document
into a transformed document that is ready to be provided as input to the
hashing algorithm in Section <a href="#hashing-ed25519signature2020" data-matched-text="[[[#hashing-ed25519signature2020]]]" class="sec-ref"><bdi class="secno">A.2.1.4 </bdi>Hashing (Ed25519Signature2020)</a>.
            </p>

            <p>
Required inputs to this algorithm are an
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-unsecured-data-document">
unsecured data document</a> (<code>unsecuredDocument</code>) and
transformation options (<code>options</code>). The
transformation options <em class="rfc2119">MUST</em> contain a type identifier for the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-cryptosuite">
cryptographic suite</a> (<code>type</code>) and a cryptosuite
identifier (<code>cryptosuite</code>). A <em>transformed data document</em> is
produced as output. Whenever this algorithm encodes strings, it <em class="rfc2119">MUST</em> use UTF-8
encoding.
            </p>

            <ol class="algorithm">
              <li>
If <code>options</code>.<code>type</code> is not set to the string
<code>Ed25519Signature2020</code>,
an error <em class="rfc2119">MUST</em> be raised that <em class="rfc2119">SHOULD</em> convey an error type of
<a href="https://www.w3.org/TR/vc-data-integrity/#PROOF_TRANSFORMATION_ERROR">PROOF_TRANSFORMATION_ERROR</a>.
              </li>
              <li>
Let <var>canonicalDocument</var> be the result of converting <var>unsecuredDocument</var> to
<a href="https://www.w3.org/TR/json-ld11-api/#expansion-algorithm">JSON-LD expanded form</a>
and then <a href="https://www.w3.org/TR/json-ld11-api/#deserialize-json-ld-to-rdf-algorithm">
to RDF statements</a>, applying the <a href="https://www.w3.org/TR/rdf-canon/#canon-algorithm">
Universal RDF Dataset Canonicalization Algorithm</a>, and then serializing the result to a
<a href="https://www.w3.org/TR/rdf-canon/#dfn-serialized-canonical-form">serialized canonical form</a>.
              </li>
              <li>
Return <code>canonicalDocument</code> as the <em>transformed data document</em>.
              </li>
            </ol>

          </section>

          <section id="hashing-ed25519signature2020"><div class="header-wrapper"><h5 id="a-2-1-4-hashing-ed25519signature2020"><bdi class="secno">A.2.1.4 </bdi>Hashing (Ed25519Signature2020)</h5><a class="self-link" href="#hashing-ed25519signature2020" aria-label="Permalink for Appendix A.2.1.4"></a></div>
            

            <p>
The following algorithm specifies how to cryptographically hash a
<em>transformed data document</em> and <em>proof configuration</em>
into cryptographic hash data that is ready to be provided as input to the
algorithms in Section <a href="#proof-serialization-ed25519signature2020" data-matched-text="[[[#proof-serialization-ed25519signature2020]]]" class="sec-ref"><bdi class="secno">A.2.1.6 </bdi>Proof Serialization (Ed25519Signature2020)</a> or
Section <a href="#proof-verification-ed25519signature2020" data-matched-text="[[[#proof-verification-ed25519signature2020]]]" class="sec-ref"><bdi class="secno">A.2.1.7 </bdi>Proof Verification (Ed25519Signature2020)</a>.
            </p>

            <p>
The required inputs to this algorithm are a
<em>transformed data document</em> (<code>transformedDocument</code>) and
<em>proof configuration</em> (<code>proofConfig</code>). The
<em>proof configuration</em> <em class="rfc2119">MUST</em> contain a type identifier for the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-cryptosuite">
cryptographic suite</a> (<code>type</code>) and <em class="rfc2119">MAY</em> contain a cryptosuite
identifier (<code>cryptosuite</code>). A single <em>hash data</em> value
represented as series of bytes is produced as output.
            </p>

            <ol class="algorithm">
              <li>
Let <code>transformedDocumentHash</code> be the result of applying the
SHA-256 (SHA-2 with 256-bit output) cryptographic hashing algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6234" title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">RFC6234</a></cite>]
to the <code>transformedDocument</code>. <code>transformedDocumentHash</code> will
be exactly 32 bytes in size.
              </li>
              <li>
Let <code>proofConfigHash</code> be the result of applying the
SHA-256 (SHA-2 with 256-bit output) cryptographic hashing algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc6234" title="US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)">RFC6234</a></cite>]
to the <code>canonicalProofConfig</code>. <code>proofConfigHash</code> will be
exactly 32 bytes in size.
              </li>

              <li>
Let <code>hashData</code> be the result of joining <code>proofConfigHash</code> (the
first hash) with <code>transformedDocumentHash</code> (the second hash).
              </li>
              <li>
Return <code>hashData</code> as the <em>hash data</em>.
              </li>
            </ol>

          </section>

          <section id="proof-configuration-ed25519signature2020"><div class="header-wrapper"><h5 id="a-2-1-5-proof-configuration-ed25519signature2020"><bdi class="secno">A.2.1.5 </bdi>Proof Configuration (Ed25519Signature2020)</h5><a class="self-link" href="#proof-configuration-ed25519signature2020" aria-label="Permalink for Appendix A.2.1.5"></a></div>
            

            <p>
The following algorithm specifies how to generate a
<em>proof configuration</em> from a set of <em>proof options</em>
that is used as input to the <a href="#hashing-ed25519signature2020">proof hashing algorithm</a>.
            </p>

            <p>
The required inputs to this algorithm are <em>proof options</em>
(<code>options</code>). The <em>proof options</em> <em class="rfc2119">MUST</em> contain a type identifier
for the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-cryptosuite">
cryptographic suite</a> (<code>type</code>) and <em class="rfc2119">MAY</em> contain a cryptosuite
identifier (<code>cryptosuite</code>). A <em>proof configuration</em>
object is produced as output.
            </p>

            <ol class="algorithm">
              <li>
Let <var>proofConfig</var> be a clone of the <var>options</var> object.
              </li>
              <li>
If <code>proofConfig</code>.<code>type</code> is not set to <code>Ed25519Signature2020</code>,
an error <em class="rfc2119">MUST</em> be raised and <em class="rfc2119">SHOULD</em> convey an error type of
<a href="https://www.w3.org/TR/vc-data-integrity/#PROOF_GENERATION_ERROR">PROOF_GENERATION_ERROR</a>.
              </li>
              <li>
If <var>proofConfig</var>.<var>created</var> is present and set to a value that is not a
valid [<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlschema11-2" title="W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes">XMLSCHEMA11-2</a></cite>] datetime, an error <em class="rfc2119">MUST</em> be
raised and <em class="rfc2119">SHOULD</em> convey an error type of
<a href="https://www.w3.org/TR/vc-data-integrity/#PROOF_GENERATION_ERROR">PROOF_GENERATION_ERROR</a>.
              </li>
              <li>
Set <code>proofConfig</code>.<var>@context</var> to
<code>unsecuredDocument</code>.<var>@context</var>
              </li>
              <li>
Let <code>canonicalProofConfig</code> be the result of applying the
RDF Dataset Canonicalization algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-canon" title="RDF Dataset Canonicalization">RDF-CANON</a></cite>] to the <code>proofConfig</code>.
              </li>
              <li>
Return <code>canonicalProofConfig</code>.
              </li>
            </ol>

          </section>

          <section id="proof-serialization-ed25519signature2020"><div class="header-wrapper"><h5 id="a-2-1-6-proof-serialization-ed25519signature2020"><bdi class="secno">A.2.1.6 </bdi>Proof Serialization (Ed25519Signature2020)</h5><a class="self-link" href="#proof-serialization-ed25519signature2020" aria-label="Permalink for Appendix A.2.1.6"></a></div>
            

            <p>
The following algorithm specifies how to serialize a digital signature from
a set of cryptographic hash data. This
algorithm is designed to be used in conjunction with the algorithms defined
in the Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>] specification,
<a href="https://www.w3.org/TR/vc-data-integrity/#algorithms">
Section 4: Algorithms</a>. Required inputs are
cryptographic hash data (<code>hashData</code>) and
<em>proof options</em> (<code>options</code>). The
<em>proof options</em> <em class="rfc2119">MUST</em> contain a type identifier for the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-cryptosuite">
cryptographic suite</a> (<code>type</code>) and <em class="rfc2119">MAY</em> contain a cryptosuite
identifier (<code>cryptosuite</code>). A single <em>digital proof</em> value
represented as series of bytes is produced as output.
            </p>

            <ol class="algorithm">
              <li>
Let <var>privateKeyBytes</var> be the result of retrieving the
private key bytes (or a signing interface enabling the use of the private key
bytes) associated with the verification method identified by the
<var>options</var>.<var>verificationMethod</var> value.
              </li>
              <li>
Let <code>proofBytes</code> be the result of applying the Edwards-Curve Digital
Signature Algorithm (EdDSA) [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>], using the <code>Ed25519</code> variant
(Pure EdDSA), with <code>hashData</code> as the data to be signed using
the private key specified by <code>privateKeyBytes</code>.
<code>proofBytes</code> will be exactly 64 bytes in size.
              </li>
              <li>
Return <code>proofBytes</code> as the <em>digital proof</em>.
              </li>
            </ol>

          </section>

          <section id="proof-verification-ed25519signature2020"><div class="header-wrapper"><h5 id="a-2-1-7-proof-verification-ed25519signature2020"><bdi class="secno">A.2.1.7 </bdi>Proof Verification (Ed25519Signature2020)</h5><a class="self-link" href="#proof-verification-ed25519signature2020" aria-label="Permalink for Appendix A.2.1.7"></a></div>
            

            <p>
The following algorithm specifies how to verify a digital signature from
a set of cryptographic hash data. This
algorithm is designed to be used in conjunction with the algorithms defined
in the Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>] specification,
<a href="https://www.w3.org/TR/vc-data-integrity/#algorithms">
Section 4: Algorithms</a>. Required inputs are
cryptographic hash data (<code>hashData</code>),
a digital signature (<code>proofBytes</code>) and
proof options (<code>options</code>). A <em>verification result</em>
represented as a boolean value is produced as output.
            </p>

            <ol class="algorithm">
              <li>
Let <var>publicKeyBytes</var> be the result of retrieving the
public key bytes associated with the
<var>options</var>.<var>verificationMethod</var> value as described in the
<a href="https://www.w3.org/TR/cid-1.0/#retrieve-verification-method">Retrieve
Verification Method</a> section of the <cite><a data-matched-text="[[[CID]]]" href="https://www.w3.org/TR/cid-1.0/">Controlled Identifiers v1.0</a></cite> specification.
              </li>
              <li>
Let <code>verificationResult</code> be the result of applying the verification
algorithm for the Edwards-Curve Digital Signature Algorithm (EdDSA)
[<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8032" title="Edwards-Curve Digital Signature Algorithm (EdDSA)">RFC8032</a></cite>], using the <code>Ed25519</code> variant (Pure EdDSA),
with <code>hashData</code> as the data to be verified against the
<code>proofBytes</code> using the public key specified by
<code>publicKeyBytes</code>.
              </li>
              <li>
Return <code>verificationResult</code> as the <em>verification result</em>.
              </li>
            </ol>

          </section>
        </section>
      </section>
    </section>


    <section class="appendix informative" id="test-vectors"><div class="header-wrapper"><h2 id="b-test-vectors"><bdi class="secno">B. </bdi>Test Vectors</h2><a class="self-link" href="#test-vectors" aria-label="Permalink for Appendix B."></a></div><p><em>This section is non-normative.</em></p>
      
      <section id="representation-eddsa-rdfc-2022"><div class="header-wrapper"><h3 id="b-1-representation-eddsa-rdfc-2022"><bdi class="secno">B.1 </bdi>Representation: eddsa-rdfc-2022</h3><a class="self-link" href="#representation-eddsa-rdfc-2022" aria-label="Permalink for Appendix B.1"></a></div>
        
        <p>
The signer needs to generate a private/public key pair with the private key used
for signing and the public key made available for verification. The
representation of the public key and the representation of the private key
are shown below.
        </p>
        <div class="example" id="example-private-and-public-keys-for-signature">
        <div class="marker">
    <a class="self-link" href="#example-private-and-public-keys-for-signature">Example<bdi> 7</bdi></a><span class="example-title">: Private and Public keys for Signature</span>
  </div> <pre class="nohighlight">{
    publicKeyMultibase: "z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2",
    secretKeyMultibase: "z3u2en7t5LR2WtQH5PfFqMqwVHBeXouLzo6haApm8XHqvjxq"
}</pre>
      </div>

        <p>
Signing begins with a credential without an attached proof, which is converted
to canonical form, and then hashed, as shown in the following three examples.
        </p>

        <div class="example" id="example-credential-without-proof">
        <div class="marker">
    <a class="self-link" href="#example-credential-without-proof">Example<bdi> 8</bdi></a><span class="example-title">: Credential without Proof</span>
  </div> <pre class="nohighlight">{
    "@context": [
        "https://www.w3.org/ns/credentials/v2",
        "https://www.w3.org/ns/credentials/examples/v2"
    ],
    "id": "urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33",
    "type": ["VerifiableCredential", "AlumniCredential"],
    "name": "Alumni Credential",
    "description": "A minimum viable example of an Alumni Credential.",
    "issuer": "https://vc.example/issuers/5678",
    "validFrom": "2023-01-01T00:00:00Z",
    "credentialSubject": {
        "id": "did:example:abcdefgh",
        "alumniOf": "The School of Examples"
    }
}</pre>
      </div>

        <div class="example" id="example-canonical-credential-without-proof">
        <div class="marker">
    <a class="self-link" href="#example-canonical-credential-without-proof">Example<bdi> 9</bdi></a><span class="example-title">: Canonical Credential without Proof</span>
  </div> <pre class="nohighlight">&lt;did:example:abcdefgh&gt; &lt;https://www.w3.org/ns/credentials/examples#alumniOf&gt; "The School of Examples" .
&lt;urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33&gt; &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; &lt;https://www.w3.org/2018/credentials#VerifiableCredential&gt; .
&lt;urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33&gt; &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; &lt;https://www.w3.org/ns/credentials/examples#AlumniCredential&gt; .
&lt;urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33&gt; &lt;https://schema.org/description&gt; "A minimum viable example of an Alumni Credential." .
&lt;urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33&gt; &lt;https://schema.org/name&gt; "Alumni Credential" .
&lt;urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33&gt; &lt;https://www.w3.org/2018/credentials#credentialSubject&gt; &lt;did:example:abcdefgh&gt; .
&lt;urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33&gt; &lt;https://www.w3.org/2018/credentials#issuer&gt; &lt;https://vc.example/issuers/5678&gt; .
&lt;urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33&gt; &lt;https://www.w3.org/2018/credentials#validFrom&gt; "2023-01-01T00:00:00Z"^^&lt;http://www.w3.org/2001/XMLSchema#dateTime&gt; .</pre>
      </div>


        <div class="example" id="example-hash-of-canonical-credential-without-proof-hex">
        <div class="marker">
    <a class="self-link" href="#example-hash-of-canonical-credential-without-proof-hex">Example<bdi> 10</bdi></a><span class="example-title">: Hash of Canonical Credential without Proof (hex)</span>
  </div> <pre class="nohighlight">517744132ae165a5349155bef0bb0cf2258fff99dfe1dbd914b938d775a36017</pre>
      </div>

        <p>
The next step is to take the proof options document, convert it to canonical form,
and obtain its hash, as shown in the next three examples.
        </p>

        <div class="example" id="example-proof-options-document">
        <div class="marker">
    <a class="self-link" href="#example-proof-options-document">Example<bdi> 11</bdi></a><span class="example-title">: Proof Options Document</span>
  </div> <pre class="nohighlight">{
  "type": "DataIntegrityProof",
  "cryptosuite": "eddsa-rdfc-2022",
  "created": "2023-02-24T23:36:38Z",
  "verificationMethod": "did:key:z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2#z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2",
  "proofPurpose": "assertionMethod",
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ]
}</pre>
      </div>

        <div class="example" id="example-canonical-proof-options-document">
        <div class="marker">
    <a class="self-link" href="#example-canonical-proof-options-document">Example<bdi> 12</bdi></a><span class="example-title">: Canonical Proof Options Document</span>
  </div> <pre class="nohighlight">_:c14n0 &lt;http://purl.org/dc/terms/created&gt; "2023-02-24T23:36:38Z"^^&lt;http://www.w3.org/2001/XMLSchema#dateTime&gt; .
_:c14n0 &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; &lt;https://w3id.org/security#DataIntegrityProof&gt; .
_:c14n0 &lt;https://w3id.org/security#cryptosuite&gt; "eddsa-rdfc-2022"^^&lt;https://w3id.org/security#cryptosuiteString&gt; .
_:c14n0 &lt;https://w3id.org/security#proofPurpose&gt; &lt;https://w3id.org/security#assertionMethod&gt; .
_:c14n0 &lt;https://w3id.org/security#verificationMethod&gt; &lt;did:key:z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2#z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2&gt; .</pre>
      </div>

        <div class="example" id="example-hash-of-canonical-proof-options-document-hex">
        <div class="marker">
    <a class="self-link" href="#example-hash-of-canonical-proof-options-document-hex">Example<bdi> 13</bdi></a><span class="example-title">: Hash of Canonical Proof Options Document (hex)</span>
  </div> <pre class="nohighlight">bea7b7acfbad0126b135104024a5f1733e705108f42d59668b05c0c50004c6b0</pre>
      </div>

        <p>
Finally, we concatenate the hash of the proof options followed by the hash of the credential without proof, use the private key with the combined hash to
compute the Ed25519 signature, and then base58-btc encode the signature.
        </p>

        <div class="example" id="example-combine-hashes-of-proof-options-and-credential-hex">
        <div class="marker">
    <a class="self-link" href="#example-combine-hashes-of-proof-options-and-credential-hex">Example<bdi> 14</bdi></a><span class="example-title">: Combine hashes of Proof Options and Credential (hex)</span>
  </div> <pre class="nohighlight">bea7b7acfbad0126b135104024a5f1733e705108f42d59668b05c0c50004c6b0517744132ae165a5349155bef0bb0cf2258fff99dfe1dbd914b938d775a36017</pre>
      </div>

        <div class="example" id="example-signature-of-combined-hashes-hex">
        <div class="marker">
    <a class="self-link" href="#example-signature-of-combined-hashes-hex">Example<bdi> 15</bdi></a><span class="example-title">: Signature of Combined Hashes (hex)</span>
  </div> <pre class="nohighlight">4d8e53c2d5b3f2a7891753eb16ca993325bdb0d3cfc5be1093d0a18426f5ef8578cadc0fd4b5f4dd0d1ce0aefd15ab120b7a894d0eb094ffda4e6553cd1ed50d</pre>
      </div>

        <div class="example" id="example-signature-of-combined-hashes-base58-btc">
        <div class="marker">
    <a class="self-link" href="#example-signature-of-combined-hashes-base58-btc">Example<bdi> 16</bdi></a><span class="example-title">: Signature of Combined Hashes base58-btc</span>
  </div> <pre class="nohighlight">z2YwC8z3ap7yx1nZYCg4L3j3ApHsF8kgPdSb5xoS1VR7vPG3F561B52hYnQF9iseabecm3ijx4K1FBTQsCZahKZme</pre>
      </div>

        <p>Assemble the signed credential with the following two steps:</p>
        <ol>
          <li>
Add the <code>proofValue</code> field with the previously computed base58-btc
value to the proof options document.
          </li>
          <li>
Set the <code>proof</code> field of the credential to the augmented proof
option document.
          </li>
        </ol>

        <div class="example" id="example-signed-credential">
        <div class="marker">
    <a class="self-link" href="#example-signed-credential">Example<bdi> 17</bdi></a><span class="example-title">: Signed Credential</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33",
  "type": [
    "VerifiableCredential",
    "AlumniCredential"
  ],
  "name": "Alumni Credential",
  "description": "A minimum viable example of an Alumni Credential.",
  "issuer": "https://vc.example/issuers/5678",
  "validFrom": "2023-01-01T00:00:00Z",
  "credentialSubject": {
    "id": "did:example:abcdefgh",
    "alumniOf": "The School of Examples"
  },
  "proof": {
    "type": "DataIntegrityProof",
    "cryptosuite": "eddsa-rdfc-2022",
    "created": "2023-02-24T23:36:38Z",
    "verificationMethod": "did:key:z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2#z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2",
    "proofPurpose": "assertionMethod",
    "proofValue": "z2YwC8z3ap7yx1nZYCg4L3j3ApHsF8kgPdSb5xoS1VR7vPG3F561B52hYnQF9iseabecm3ijx4K1FBTQsCZahKZme"
  }
}</pre>
      </div>
      </section>
      <section id="enhanced-example-for-representation-eddsa-rdfc-2022"><div class="header-wrapper"><h3 id="b-2-enhanced-example-for-representation-eddsa-rdfc-2022"><bdi class="secno">B.2 </bdi>Enhanced Example for Representation: eddsa-rdfc-2022</h3><a class="self-link" href="#enhanced-example-for-representation-eddsa-rdfc-2022" aria-label="Permalink for Appendix B.2"></a></div>
        
        <p>
Here we again go through the steps of creating a credential signed with
<code>eddsa-rdfc-2022</code>, but with a more complicated input document. The
representation of the public key and the representation of the private key
are shown below.
        </p>
        <div class="example" id="example-private-and-public-keys-for-signature-0">
        <div class="marker">
    <a class="self-link" href="#example-private-and-public-keys-for-signature-0">Example<bdi> 18</bdi></a><span class="example-title">: Private and Public keys for Signature</span>
  </div> <pre class="nohighlight">{
    publicKeyMultibase: "z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2",
    secretKeyMultibase: "z3u2en7t5LR2WtQH5PfFqMqwVHBeXouLzo6haApm8XHqvjxq"
}</pre>
      </div>

        <p>
Signing begins with a credential without an attached proof, which is converted
to canonical form, and then hashed, as shown in the following three examples.
        </p>

        <div class="example" id="example-employment-authorization-credential-without-proof">
        <div class="marker">
    <a class="self-link" href="#example-employment-authorization-credential-without-proof">Example<bdi> 19</bdi></a><span class="example-title">: Employment Authorization Credential without Proof</span>
  </div> <pre class="nohighlight">{
    "@context": [
      "https://www.w3.org/ns/credentials/v2",
      "https://w3id.org/citizenship/v4rc1"
    ],
    "type": [
      "VerifiableCredential",
      "EmploymentAuthorizationDocumentCredential"
    ],
    "issuer": {
      "id": "did:key:zDnaegE6RR3atJtHKwTRTWHsJ3kNHqFwv7n9YjTgmU7TyfU76",
      "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQIW2NgUPr/HwADaAIhG61j/AAAAABJRU5ErkJggg=="
    },
    "credentialSubject": {
      "type": [
        "Person",
        "EmployablePerson"
      ],
      "givenName": "JOHN",
      "additionalName": "JACOB",
      "familyName": "SMITH",
      "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQIW2Ng+M/wHwAEAQH/7yMK/gAAAABJRU5ErkJggg==",
      "gender": "Male",
      "residentSince": "2015-01-01",
      "birthCountry": "Bahamas",
      "birthDate": "1999-07-17",
      "employmentAuthorizationDocument": {
        "type": "EmploymentAuthorizationDocument",
        "identifier": "83627465",
        "lprCategory": "C09",
        "lprNumber": "999-999-999"
      }
    },
    "name": "Employment Authorization Document",
    "description": "Example Employment Authorization Document.",
    "validFrom": "2019-12-03T00:00:00Z",
    "validUntil": "2029-12-03T00:00:00Z"
  }</pre>
      </div>

        <div class="example" id="example-canonical-employment-authorization-credential-without-proof">
        <div class="marker">
    <a class="self-link" href="#example-canonical-employment-authorization-credential-without-proof">Example<bdi> 20</bdi></a><span class="example-title">: Canonical Employment Authorization Credential without Proof</span>
  </div> <pre class="nohighlight">&lt;did:key:zDnaegE6RR3atJtHKwTRTWHsJ3kNHqFwv7n9YjTgmU7TyfU76&gt; &lt;https://schema.org/image&gt; &lt;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQIW2NgUPr/HwADaAIhG61j/AAAAABJRU5ErkJggg==&gt; .
_:c14n0 &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; &lt;https://w3id.org/citizenship#EmploymentAuthorizationDocumentCredential&gt; .
_:c14n0 &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; &lt;https://www.w3.org/2018/credentials#VerifiableCredential&gt; .
_:c14n0 &lt;https://schema.org/description&gt; "Example Employment Authorization Document." .
_:c14n0 &lt;https://schema.org/name&gt; "Employment Authorization Document" .
_:c14n0 &lt;https://www.w3.org/2018/credentials#credentialSubject&gt; _:c14n1 .
_:c14n0 &lt;https://www.w3.org/2018/credentials#issuer&gt; &lt;did:key:zDnaegE6RR3atJtHKwTRTWHsJ3kNHqFwv7n9YjTgmU7TyfU76&gt; .
_:c14n0 &lt;https://www.w3.org/2018/credentials#validFrom&gt; "2019-12-03T00:00:00Z"^^&lt;http://www.w3.org/2001/XMLSchema#dateTime&gt; .
_:c14n0 &lt;https://www.w3.org/2018/credentials#validUntil&gt; "2029-12-03T00:00:00Z"^^&lt;http://www.w3.org/2001/XMLSchema#dateTime&gt; .
_:c14n1 &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; &lt;https://schema.org/Person&gt; .
_:c14n1 &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; &lt;https://w3id.org/citizenship#EmployablePerson&gt; .
_:c14n1 &lt;https://schema.org/additionalName&gt; "JACOB" .
_:c14n1 &lt;https://schema.org/birthDate&gt; "1999-07-17"^^&lt;http://www.w3.org/2001/XMLSchema#dateTime&gt; .
_:c14n1 &lt;https://schema.org/familyName&gt; "SMITH" .
_:c14n1 &lt;https://schema.org/gender&gt; "Male" .
_:c14n1 &lt;https://schema.org/givenName&gt; "JOHN" .
_:c14n1 &lt;https://schema.org/image&gt; &lt;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQIW2Ng+M/wHwAEAQH/7yMK/gAAAABJRU5ErkJggg==&gt; .
_:c14n1 &lt;https://w3id.org/citizenship#birthCountry&gt; "Bahamas" .
_:c14n1 &lt;https://w3id.org/citizenship#employmentAuthorizationDocument&gt; _:c14n2 .
_:c14n1 &lt;https://w3id.org/citizenship#residentSince&gt; "2015-01-01"^^&lt;http://www.w3.org/2001/XMLSchema#dateTime&gt; .
_:c14n2 &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; &lt;https://w3id.org/citizenship#EmploymentAuthorizationDocument&gt; .
_:c14n2 &lt;https://schema.org/identifier&gt; "83627465" .
_:c14n2 &lt;https://w3id.org/citizenship#lprCategory&gt; "C09" .
_:c14n2 &lt;https://w3id.org/citizenship#lprNumber&gt; "999-999-999" .</pre>
      </div>


        <div class="example" id="example-hash-of-canonical-employment-authorization-credential-without-proof-hex">
        <div class="marker">
    <a class="self-link" href="#example-hash-of-canonical-employment-authorization-credential-without-proof-hex">Example<bdi> 21</bdi></a><span class="example-title">: Hash of Canonical Employment Authorization Credential without Proof (hex)</span>
  </div> <pre class="nohighlight">03f59e5b04ab575b1172cb684f22eede72f0e9033e0b5c67d0e2506768d6ce11</pre>
      </div>

        <p>
The next step is to take the proof options document, convert it to canonical
form, and obtain its hash, as shown in the next three examples.
        </p>

        <div class="example" id="example-proof-options-document-0">
        <div class="marker">
    <a class="self-link" href="#example-proof-options-document-0">Example<bdi> 22</bdi></a><span class="example-title">: Proof Options Document</span>
  </div> <pre class="nohighlight">{
  "type": "DataIntegrityProof",
  "cryptosuite": "eddsa-rdfc-2022",
  "created": "2023-02-24T23:36:38Z",
  "verificationMethod": "did:key:z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2#z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2",
  "proofPurpose": "assertionMethod",
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://w3id.org/citizenship/v4rc1"
  ]
}</pre>
      </div>

        <div class="example" id="example-canonical-proof-options-document-0">
        <div class="marker">
    <a class="self-link" href="#example-canonical-proof-options-document-0">Example<bdi> 23</bdi></a><span class="example-title">: Canonical Proof Options Document</span>
  </div> <pre class="nohighlight">_:c14n0 &lt;http://purl.org/dc/terms/created&gt; "2023-02-24T23:36:38Z"^^&lt;http://www.w3.org/2001/XMLSchema#dateTime&gt; .
_:c14n0 &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; &lt;https://w3id.org/security#DataIntegrityProof&gt; .
_:c14n0 &lt;https://w3id.org/security#cryptosuite&gt; "eddsa-rdfc-2022"^^&lt;https://w3id.org/security#cryptosuiteString&gt; .
_:c14n0 &lt;https://w3id.org/security#proofPurpose&gt; &lt;https://w3id.org/security#assertionMethod&gt; .
_:c14n0 &lt;https://w3id.org/security#verificationMethod&gt; &lt;did:key:z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2#z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2&gt; .</pre>
      </div>

        <div class="example" id="example-hash-of-canonical-proof-options-document-hex-0">
        <div class="marker">
    <a class="self-link" href="#example-hash-of-canonical-proof-options-document-hex-0">Example<bdi> 24</bdi></a><span class="example-title">: Hash of Canonical Proof Options Document (hex)</span>
  </div> <pre class="nohighlight">bea7b7acfbad0126b135104024a5f1733e705108f42d59668b05c0c50004c6b0</pre>
      </div>

        <p>
Finally, we concatenate the hash of the proof options followed by the hash of
the credential without proof, use the private key with the combined hash to
compute the Ed25519 signature, and then base58-btc encode the signature.
        </p>

        <div class="example" id="example-combine-hashes-of-proof-options-and-credential-hex-0">
        <div class="marker">
    <a class="self-link" href="#example-combine-hashes-of-proof-options-and-credential-hex-0">Example<bdi> 25</bdi></a><span class="example-title">: Combine hashes of Proof Options and Credential (hex)</span>
  </div> <pre class="nohighlight">bea7b7acfbad0126b135104024a5f1733e705108f42d59668b05c0c50004c6b003f59e5b04ab575b1172cb684f22eede72f0e9033e0b5c67d0e2506768d6ce11</pre>
      </div>

        <div class="example" id="example-signature-of-combined-hashes-hex-0">
        <div class="marker">
    <a class="self-link" href="#example-signature-of-combined-hashes-hex-0">Example<bdi> 26</bdi></a><span class="example-title">: Signature of Combined Hashes (hex)</span>
  </div> <pre class="nohighlight">20b1a944960b75ca69ba070af4820de6e6acae1afe827d8c566c0f7b932d1bd3abde3222b3095088051439a8b4e7a5356c7ba6d246774f875ebb6ddee1577003</pre>
      </div>

        <div class="example" id="example-signature-of-combined-hashes-base58-btc-0">
        <div class="marker">
    <a class="self-link" href="#example-signature-of-combined-hashes-base58-btc-0">Example<bdi> 27</bdi></a><span class="example-title">: Signature of Combined Hashes base58-btc</span>
  </div> <pre class="nohighlight">zeuuS9pi2ZR8Q41bFFJKS9weSWkwa7pRcxHTHzxjDEHtVSZp3D9Rm3JdzT82EQpmXMb9wvfFJLuDPeSXZaRX1q1c</pre>
      </div>

        <p>Assemble the signed credential with the following two steps:</p>
        <ol>
          <li>
Add the <code>proofValue</code> field with the previously computed base58-btc
value to the proof options document.
          </li>
          <li>
Set the <code>proof</code> field of the credential to the augmented proof
option document.
          </li>
        </ol>

        <div class="example" id="example-signed-employment-authorization-credential">
        <div class="marker">
    <a class="self-link" href="#example-signed-employment-authorization-credential">Example<bdi> 28</bdi></a><span class="example-title">: Signed Employment Authorization Credential</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://w3id.org/citizenship/v4rc1"
  ],
  "type": [
    "VerifiableCredential",
    "EmploymentAuthorizationDocumentCredential"
  ],
  "issuer": {
    "id": "did:key:zDnaegE6RR3atJtHKwTRTWHsJ3kNHqFwv7n9YjTgmU7TyfU76",
    "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQIW2NgUPr/HwADaAIhG61j/AAAAABJRU5ErkJggg=="
  },
  "credentialSubject": {
    "type": [
      "Person",
      "EmployablePerson"
    ],
    "givenName": "JOHN",
    "additionalName": "JACOB",
    "familyName": "SMITH",
    "image": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQIW2Ng+M/wHwAEAQH/7yMK/gAAAABJRU5ErkJggg==",
    "gender": "Male",
    "residentSince": "2015-01-01",
    "birthCountry": "Bahamas",
    "birthDate": "1999-07-17",
    "employmentAuthorizationDocument": {
      "type": "EmploymentAuthorizationDocument",
      "identifier": "83627465",
      "lprCategory": "C09",
      "lprNumber": "999-999-999"
    }
  },
  "name": "Employment Authorization Document",
  "description": "Example Employment Authorization Document.",
  "validFrom": "2019-12-03T00:00:00Z",
  "validUntil": "2029-12-03T00:00:00Z",
  "proof": {
    "type": "DataIntegrityProof",
    "cryptosuite": "eddsa-rdfc-2022",
    "created": "2023-02-24T23:36:38Z",
    "verificationMethod": "did:key:z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2#z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2",
    "proofPurpose": "assertionMethod",
    "proofValue": "zeuuS9pi2ZR8Q41bFFJKS9weSWkwa7pRcxHTHzxjDEHtVSZp3D9Rm3JdzT82EQpmXMb9wvfFJLuDPeSXZaRX1q1c"
  }
}</pre>
      </div>
      </section>
      <section id="representation-eddsa-jcs-2022"><div class="header-wrapper"><h3 id="b-3-representation-eddsa-jcs-2022"><bdi class="secno">B.3 </bdi>Representation: eddsa-jcs-2022</h3><a class="self-link" href="#representation-eddsa-jcs-2022" aria-label="Permalink for Appendix B.3"></a></div>
        
        <p>
The signer needs to generate a private/public key pair with the private key used
for signing and the public key made available for verification. The
representation of the public key, and the representation of the private key
are shown below.
        </p>
        <div class="example" id="example-private-and-public-keys-for-signature-1">
        <div class="marker">
    <a class="self-link" href="#example-private-and-public-keys-for-signature-1">Example<bdi> 29</bdi></a><span class="example-title">: Private and Public keys for Signature</span>
  </div> <pre class="nohighlight">{
  publicKeyMultibase: "z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2",
  secretKeyMultibase: "z3u2en7t5LR2WtQH5PfFqMqwVHBeXouLzo6haApm8XHqvjxq"
}</pre>
      </div>

        <p>
Signing begins with a credential without an attached proof, which is converted
to canonical form, and then hashed, as shown in the following three examples.
        </p>

        <div class="example" id="example-credential-without-proof-0">
        <div class="marker">
    <a class="self-link" href="#example-credential-without-proof-0">Example<bdi> 30</bdi></a><span class="example-title">: Credential without Proof</span>
  </div> <pre class="nohighlight">{
    "@context": [
        "https://www.w3.org/ns/credentials/v2",
        "https://www.w3.org/ns/credentials/examples/v2"
    ],
    "id": "urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33",
    "type": ["VerifiableCredential", "AlumniCredential"],
    "name": "Alumni Credential",
    "description": "A minimum viable example of an Alumni Credential.",
    "issuer": "https://vc.example/issuers/5678",
    "validFrom": "2023-01-01T00:00:00Z",
    "credentialSubject": {
        "id": "did:example:abcdefgh",
        "alumniOf": "The School of Examples"
    }
}</pre>
      </div>

        <div class="example" id="example-canonical-credential-without-proof-0">
        <div class="marker">
    <a class="self-link" href="#example-canonical-credential-without-proof-0">Example<bdi> 31</bdi></a><span class="example-title">: Canonical Credential without Proof</span>
  </div> <pre class="nohighlight">{"@context":["https://www.w3.org/ns/credentials/v2","https://www.w3.org/ns/credentials/examples/v2"],"credentialSubject":{"alumniOf":"The School of Examples","id":"did:example:abcdefgh"},"description":"A minimum viable example of an Alumni Credential.","id":"urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33","issuer":"https://vc.example/issuers/5678","name":"Alumni Credential","type":["VerifiableCredential","AlumniCredential"],"validFrom":"2023-01-01T00:00:00Z"}</pre>
      </div>


        <div class="example" id="example-hash-of-canonical-credential-without-proof-hex-0">
        <div class="marker">
    <a class="self-link" href="#example-hash-of-canonical-credential-without-proof-hex-0">Example<bdi> 32</bdi></a><span class="example-title">: Hash of Canonical Credential without Proof (hex)</span>
  </div> <pre class="nohighlight">59b7cb6251b8991add1ce0bc83107e3db9dbbab5bd2c28f687db1a03abc92f19</pre>
      </div>

        <p>
The next step is to take the proof options document, convert it to canonical form,
and obtain its hash, as shown in the next three examples.
        </p>

        <div class="example" id="example-proof-options-document-1">
        <div class="marker">
    <a class="self-link" href="#example-proof-options-document-1">Example<bdi> 33</bdi></a><span class="example-title">: Proof Options Document</span>
  </div> <pre class="nohighlight">{
  "type": "DataIntegrityProof",
  "cryptosuite": "eddsa-jcs-2022",
  "created": "2023-02-24T23:36:38Z",
  "verificationMethod": "did:key:z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2#z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2",
  "proofPurpose": "assertionMethod",
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ]
}</pre>
      </div>

        <div class="example" id="example-canonical-proof-options-document-1">
        <div class="marker">
    <a class="self-link" href="#example-canonical-proof-options-document-1">Example<bdi> 34</bdi></a><span class="example-title">: Canonical Proof Options Document</span>
  </div> <pre class="nohighlight">{"@context":["https://www.w3.org/ns/credentials/v2","https://www.w3.org/ns/credentials/examples/v2"],"created":"2023-02-24T23:36:38Z","cryptosuite":"eddsa-jcs-2022","proofPurpose":"assertionMethod","type":"DataIntegrityProof","verificationMethod":"did:key:z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2#z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2"}</pre>
      </div>

        <div class="example" id="example-hash-of-canonical-proof-options-document-hex-1">
        <div class="marker">
    <a class="self-link" href="#example-hash-of-canonical-proof-options-document-hex-1">Example<bdi> 35</bdi></a><span class="example-title">: Hash of Canonical Proof Options Document (hex)</span>
  </div> <pre class="nohighlight">66ab154f5c2890a140cb8388a22a160454f80575f6eae09e5a097cabe539a1db</pre>
      </div>

        <p>
Finally, we concatenate the hash of the proof options followed by the hash of the credential without proof, use the private key with the combined hash to
compute the Ed25519 signature, and then base58-btc encode the signature.
        </p>

        <div class="example" id="example-combine-hashes-of-proof-options-and-credential-hex-1">
        <div class="marker">
    <a class="self-link" href="#example-combine-hashes-of-proof-options-and-credential-hex-1">Example<bdi> 36</bdi></a><span class="example-title">: Combine hashes of Proof Options and Credential (hex)</span>
  </div> <pre class="nohighlight">66ab154f5c2890a140cb8388a22a160454f80575f6eae09e5a097cabe539a1db59b7cb6251b8991add1ce0bc83107e3db9dbbab5bd2c28f687db1a03abc92f19</pre>
      </div>

        <div class="example" id="example-signature-of-combined-hashes-hex-1">
        <div class="marker">
    <a class="self-link" href="#example-signature-of-combined-hashes-hex-1">Example<bdi> 37</bdi></a><span class="example-title">: Signature of Combined Hashes (hex)</span>
  </div> <pre class="nohighlight">407cd12654b33d718ecbb99179a1506daaa849450bf3fc523cce3e1c96f8b80351da3f253d725c6f00b07c9e5448d50b3ef78012b9ab54255116d069c6dd2808</pre>
      </div>

        <div class="example" id="example-signature-of-combined-hashes-base58-btc-1">
        <div class="marker">
    <a class="self-link" href="#example-signature-of-combined-hashes-base58-btc-1">Example<bdi> 38</bdi></a><span class="example-title">: Signature of Combined Hashes base58-btc</span>
  </div> <pre class="nohighlight">z2HnFSSPPBzR36zdDgK8PbEHeXbR56YF24jwMpt3R1eHXQzJDMWS93FCzpvJpwTWd3GAVFuUfjoJdcnTMuVor51aX</pre>
      </div>

        <p>
Assemble the signed credential with the following two steps:
	</p>
        <ol>
          <li>
Add the <code>proofValue</code> field with the previously computed base58-btc
value to the proof options document.
          </li>
          <li>
Set the <code>proof</code> field of the credential to the augmented proof
option document.
          </li>
        </ol>

        <div class="example" id="example-signed-credential-0">
        <div class="marker">
    <a class="self-link" href="#example-signed-credential-0">Example<bdi> 39</bdi></a><span class="example-title">: Signed Credential</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33",
  "type": [
    "VerifiableCredential",
    "AlumniCredential"
  ],
  "name": "Alumni Credential",
  "description": "A minimum viable example of an Alumni Credential.",
  "issuer": "https://vc.example/issuers/5678",
  "validFrom": "2023-01-01T00:00:00Z",
  "credentialSubject": {
    "id": "did:example:abcdefgh",
    "alumniOf": "The School of Examples"
  },
  "proof": {
    "type": "DataIntegrityProof",
    "cryptosuite": "eddsa-jcs-2022",
    "created": "2023-02-24T23:36:38Z",
    "verificationMethod": "did:key:z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2#z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2",
    "proofPurpose": "assertionMethod",
    "@context": [
      "https://www.w3.org/ns/credentials/v2",
      "https://www.w3.org/ns/credentials/examples/v2"
    ],
    "proofValue": "z2HnFSSPPBzR36zdDgK8PbEHeXbR56YF24jwMpt3R1eHXQzJDMWS93FCzpvJpwTWd3GAVFuUfjoJdcnTMuVor51aX"
  }
}</pre>
      </div>
      </section>
      <section id="representation-ed25519signature2020"><div class="header-wrapper"><h3 id="b-4-representation-ed25519signature2020"><bdi class="secno">B.4 </bdi>Representation: Ed25519Signature2020</h3><a class="self-link" href="#representation-ed25519signature2020" aria-label="Permalink for Appendix B.4"></a></div>
        
        <p>
The signer needs to generate a private/public key pair with the private key used
for signing and the public key made available for verification. The
representation of the public key, and the representation of the private key,
are shown below.
        </p>
        <div class="example" id="example-private-and-public-keys-for-signature-2">
        <div class="marker">
    <a class="self-link" href="#example-private-and-public-keys-for-signature-2">Example<bdi> 40</bdi></a><span class="example-title">: Private and Public keys for Signature</span>
  </div> <pre class="nohighlight">{
    publicKeyMultibase: "z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2",
    secretKeyMultibase: "z3u2en7t5LR2WtQH5PfFqMqwVHBeXouLzo6haApm8XHqvjxq"
}</pre>
      </div>

        <p>
Signing begins with a credential without an attached proof, which is converted
to canonical form, and then hashed, as shown in the following three examples.
        </p>

        <div class="example" id="example-credential-without-proof-1">
        <div class="marker">
    <a class="self-link" href="#example-credential-without-proof-1">Example<bdi> 41</bdi></a><span class="example-title">: Credential without Proof</span>
  </div> <pre class="nohighlight">{
    "@context": [
        "https://www.w3.org/ns/credentials/v2",
        "https://www.w3.org/ns/credentials/examples/v2"
    ],
    "id": "urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33",
    "type": ["VerifiableCredential", "AlumniCredential"],
    "name": "Alumni Credential",
    "description": "A minimum viable example of an Alumni Credential.",
    "issuer": "https://vc.example/issuers/5678",
    "validFrom": "2023-01-01T00:00:00Z",
    "credentialSubject": {
        "id": "did:example:abcdefgh",
        "alumniOf": "The School of Examples"
    }
}</pre>
      </div>

        <div class="example" id="example-canonical-credential-without-proof-1">
        <div class="marker">
    <a class="self-link" href="#example-canonical-credential-without-proof-1">Example<bdi> 42</bdi></a><span class="example-title">: Canonical Credential without Proof</span>
  </div> <pre class="nohighlight">&lt;did:example:abcdefgh&gt; &lt;https://www.w3.org/ns/credentials/examples#alumniOf&gt; "The School of Examples" .
&lt;urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33&gt; &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; &lt;https://www.w3.org/2018/credentials#VerifiableCredential&gt; .
&lt;urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33&gt; &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; &lt;https://www.w3.org/ns/credentials/examples#AlumniCredential&gt; .
&lt;urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33&gt; &lt;https://schema.org/description&gt; "A minimum viable example of an Alumni Credential." .
&lt;urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33&gt; &lt;https://schema.org/name&gt; "Alumni Credential" .
&lt;urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33&gt; &lt;https://www.w3.org/2018/credentials#credentialSubject&gt; &lt;did:example:abcdefgh&gt; .
&lt;urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33&gt; &lt;https://www.w3.org/2018/credentials#issuer&gt; &lt;https://vc.example/issuers/5678&gt; .
&lt;urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33&gt; &lt;https://www.w3.org/2018/credentials#validFrom&gt; "2023-01-01T00:00:00Z"^^&lt;http://www.w3.org/2001/XMLSchema#dateTime&gt; .</pre>
      </div>


        <div class="example" id="example-hash-of-canonical-credential-without-proof-hex-1">
        <div class="marker">
    <a class="self-link" href="#example-hash-of-canonical-credential-without-proof-hex-1">Example<bdi> 43</bdi></a><span class="example-title">: Hash of Canonical Credential without Proof (hex)</span>
  </div> <pre class="nohighlight">517744132ae165a5349155bef0bb0cf2258fff99dfe1dbd914b938d775a36017</pre>
      </div>

        <p>
The next step is to take the proof options document, convert it to canonical form,
and obtain its hash, as shown in the next three examples.
        </p>

        <div class="example" id="example-proof-options-document-2">
        <div class="marker">
    <a class="self-link" href="#example-proof-options-document-2">Example<bdi> 44</bdi></a><span class="example-title">: Proof Options Document</span>
  </div> <pre class="nohighlight">{
  "type": "Ed25519Signature2020",
  "created": "2023-02-24T23:36:38Z",
  "verificationMethod": "did:key:z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2#z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2",
  "proofPurpose": "assertionMethod",
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2",
    "https://w3id.org/security/suites/ed25519-2020/v1"
  ]
}</pre>
      </div>

        <div class="example" id="example-canonical-proof-options-document-2">
        <div class="marker">
    <a class="self-link" href="#example-canonical-proof-options-document-2">Example<bdi> 45</bdi></a><span class="example-title">: Canonical Proof Options Document</span>
  </div> <pre class="nohighlight">_:c14n0 &lt;http://purl.org/dc/terms/created&gt; "2023-02-24T23:36:38Z"^^&lt;http://www.w3.org/2001/XMLSchema#dateTime&gt; .
_:c14n0 &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#type&gt; &lt;https://w3id.org/security#Ed25519Signature2020&gt; .
_:c14n0 &lt;https://w3id.org/security#proofPurpose&gt; &lt;https://w3id.org/security#assertionMethod&gt; .
_:c14n0 &lt;https://w3id.org/security#verificationMethod&gt; &lt;did:key:z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2#z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2&gt; .</pre>
      </div>

        <div class="example" id="example-hash-of-canonical-proof-options-document-hex-2">
        <div class="marker">
    <a class="self-link" href="#example-hash-of-canonical-proof-options-document-hex-2">Example<bdi> 46</bdi></a><span class="example-title">: Hash of Canonical Proof Options Document (hex)</span>
  </div> <pre class="nohighlight">04e14bcf5727cba0c0aa04a04d22a56fef915d5f8f7756bb92ae67cb1d0c4847</pre>
      </div>

        <p>
Finally, we concatenate the hash of the proof options followed by the hash of the credential without proof, use the private key with the combined hash to
compute the Ed25519 signature, and then base58-btc encode the signature.
        </p>

        <div class="example" id="example-combine-hashes-of-proof-options-and-credential-hex-2">
        <div class="marker">
    <a class="self-link" href="#example-combine-hashes-of-proof-options-and-credential-hex-2">Example<bdi> 47</bdi></a><span class="example-title">: Combine hashes of Proof Options and Credential (hex)</span>
  </div> <pre class="nohighlight">04e14bcf5727cba0c0aa04a04d22a56fef915d5f8f7756bb92ae67cb1d0c4847517744132ae165a5349155bef0bb0cf2258fff99dfe1dbd914b938d775a36017</pre>
      </div>

        <div class="example" id="example-signature-of-combined-hashes-hex-2">
        <div class="marker">
    <a class="self-link" href="#example-signature-of-combined-hashes-hex-2">Example<bdi> 48</bdi></a><span class="example-title">: Signature of Combined Hashes (hex)</span>
  </div> <pre class="nohighlight">cd8d023e8a9b462d563bbbd24c4499d8172738eb3f5235d74f65971e9be36dd7f23a1e201791e9a6747e45b8fa877a984f51f591567365c4d8222ecad39be60c</pre>
      </div>

        <div class="example" id="example-signature-of-combined-hashes-base58-btc-2">
        <div class="marker">
    <a class="self-link" href="#example-signature-of-combined-hashes-base58-btc-2">Example<bdi> 49</bdi></a><span class="example-title">: Signature of Combined Hashes base58-btc</span>
  </div> <pre class="nohighlight">z57Mm1vboMtZiCyJ4aReZsv8co4Re64Y8GEjL1ZARzMbXZgkARFLqFs1P345NpPGG2hgCrS4nNdvJhpwnrNyG3kEF</pre>
      </div>

        <p>Assemble the signed credential with the following two steps:</p>
          <ol>
            <li>
Add the <code>proofValue</code> field with the previously computed base58-btc
value to the proof options document.
            </li>
            <li>
Set the <code>proof</code> field of the credential to the augmented proof
option document.
            </li>
          </ol>

        <div class="example" id="example-signed-credential-1">
        <div class="marker">
    <a class="self-link" href="#example-signed-credential-1">Example<bdi> 50</bdi></a><span class="example-title">: Signed Credential</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2",
    "https://w3id.org/security/suites/ed25519-2020/v1"
  ],
  "id": "urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33",
  "type": [
    "VerifiableCredential",
    "AlumniCredential"
  ],
  "name": "Alumni Credential",
  "description": "A minimum viable example of an Alumni Credential.",
  "issuer": "https://vc.example/issuers/5678",
  "validFrom": "2023-01-01T00:00:00Z",
  "credentialSubject": {
    "id": "did:example:abcdefgh",
    "alumniOf": "The School of Examples"
  },
  "proof": {
    "type": "Ed25519Signature2020",
    "created": "2023-02-24T23:36:38Z",
    "verificationMethod": "did:key:z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2#z6MkrJVnaZkeFzdQyMZu1cgjg7k1pZZ6pvBQ7XJPt4swbTQ2",
    "proofPurpose": "assertionMethod",
    "proofValue": "z57Mm1vboMtZiCyJ4aReZsv8co4Re64Y8GEjL1ZARzMbXZgkARFLqFs1P345NpPGG2hgCrS4nNdvJhpwnrNyG3kEF"
  }
}</pre>
      </div>
      </section>
      <section id="proof-sets-and-chains"><div class="header-wrapper"><h3 id="b-5-proof-sets-and-chains"><bdi class="secno">B.5 </bdi>Proof Sets and Chains</h3><a class="self-link" href="#proof-sets-and-chains" aria-label="Permalink for Appendix B.5"></a></div>
        
        <p>
Proof sets and chains are defined in the [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>]. We
provide test vectors showing the creation of proof sets and chains with the
<code>eddsa-rdfc-2022</code> cryptosuite. Multiple signers can be involved in the generation
of proof sets and chains so multiple public/private key pairs are needed. These
are shown below.
        </p>
        <div class="example" id="example-public-and-private-key-pairs">
        <div class="marker">
    <a class="self-link" href="#example-public-and-private-key-pairs">Example<bdi> 51</bdi></a><span class="example-title">: Public and Private Key Pairs</span>
  </div> <pre class="nohighlight">{
  "keyPair1": {
    "publicKeyMultibase": "z6MktgKTsu1QhX6QPbyqG6geXdw6FQCZBPq7uQpieWbiQiG7",
    "privateKeyMultibase": "z3u2W4YnTstS1nSSBAgZcYSJF43JuZ9uLV6bF38B1Bf8NugW"
  },
  "keyPair2": {
    "publicKeyMultibase": "z6MkhWqdDBPojHA7cprTGTt5yHv5yUi1B8cnXn8ReLumkw6E",
    "privateKeyMultibase": "z3u2cfp4Q17kMGhNCh348a3yw3cUBiWK6RXRzyJE54sixMFn"
  },
  "keyPair3": {
    "publicKeyMultibase": "z6MkmEq87wkHCYnWnNZkigeDMGTN7oUw1upkhzd77KuXERS1",
    "privateKeyMultibase": "z3u2Zr3tcDLBDQKGxVa9SRDFNLqNqPWsa8p9rWPvCEH6bADB"
  },
  "keyPair4": {
    "publicKeyMultibase": "z6Mkm1S51iPHJvDEkJ9MRtxJmT8Pqo6wHipAFwBAjN83vntT",
    "privateKeyMultibase": "z3u2ZTWiFwM17veUR7sXniY66Gf14SqMdpMLy7SW9x4EDdmw"
  }
}</pre>
      </div>
        <p>
The original unsigned credential is shown below:
        </p>
        <div class="example" id="example-unsigned-credential">
        <div class="marker">
    <a class="self-link" href="#example-unsigned-credential">Example<bdi> 52</bdi></a><span class="example-title">: Unsigned Credential</span>
  </div> <pre class="nohighlight">{
    "@context": [
        "https://www.w3.org/ns/credentials/v2",
        "https://www.w3.org/ns/credentials/examples/v2"
    ],
    "id": "urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33",
    "type": ["VerifiableCredential", "AlumniCredential"],
    "name": "Alumni Credential",
    "description": "A minimum viable example of an Alumni Credential.",
    "issuer": "https://vc.example/issuers/5678",
    "validFrom": "2023-01-01T00:00:00Z",
    "credentialSubject": {
        "id": "did:example:abcdefgh",
        "alumniOf": "The School of Examples"
    }
}</pre>
      </div>
        <section id="proof-set"><div class="header-wrapper"><h4 id="b-5-1-proof-set"><bdi class="secno">B.5.1 </bdi>Proof Set</h4><a class="self-link" href="#proof-set" aria-label="Permalink for Appendix B.5.1"></a></div>
          
          <p>
To demonstrate creating a proof set, we start with a document containing a
single proof and add another proof to it. The starting document is shown below and
contains a proof signed with <code>keyPair1</code>.
          </p>
          <div class="example" id="example-starting-document-for-proof-set">
        <div class="marker">
    <a class="self-link" href="#example-starting-document-for-proof-set">Example<bdi> 53</bdi></a><span class="example-title">: Starting Document for Proof Set</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33",
  "type": [
    "VerifiableCredential",
    "AlumniCredential"
  ],
  "name": "Alumni Credential",
  "description": "A minimum viable example of an Alumni Credential.",
  "issuer": "https://vc.example/issuers/5678",
  "validFrom": "2023-01-01T00:00:00Z",
  "credentialSubject": {
    "id": "did:example:abcdefgh",
    "alumniOf": "The School of Examples"
  },
  "proof": {
    "type": "DataIntegrityProof",
    "id": "urn:uuid:26329423-bec9-4b2e-88cb-a7c7d9dc4544",
    "cryptosuite": "eddsa-rdfc-2022",
    "created": "2023-02-24T23:36:38Z",
    "verificationMethod": "did:key:z6MktgKTsu1QhX6QPbyqG6geXdw6FQCZBPq7uQpieWbiQiG7#z6MktgKTsu1QhX6QPbyqG6geXdw6FQCZBPq7uQpieWbiQiG7",
    "proofPurpose": "assertionMethod",
    "proofValue": "z66vWyqwAghu52WbpRkCwFRTu6Msn92ArtjpJ3gGMSVoU5RADwBfszoDt1QWY8owqLPz4nTj7hAwV7xFti1p93zdr"
  }
}</pre>
      </div>
          <p>
The <code>options</code> input to <a href="https://www.w3.org/TR/vc-data-integrity/#add-proof-set-chain">
Section 4.4: Add Proof Set/Chain</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>]
is shown below. Note that it does not include a <code>previousProof</code> attribute since
we are constructing a proof set and not a chain. In addition, we will be using
<code>keyPair2</code> for signing.
          </p>
          <div class="example" id="example-proof-options-for-set">
        <div class="marker">
    <a class="self-link" href="#example-proof-options-for-set">Example<bdi> 54</bdi></a><span class="example-title">: Proof Options for Set</span>
  </div> <pre class="nohighlight">{
  "type": "DataIntegrityProof",
  "id": "urn:uuid:8cc9022b-6b14-4cf3-8571-74972c5feb54",
  "cryptosuite": "eddsa-rdfc-2022",
  "created": "2023-02-24T23:36:38Z",
  "verificationMethod": "did:key:z6MkhWqdDBPojHA7cprTGTt5yHv5yUi1B8cnXn8ReLumkw6E#z6MkhWqdDBPojHA7cprTGTt5yHv5yUi1B8cnXn8ReLumkw6E",
  "proofPurpose": "assertionMethod"
}</pre>
      </div>
          <p>
Per the algorithm of <a href="https://www.w3.org/TR/vc-data-integrity/#add-proof-set-chain">
Section 4.4: Add Proof Set/Chain</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>],
we create an array variable, <code>allProofs</code>, and add the proof from the
starting document to it. Since there is no <code>previousProof</code> attribute, no
modification of <code>unsignedDocument</code> is needed prior to computing the signed proof
in step 6 of <a href="https://www.w3.org/TR/vc-data-integrity/#add-proof-set-chain">
Section 4.4: Add Proof Set/Chain</a> in
[<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>]. The signed proof configuration is shown below.
          </p>
          <div class="example" id="example-signed-proof-options">
        <div class="marker">
    <a class="self-link" href="#example-signed-proof-options">Example<bdi> 55</bdi></a><span class="example-title">: Signed Proof Options</span>
  </div> <pre class="nohighlight">{
  "type": "DataIntegrityProof",
  "id": "urn:uuid:8cc9022b-6b14-4cf3-8571-74972c5feb54",
  "cryptosuite": "eddsa-rdfc-2022",
  "created": "2023-02-24T23:36:38Z",
  "verificationMethod": "did:key:z6MkhWqdDBPojHA7cprTGTt5yHv5yUi1B8cnXn8ReLumkw6E#z6MkhWqdDBPojHA7cprTGTt5yHv5yUi1B8cnXn8ReLumkw6E",
  "proofPurpose": "assertionMethod",
  "proofValue": "z2scr94SNNrGpP2bE7ajvKWeUHm7HJ2edDkxpARvFAQ8V3USzwEzibqrXKaLHBrWostswsfvg82twQR88BgtnsrXY"
}</pre>
      </div>
          <p>
The signed proof <code>options</code> above gets appended to the <code>allProofs</code>
variable, which then gets set as the <code>proof</code> attribute of the unsigned document
to produce the final signed document as shown below.
          </p>
          <div class="example" id="example-signed-proof-set">
        <div class="marker">
    <a class="self-link" href="#example-signed-proof-set">Example<bdi> 56</bdi></a><span class="example-title">: Signed Proof Set</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33",
  "type": [
    "VerifiableCredential",
    "AlumniCredential"
  ],
  "name": "Alumni Credential",
  "description": "A minimum viable example of an Alumni Credential.",
  "issuer": "https://vc.example/issuers/5678",
  "validFrom": "2023-01-01T00:00:00Z",
  "credentialSubject": {
    "id": "did:example:abcdefgh",
    "alumniOf": "The School of Examples"
  },
  "proof": [
    {
      "type": "DataIntegrityProof",
      "id": "urn:uuid:26329423-bec9-4b2e-88cb-a7c7d9dc4544",
      "cryptosuite": "eddsa-rdfc-2022",
      "created": "2023-02-24T23:36:38Z",
      "verificationMethod": "did:key:z6MktgKTsu1QhX6QPbyqG6geXdw6FQCZBPq7uQpieWbiQiG7#z6MktgKTsu1QhX6QPbyqG6geXdw6FQCZBPq7uQpieWbiQiG7",
      "proofPurpose": "assertionMethod",
      "proofValue": "z66vWyqwAghu52WbpRkCwFRTu6Msn92ArtjpJ3gGMSVoU5RADwBfszoDt1QWY8owqLPz4nTj7hAwV7xFti1p93zdr"
    },
    {
      "type": "DataIntegrityProof",
      "id": "urn:uuid:8cc9022b-6b14-4cf3-8571-74972c5feb54",
      "cryptosuite": "eddsa-rdfc-2022",
      "created": "2023-02-24T23:36:38Z",
      "verificationMethod": "did:key:z6MkhWqdDBPojHA7cprTGTt5yHv5yUi1B8cnXn8ReLumkw6E#z6MkhWqdDBPojHA7cprTGTt5yHv5yUi1B8cnXn8ReLumkw6E",
      "proofPurpose": "assertionMethod",
      "proofValue": "z2scr94SNNrGpP2bE7ajvKWeUHm7HJ2edDkxpARvFAQ8V3USzwEzibqrXKaLHBrWostswsfvg82twQR88BgtnsrXY"
    }
  ]
}</pre>
      </div>
        </section>

        <section id="proof-chain-with-multiple-dependencies"><div class="header-wrapper"><h4 id="b-5-2-proof-chain-with-multiple-dependencies"><bdi class="secno">B.5.2 </bdi>Proof Chain with Multiple Dependencies</h4><a class="self-link" href="#proof-chain-with-multiple-dependencies" aria-label="Permalink for Appendix B.5.2"></a></div>
          
          <p>
This collection of test vectors demonstrates the construction a proof chain. We
start with a document containing a proof set, i.e., our previous example, and
then add a new proof to the credential that has a dependency on the existing
proofs. This example also demonstrates the case where the <code>previousProofs</code>
attribute is an array. This example uses <code>keyPair3</code> and the starting document is
given below.
          </p>
          <div class="example" id="example-starting-document-for-proof-chain">
        <div class="marker">
    <a class="self-link" href="#example-starting-document-for-proof-chain">Example<bdi> 57</bdi></a><span class="example-title">: Starting Document for Proof Chain</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33",
  "type": [
    "VerifiableCredential",
    "AlumniCredential"
  ],
  "name": "Alumni Credential",
  "description": "A minimum viable example of an Alumni Credential.",
  "issuer": "https://vc.example/issuers/5678",
  "validFrom": "2023-01-01T00:00:00Z",
  "credentialSubject": {
    "id": "did:example:abcdefgh",
    "alumniOf": "The School of Examples"
  },
  "proof": [
    {
      "type": "DataIntegrityProof",
      "id": "urn:uuid:26329423-bec9-4b2e-88cb-a7c7d9dc4544",
      "cryptosuite": "eddsa-rdfc-2022",
      "created": "2023-02-24T23:36:38Z",
      "verificationMethod": "did:key:z6MktgKTsu1QhX6QPbyqG6geXdw6FQCZBPq7uQpieWbiQiG7#z6MktgKTsu1QhX6QPbyqG6geXdw6FQCZBPq7uQpieWbiQiG7",
      "proofPurpose": "assertionMethod",
      "proofValue": "z66vWyqwAghu52WbpRkCwFRTu6Msn92ArtjpJ3gGMSVoU5RADwBfszoDt1QWY8owqLPz4nTj7hAwV7xFti1p93zdr"
    },
    {
      "type": "DataIntegrityProof",
      "id": "urn:uuid:8cc9022b-6b14-4cf3-8571-74972c5feb54",
      "cryptosuite": "eddsa-rdfc-2022",
      "created": "2023-02-24T23:36:38Z",
      "verificationMethod": "did:key:z6MkhWqdDBPojHA7cprTGTt5yHv5yUi1B8cnXn8ReLumkw6E#z6MkhWqdDBPojHA7cprTGTt5yHv5yUi1B8cnXn8ReLumkw6E",
      "proofPurpose": "assertionMethod",
      "proofValue": "z2scr94SNNrGpP2bE7ajvKWeUHm7HJ2edDkxpARvFAQ8V3USzwEzibqrXKaLHBrWostswsfvg82twQR88BgtnsrXY"
    }
  ]
}</pre>
      </div>
          <p>
The <code>options</code> input to <a href="https://www.w3.org/TR/vc-data-integrity/#add-proof-set-chain">
Section 4.4: Add Proof Set/Chain</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>]
is shown below. Note that it includes a <code>previousProof</code> attribute since we are
constructing a proof chain.
          </p>
          <div class="example" id="example-options-for-proof-chain">
        <div class="marker">
    <a class="self-link" href="#example-options-for-proof-chain">Example<bdi> 58</bdi></a><span class="example-title">: Options for Proof Chain</span>
  </div> <pre class="nohighlight">{
  "type": "DataIntegrityProof",
  "id": "urn:uuid:d94f792a-c546-4d06-b38a-da070ab56c23",
  "cryptosuite": "eddsa-rdfc-2022",
  "created": "2023-02-26T22:06:38Z",
  "verificationMethod": "did:key:z6MkmEq87wkHCYnWnNZkigeDMGTN7oUw1upkhzd77KuXERS1#z6MkmEq87wkHCYnWnNZkigeDMGTN7oUw1upkhzd77KuXERS1",
  "proofPurpose": "assertionMethod",
  "previousProof": [
    "urn:uuid:26329423-bec9-4b2e-88cb-a7c7d9dc4544",
    "urn:uuid:8cc9022b-6b14-4cf3-8571-74972c5feb54"
  ]
}</pre>
      </div>
          <p>
Per the algorithm of <a href="https://www.w3.org/TR/vc-data-integrity/#add-proof-set-chain">
Section 4.4: Add Proof Set/Chain</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>],
we create an array variable, <code>allProofs</code>, and add the proofs from the
starting document to it. Since the options contains the <code>previousProof</code>
attribute, we compute the <code>matchingProofs</code> variable per step 4
of <a href="https://www.w3.org/TR/vc-data-integrity/#add-proof-set-chain">Section 4.4: Add Proof
Set/Chain</a>, and we set the
<code>unsecuredDocument.proof</code> equal to the <code>matchingProofs</code>. This
produces the document shown below.
          </p>
          <div class="example" id="example-temporary-unsecured-document-for-binding-previous-proofs">
        <div class="marker">
    <a class="self-link" href="#example-temporary-unsecured-document-for-binding-previous-proofs">Example<bdi> 59</bdi></a><span class="example-title">: Temporary Unsecured Document for Binding Previous Proofs</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33",
  "type": [
    "VerifiableCredential",
    "AlumniCredential"
  ],
  "name": "Alumni Credential",
  "description": "A minimum viable example of an Alumni Credential.",
  "issuer": "https://vc.example/issuers/5678",
  "validFrom": "2023-01-01T00:00:00Z",
  "credentialSubject": {
    "id": "did:example:abcdefgh",
    "alumniOf": "The School of Examples"
  },
  "proof": [
    {
      "type": "DataIntegrityProof",
      "id": "urn:uuid:26329423-bec9-4b2e-88cb-a7c7d9dc4544",
      "cryptosuite": "eddsa-rdfc-2022",
      "created": "2023-02-24T23:36:38Z",
      "verificationMethod": "did:key:z6MktgKTsu1QhX6QPbyqG6geXdw6FQCZBPq7uQpieWbiQiG7#z6MktgKTsu1QhX6QPbyqG6geXdw6FQCZBPq7uQpieWbiQiG7",
      "proofPurpose": "assertionMethod",
      "proofValue": "z66vWyqwAghu52WbpRkCwFRTu6Msn92ArtjpJ3gGMSVoU5RADwBfszoDt1QWY8owqLPz4nTj7hAwV7xFti1p93zdr"
    },
    {
      "type": "DataIntegrityProof",
      "id": "urn:uuid:8cc9022b-6b14-4cf3-8571-74972c5feb54",
      "cryptosuite": "eddsa-rdfc-2022",
      "created": "2023-02-24T23:36:38Z",
      "verificationMethod": "did:key:z6MkhWqdDBPojHA7cprTGTt5yHv5yUi1B8cnXn8ReLumkw6E#z6MkhWqdDBPojHA7cprTGTt5yHv5yUi1B8cnXn8ReLumkw6E",
      "proofPurpose": "assertionMethod",
      "proofValue": "z2scr94SNNrGpP2bE7ajvKWeUHm7HJ2edDkxpARvFAQ8V3USzwEzibqrXKaLHBrWostswsfvg82twQR88BgtnsrXY"
    }
  ]
}</pre>
      </div>
          <p>
In step 6, we use the previous document (unsecured document with previous proofs
added to it) to compute the <code>proofValue</code> attribute. This gives the signed
configuration options (proof) shown below:
          </p>
          <div class="example" id="example-signed-configuration-options-proof">
        <div class="marker">
    <a class="self-link" href="#example-signed-configuration-options-proof">Example<bdi> 60</bdi></a><span class="example-title">: Signed Configuration Options (proof)</span>
  </div> <pre class="nohighlight">{
  "type": "DataIntegrityProof",
  "id": "urn:uuid:d94f792a-c546-4d06-b38a-da070ab56c23",
  "cryptosuite": "eddsa-rdfc-2022",
  "created": "2023-02-26T22:06:38Z",
  "verificationMethod": "did:key:z6MkmEq87wkHCYnWnNZkigeDMGTN7oUw1upkhzd77KuXERS1#z6MkmEq87wkHCYnWnNZkigeDMGTN7oUw1upkhzd77KuXERS1",
  "proofPurpose": "assertionMethod",
  "previousProof": [
    "urn:uuid:26329423-bec9-4b2e-88cb-a7c7d9dc4544",
    "urn:uuid:8cc9022b-6b14-4cf3-8571-74972c5feb54"
  ],
  "proofValue": "zWaPeEvBAkhQpNQj8pknuvg5STcKnt3cvM9t4kAYeJETFjvVMSXEEjadC4uxC9fKCn6JHbjt6fj2fhoaVNynBm6J"
}</pre>
      </div>
          <p>
The signed proof <code>options</code> above gets appended to the <code>allProofs</code>
variable, which then gets set as the <code>proof</code> attribute of the unsigned document
to produce the final signed document as shown below.
          </p>
          <div class="example" id="example-signed-proof-chain">
        <div class="marker">
    <a class="self-link" href="#example-signed-proof-chain">Example<bdi> 61</bdi></a><span class="example-title">: Signed Proof Chain</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33",
  "type": [
    "VerifiableCredential",
    "AlumniCredential"
  ],
  "name": "Alumni Credential",
  "description": "A minimum viable example of an Alumni Credential.",
  "issuer": "https://vc.example/issuers/5678",
  "validFrom": "2023-01-01T00:00:00Z",
  "credentialSubject": {
    "id": "did:example:abcdefgh",
    "alumniOf": "The School of Examples"
  },
  "proof": [
    {
      "type": "DataIntegrityProof",
      "id": "urn:uuid:26329423-bec9-4b2e-88cb-a7c7d9dc4544",
      "cryptosuite": "eddsa-rdfc-2022",
      "created": "2023-02-24T23:36:38Z",
      "verificationMethod": "did:key:z6MktgKTsu1QhX6QPbyqG6geXdw6FQCZBPq7uQpieWbiQiG7#z6MktgKTsu1QhX6QPbyqG6geXdw6FQCZBPq7uQpieWbiQiG7",
      "proofPurpose": "assertionMethod",
      "proofValue": "z66vWyqwAghu52WbpRkCwFRTu6Msn92ArtjpJ3gGMSVoU5RADwBfszoDt1QWY8owqLPz4nTj7hAwV7xFti1p93zdr"
    },
    {
      "type": "DataIntegrityProof",
      "id": "urn:uuid:8cc9022b-6b14-4cf3-8571-74972c5feb54",
      "cryptosuite": "eddsa-rdfc-2022",
      "created": "2023-02-24T23:36:38Z",
      "verificationMethod": "did:key:z6MkhWqdDBPojHA7cprTGTt5yHv5yUi1B8cnXn8ReLumkw6E#z6MkhWqdDBPojHA7cprTGTt5yHv5yUi1B8cnXn8ReLumkw6E",
      "proofPurpose": "assertionMethod",
      "proofValue": "z2scr94SNNrGpP2bE7ajvKWeUHm7HJ2edDkxpARvFAQ8V3USzwEzibqrXKaLHBrWostswsfvg82twQR88BgtnsrXY"
    },
    {
      "type": "DataIntegrityProof",
      "id": "urn:uuid:d94f792a-c546-4d06-b38a-da070ab56c23",
      "cryptosuite": "eddsa-rdfc-2022",
      "created": "2023-02-26T22:06:38Z",
      "verificationMethod": "did:key:z6MkmEq87wkHCYnWnNZkigeDMGTN7oUw1upkhzd77KuXERS1#z6MkmEq87wkHCYnWnNZkigeDMGTN7oUw1upkhzd77KuXERS1",
      "proofPurpose": "assertionMethod",
      "previousProof": [
        "urn:uuid:26329423-bec9-4b2e-88cb-a7c7d9dc4544",
        "urn:uuid:8cc9022b-6b14-4cf3-8571-74972c5feb54"
      ],
      "proofValue": "zWaPeEvBAkhQpNQj8pknuvg5STcKnt3cvM9t4kAYeJETFjvVMSXEEjadC4uxC9fKCn6JHbjt6fj2fhoaVNynBm6J"
    }
  ]
}</pre>
      </div>
        </section>
        <section id="extended-proof-chain"><div class="header-wrapper"><h4 id="b-5-3-extended-proof-chain"><bdi class="secno">B.5.3 </bdi>Extended Proof Chain</h4><a class="self-link" href="#extended-proof-chain" aria-label="Permalink for Appendix B.5.3"></a></div>
          
          <p>
This collection of test vectors demonstrates construction of an extended proof
chain. We start with the output of the previous section and add an additional
proof that is dependent on one of the existing proofs. This example uses
<code>keyPair4</code>, and the starting document is given below.
          </p>
          <div class="example" id="example-starting-document-for-extended-proof-chain">
        <div class="marker">
    <a class="self-link" href="#example-starting-document-for-extended-proof-chain">Example<bdi> 62</bdi></a><span class="example-title">: Starting Document for Extended Proof Chain</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33",
  "type": [
    "VerifiableCredential",
    "AlumniCredential"
  ],
  "name": "Alumni Credential",
  "description": "A minimum viable example of an Alumni Credential.",
  "issuer": "https://vc.example/issuers/5678",
  "validFrom": "2023-01-01T00:00:00Z",
  "credentialSubject": {
    "id": "did:example:abcdefgh",
    "alumniOf": "The School of Examples"
  },
  "proof": [
    {
      "type": "DataIntegrityProof",
      "id": "urn:uuid:26329423-bec9-4b2e-88cb-a7c7d9dc4544",
      "cryptosuite": "eddsa-rdfc-2022",
      "created": "2023-02-24T23:36:38Z",
      "verificationMethod": "did:key:z6MktgKTsu1QhX6QPbyqG6geXdw6FQCZBPq7uQpieWbiQiG7#z6MktgKTsu1QhX6QPbyqG6geXdw6FQCZBPq7uQpieWbiQiG7",
      "proofPurpose": "assertionMethod",
      "proofValue": "z66vWyqwAghu52WbpRkCwFRTu6Msn92ArtjpJ3gGMSVoU5RADwBfszoDt1QWY8owqLPz4nTj7hAwV7xFti1p93zdr"
    },
    {
      "type": "DataIntegrityProof",
      "id": "urn:uuid:8cc9022b-6b14-4cf3-8571-74972c5feb54",
      "cryptosuite": "eddsa-rdfc-2022",
      "created": "2023-02-24T23:36:38Z",
      "verificationMethod": "did:key:z6MkhWqdDBPojHA7cprTGTt5yHv5yUi1B8cnXn8ReLumkw6E#z6MkhWqdDBPojHA7cprTGTt5yHv5yUi1B8cnXn8ReLumkw6E",
      "proofPurpose": "assertionMethod",
      "proofValue": "z2scr94SNNrGpP2bE7ajvKWeUHm7HJ2edDkxpARvFAQ8V3USzwEzibqrXKaLHBrWostswsfvg82twQR88BgtnsrXY"
    },
    {
      "type": "DataIntegrityProof",
      "id": "urn:uuid:d94f792a-c546-4d06-b38a-da070ab56c23",
      "cryptosuite": "eddsa-rdfc-2022",
      "created": "2023-02-26T22:06:38Z",
      "verificationMethod": "did:key:z6MkmEq87wkHCYnWnNZkigeDMGTN7oUw1upkhzd77KuXERS1#z6MkmEq87wkHCYnWnNZkigeDMGTN7oUw1upkhzd77KuXERS1",
      "proofPurpose": "assertionMethod",
      "previousProof": [
        "urn:uuid:26329423-bec9-4b2e-88cb-a7c7d9dc4544",
        "urn:uuid:8cc9022b-6b14-4cf3-8571-74972c5feb54"
      ],
      "proofValue": "zWaPeEvBAkhQpNQj8pknuvg5STcKnt3cvM9t4kAYeJETFjvVMSXEEjadC4uxC9fKCn6JHbjt6fj2fhoaVNynBm6J"
    }
  ]
}</pre>
      </div>
          <p>
The <code>options</code> input to <a href="https://www.w3.org/TR/vc-data-integrity/#add-proof-set-chain">
Section 4.4: Add Proof Set/Chain</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>]
is shown below. Note that it includes a <code>previousProof</code> attribute since we are
constructing a proof chain, however this time it is a single value.
          </p>
          <div class="example" id="example-options-for-extended-proof-chain">
        <div class="marker">
    <a class="self-link" href="#example-options-for-extended-proof-chain">Example<bdi> 63</bdi></a><span class="example-title">: Options for Extended Proof Chain</span>
  </div> <pre class="nohighlight">{
  "type": "DataIntegrityProof",
  "cryptosuite": "eddsa-rdfc-2022",
  "created": "2023-02-26T22:16:38Z",
  "verificationMethod": "did:key:z6Mkm1S51iPHJvDEkJ9MRtxJmT8Pqo6wHipAFwBAjN83vntT#z6Mkm1S51iPHJvDEkJ9MRtxJmT8Pqo6wHipAFwBAjN83vntT",
  "proofPurpose": "assertionMethod",
  "previousProof": "urn:uuid:d94f792a-c546-4d06-b38a-da070ab56c23"
}</pre>
      </div>
          <p>
Per the algorithm of <a href="https://www.w3.org/TR/vc-data-integrity/#add-proof-set-chain">
Section 4.4: Add Proof Set/Chain</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>],
we create an array variable, <code>allProofs</code>, and add the proofs from the
starting document to it. Since the <code>options</code> contains the <code>previousProof</code>
attribute, we compute the <code>matchingProofs</code> variable per step 4
of <a href="https://www.w3.org/TR/vc-data-integrity/#add-proof-set-chain">Section 4.4: Add Proof
Set/Chain</a>, and we set the
<code>unsecuredDocument.proof</code> equal to the <code>matchingProofs</code>. This
produces the document shown below.
          </p>
          <div class="example" id="example-temporary-unsecured-document-for-binding-previous-proofs-extended-chain">
        <div class="marker">
    <a class="self-link" href="#example-temporary-unsecured-document-for-binding-previous-proofs-extended-chain">Example<bdi> 64</bdi></a><span class="example-title">: Temporary Unsecured Document for Binding Previous Proofs (Extended Chain)</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33",
  "type": [
    "VerifiableCredential",
    "AlumniCredential"
  ],
  "name": "Alumni Credential",
  "description": "A minimum viable example of an Alumni Credential.",
  "issuer": "https://vc.example/issuers/5678",
  "validFrom": "2023-01-01T00:00:00Z",
  "credentialSubject": {
    "id": "did:example:abcdefgh",
    "alumniOf": "The School of Examples"
  },
  "proof": [
    {
      "type": "DataIntegrityProof",
      "id": "urn:uuid:d94f792a-c546-4d06-b38a-da070ab56c23",
      "cryptosuite": "eddsa-rdfc-2022",
      "created": "2023-02-26T22:06:38Z",
      "verificationMethod": "did:key:z6MkmEq87wkHCYnWnNZkigeDMGTN7oUw1upkhzd77KuXERS1#z6MkmEq87wkHCYnWnNZkigeDMGTN7oUw1upkhzd77KuXERS1",
      "proofPurpose": "assertionMethod",
      "previousProof": [
        "urn:uuid:26329423-bec9-4b2e-88cb-a7c7d9dc4544",
        "urn:uuid:8cc9022b-6b14-4cf3-8571-74972c5feb54"
      ],
      "proofValue": "zWaPeEvBAkhQpNQj8pknuvg5STcKnt3cvM9t4kAYeJETFjvVMSXEEjadC4uxC9fKCn6JHbjt6fj2fhoaVNynBm6J"
    }
  ]
}</pre>
      </div>
          <p>
In step 6, we use the previous document (unsecured document with previous proofs
added to it) to compute the <code>proofValue</code> attribute. This gives the signed
configuration options (proof) shown below:
          </p>
          <div class="example" id="example-signed-configuration-options-extended">
        <div class="marker">
    <a class="self-link" href="#example-signed-configuration-options-extended">Example<bdi> 65</bdi></a><span class="example-title">: Signed Configuration Options (Extended)</span>
  </div> <pre class="nohighlight">{
  "type": "DataIntegrityProof",
  "cryptosuite": "eddsa-rdfc-2022",
  "created": "2023-02-26T22:16:38Z",
  "verificationMethod": "did:key:z6Mkm1S51iPHJvDEkJ9MRtxJmT8Pqo6wHipAFwBAjN83vntT#z6Mkm1S51iPHJvDEkJ9MRtxJmT8Pqo6wHipAFwBAjN83vntT",
  "proofPurpose": "assertionMethod",
  "previousProof": "urn:uuid:d94f792a-c546-4d06-b38a-da070ab56c23",
  "proofValue": "z4b5uUtxNiV4E541LiR8qLvA21xM1Vt4Hfn6nLmmDePdFvLB3jFj3HyEEJyRMbpJzv4Gfdr8ABeuRTxAvZv6KWRRh"
}</pre>
      </div>
          <p>
The signed proof <code>options</code> above gets appended to the <code>allProofs</code>
variable, which then gets set as the <code>proof</code> attribute of the unsigned document
to produce the final signed document as shown below.
          </p>
          <div class="example" id="example-signed-proof-chain-extended">
        <div class="marker">
    <a class="self-link" href="#example-signed-proof-chain-extended">Example<bdi> 66</bdi></a><span class="example-title">: Signed Proof Chain (Extended)</span>
  </div> <pre class="nohighlight">{
  "@context": [
    "https://www.w3.org/ns/credentials/v2",
    "https://www.w3.org/ns/credentials/examples/v2"
  ],
  "id": "urn:uuid:58172aac-d8ba-11ed-83dd-0b3aef56cc33",
  "type": [
    "VerifiableCredential",
    "AlumniCredential"
  ],
  "name": "Alumni Credential",
  "description": "A minimum viable example of an Alumni Credential.",
  "issuer": "https://vc.example/issuers/5678",
  "validFrom": "2023-01-01T00:00:00Z",
  "credentialSubject": {
    "id": "did:example:abcdefgh",
    "alumniOf": "The School of Examples"
  },
  "proof": [
    {
      "type": "DataIntegrityProof",
      "id": "urn:uuid:26329423-bec9-4b2e-88cb-a7c7d9dc4544",
      "cryptosuite": "eddsa-rdfc-2022",
      "created": "2023-02-24T23:36:38Z",
      "verificationMethod": "did:key:z6MktgKTsu1QhX6QPbyqG6geXdw6FQCZBPq7uQpieWbiQiG7#z6MktgKTsu1QhX6QPbyqG6geXdw6FQCZBPq7uQpieWbiQiG7",
      "proofPurpose": "assertionMethod",
      "proofValue": "z66vWyqwAghu52WbpRkCwFRTu6Msn92ArtjpJ3gGMSVoU5RADwBfszoDt1QWY8owqLPz4nTj7hAwV7xFti1p93zdr"
    },
    {
      "type": "DataIntegrityProof",
      "id": "urn:uuid:8cc9022b-6b14-4cf3-8571-74972c5feb54",
      "cryptosuite": "eddsa-rdfc-2022",
      "created": "2023-02-24T23:36:38Z",
      "verificationMethod": "did:key:z6MkhWqdDBPojHA7cprTGTt5yHv5yUi1B8cnXn8ReLumkw6E#z6MkhWqdDBPojHA7cprTGTt5yHv5yUi1B8cnXn8ReLumkw6E",
      "proofPurpose": "assertionMethod",
      "proofValue": "z2scr94SNNrGpP2bE7ajvKWeUHm7HJ2edDkxpARvFAQ8V3USzwEzibqrXKaLHBrWostswsfvg82twQR88BgtnsrXY"
    },
    {
      "type": "DataIntegrityProof",
      "id": "urn:uuid:d94f792a-c546-4d06-b38a-da070ab56c23",
      "cryptosuite": "eddsa-rdfc-2022",
      "created": "2023-02-26T22:06:38Z",
      "verificationMethod": "did:key:z6MkmEq87wkHCYnWnNZkigeDMGTN7oUw1upkhzd77KuXERS1#z6MkmEq87wkHCYnWnNZkigeDMGTN7oUw1upkhzd77KuXERS1",
      "proofPurpose": "assertionMethod",
      "previousProof": [
        "urn:uuid:26329423-bec9-4b2e-88cb-a7c7d9dc4544",
        "urn:uuid:8cc9022b-6b14-4cf3-8571-74972c5feb54"
      ],
      "proofValue": "zWaPeEvBAkhQpNQj8pknuvg5STcKnt3cvM9t4kAYeJETFjvVMSXEEjadC4uxC9fKCn6JHbjt6fj2fhoaVNynBm6J"
    },
    {
      "type": "DataIntegrityProof",
      "cryptosuite": "eddsa-rdfc-2022",
      "created": "2023-02-26T22:16:38Z",
      "verificationMethod": "did:key:z6Mkm1S51iPHJvDEkJ9MRtxJmT8Pqo6wHipAFwBAjN83vntT#z6Mkm1S51iPHJvDEkJ9MRtxJmT8Pqo6wHipAFwBAjN83vntT",
      "proofPurpose": "assertionMethod",
      "previousProof": "urn:uuid:d94f792a-c546-4d06-b38a-da070ab56c23",
      "proofValue": "z4b5uUtxNiV4E541LiR8qLvA21xM1Vt4Hfn6nLmmDePdFvLB3jFj3HyEEJyRMbpJzv4Gfdr8ABeuRTxAvZv6KWRRh"
    }
  ]
}</pre>
      </div>
        </section>
      </section>
    </section>

    <section class="informative" id="revision-history"><div class="header-wrapper"><h2 id="c-revision-history"><bdi class="secno">C. </bdi>Revision History</h2><a class="self-link" href="#revision-history" aria-label="Permalink for Section C."></a></div><p><em>This section is non-normative.</em></p>
      

      <p>
This section contains the substantive changes that have been made to this
specification over time.
      </p>

      <p>
Changes since the
<a href="https://www.w3.org/TR/2024/CR-vc-di-eddsa-20241219/">
Second Candidate Recommendation</a>:
      </p>

      <ul>
        <li>
Various editorial changes in algorithms and descriptions to improve readability.
        </li>
        <li>
Update test vectors to use more relevant examples.
        </li>
      </ul>

      <p>
Changes since the
<a href="https://www.w3.org/TR/2023/CR-vc-di-eddsa-20231121/">
First Candidate Recommendation</a>:
      </p>

      <ul>
        <li>
Various editorial changes in algorithms and descriptions to improve readability.
        </li>
        <li>
Moved Multikey definitions to Controller Document.
        </li>
        <li>
Update examples to align with updates in Data Integrity.
        </li>
        <li>
Unify error handling between all Data Integrity cryptosuites.
        </li>
        <li>
Ensure that the <code>created</code> proof option is not required and additional proof
options are included in the generated proof.
        </li>
        <li>
Move language related to context injection to Data Integrity.
        </li>
        <li>
Align proof serialization format and algorithm arguments with interfaces
defined in Data Integrity.
        </li>
      </ul>

      <p>
Changes since the
<a href="https://www.w3.org/TR/2023/WD-vc-di-eddsa-20230418/">
First Public Working Draft</a>:
      </p>

      <ul>
        <li>
Added support for JSON Canonicalization Scheme in addition to RDF Dataset
Canonicalization.
        </li>
        <li>
Added test vectors for rdfc and jcs cryptosuites.
        </li>
        <li>
Deprecated and moved Ed25519Signature2020 to appendix.
        </li>
        <li>
Add Security Considerations for proper implementation of EdDSA.
        </li>
        <li>
Move normative definition of Multikey to the Data Integrity specification.
        </li>
        <li>
Add RDF-CANON mitigation for Dataset poisoning.
        </li>
        <li>
Revise cryptographic suite names and align with other cryptosuites.
        </li>
        <li>
Add secretKeyMultibase definition.
        </li>
      </ul>
    </section>


    <section class="informative" id="acknowledgements"><div class="header-wrapper"><h2 id="d-acknowledgements"><bdi class="secno">D. </bdi>Acknowledgements</h2><a class="self-link" href="#acknowledgements" aria-label="Permalink for Section D."></a></div><p><em>This section is non-normative.</em></p>
      

      <p>
Work on this specification has been supported by the Rebooting the Web of Trust
community facilitated by Christopher Allen, Shannon Appelcline, Kiara Robles,
Brian Weller, Betty Dhamers, Kaliya Young, Manu Sporny, Drummond Reed, Joe
Andrieu, Heather Vescent, Kim Hamilton Duffy, Samantha Chase, Andrew Hughes,
Erica Connell, Shigeya Suzuki, Zaïda Rivai, Will Abramson, and Eric Schuh. The
participants in the Internet Identity Workshop, facilitated by Phil Windley,
Kaliya Young, Doc Searls, and Heidi Nobantu Saul, also supported the refinement
of this work through numerous working sessions designed to educate about, debate
on, and improve this specification.
      </p>

      <p>
The Working Group also thanks our Working Group Chair Brent Zundel, and ex-chair
Kristina Yasuda, as well as our <abbr title="World Wide Web Consortium">W3C</abbr> Staff Contact, Ivan Herman, for their expert
management and steady guidance of the group through the <abbr title="World Wide Web Consortium">W3C</abbr> standardization
cycle. We also thank the Chairs of the <abbr title="World Wide Web Consortium">W3C</abbr> Credentials Community Group,
Christopher Allen, Joe Andrieu, Kim Hamilton Duffy, Heather Vescent, Wayne
Chang, Mike Prorock, Harrison Tang, Kimberly Wilson Linson, and Will Abramson,
who oversaw the incubation of this work.
      </p>

      <p>
Portions of the work on this specification have been funded by the United States
Department of Homeland Security's Science and Technology Directorate under
contracts 70RSAT20T00000029, 70RSAT21T00000016, 70RSAT23T00000005,
70RSAT20T00000010/P00001, 70RSAT20T00000029, 70RSAT21T00000016/P00001,
70RSAT23T00000005, 70RSAT23C00000030, 70RSAT23R00000006, 70RSAT24T00000011, and
the National Science Foundation through NSF 22-572. The content of this
specification does not necessarily reflect the position or the policy of the
U.S. Government and no official endorsement should be inferred.
      </p>

      <p>
The Working Group would like to thank the following individuals for reviewing
and providing feedback on and implementations of the specification
(in alphabetical order by last name):
      </p>

      <p>
Greg Bernstein,
Simon Bihel,
Sebastian Crane,
Stas Dmytryshyn,
Tashi D. Gyeltshen,
Ivan Herman,
Andrew Jones,
Filip Kolarik,
Helge Krueger,
Dominik Kuziński,
Charles E. Lehner,
Dave Longley,
Tyler Minard,
Bryan Newbold,
Marty Reed,
Brian Richter,
Eugeniu Rusu,
Markus Sabadello,
Pritam Singh,
Patrick St. Louis,
Manu Sporny,
Orie Steele,
Ted Thibodeau Jr.,
Benjamin Young, and
Dmitri Zagidulin.
      </p>

    </section>

  

<section id="references" class="appendix"><div class="header-wrapper"><h2 id="e-references"><bdi class="secno">E. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix E."></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="e-1-normative-references"><bdi class="secno">E.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix E.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-cid">[CID]</dt><dd>
      <a href="https://www.w3.org/TR/cid-1.0/"><cite>Controlled Identifiers v1.0</cite></a>. Manu Sporny; Michael Jones.  W3C. 18 February 2025. CRD. URL: <a href="https://www.w3.org/TR/cid-1.0/">https://www.w3.org/TR/cid-1.0/</a>
    </dd><dt id="bib-fips-186-5">[FIPS-186-5]</dt><dd>
      <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-5.pdf"><cite>FIPS PUB 186-5: Digital Signature Standard (DSS)</cite></a>.  U.S. Department of Commerce/National Institute of Standards and Technology. 3 February 2023. National Standard. URL: <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-5.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-5.pdf</a>
    </dd><dt id="bib-infra">[INFRA]</dt><dd>
      <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Anne van Kesteren; Domenic Denicola.  WHATWG. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
    </dd><dt id="bib-json-ld11-api">[JSON-LD11-API]</dt><dd>
      <a href="https://www.w3.org/TR/json-ld11-api/"><cite>JSON-LD 1.1 Processing Algorithms and API</cite></a>. Gregg Kellogg; Dave Longley; Pierre-Antoine Champin.  W3C. 16 July 2020. W3C Recommendation. URL: <a href="https://www.w3.org/TR/json-ld11-api/">https://www.w3.org/TR/json-ld11-api/</a>
    </dd><dt id="bib-rdf-canon">[RDF-CANON]</dt><dd>
      <a href="https://www.w3.org/TR/rdf-canon/"><cite>RDF Dataset Canonicalization</cite></a>. Gregg Kellogg; Dave Longley; Dan Yamamoto.  W3C. 21 May 2024. W3C Recommendation. URL: <a href="https://www.w3.org/TR/rdf-canon/">https://www.w3.org/TR/rdf-canon/</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc6234">[RFC6234]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc6234"><cite>US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)</cite></a>. D. Eastlake 3rd; T. Hansen.  IETF. May 2011. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc6234">https://www.rfc-editor.org/rfc/rfc6234</a>
    </dd><dt id="bib-rfc8032">[RFC8032]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8032"><cite>Edwards-Curve Digital Signature Algorithm (EdDSA)</cite></a>. S. Josefsson; I. Liusvaara.  IETF. January 2017. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc8032">https://www.rfc-editor.org/rfc/rfc8032</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-rfc8785">[RFC8785]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8785"><cite>JSON Canonicalization Scheme (JCS)</cite></a>. A. Rundgren; B. Jordan; S. Erdtman.  IETF. June 2020. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc8785">https://www.rfc-editor.org/rfc/rfc8785</a>
    </dd><dt id="bib-vc-data-integrity">[VC-DATA-INTEGRITY]</dt><dd>
      <a href="https://www.w3.org/TR/vc-data-integrity/"><cite>Verifiable Credential Data Integrity 1.0</cite></a>. Manu Sporny; Ted Thibodeau Jr; Ivan Herman; Dave Longley; Greg Bernstein.  W3C. 23 February 2025. CRD. URL: <a href="https://www.w3.org/TR/vc-data-integrity/">https://www.w3.org/TR/vc-data-integrity/</a>
    </dd><dt id="bib-vc-data-model-2.0">[vc-data-model-2.0]</dt><dd>
      <a href="https://www.w3.org/TR/vc-data-model-2.0/"><cite>Verifiable Credentials Data Model v2.0</cite></a>. Manu Sporny; Ted Thibodeau Jr; Ivan Herman; Gabe Cohen; Michael Jones.  W3C. 23 February 2025. CRD. URL: <a href="https://www.w3.org/TR/vc-data-model-2.0/">https://www.w3.org/TR/vc-data-model-2.0/</a>
    </dd><dt id="bib-xmlschema11-2">[XMLSCHEMA11-2]</dt><dd>
      <a href="https://www.w3.org/TR/xmlschema11-2/"><cite>W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes</cite></a>. David Peterson; Sandy Gao; Ashok Malhotra; Michael Sperberg-McQueen; Henry Thompson; Paul V. Biron et al.  W3C. 5 April 2012. W3C Recommendation. URL: <a href="https://www.w3.org/TR/xmlschema11-2/">https://www.w3.org/TR/xmlschema11-2/</a>
    </dd></dl>
  </section><section id="informative-references"><div class="header-wrapper"><h3 id="e-2-informative-references"><bdi class="secno">E.2 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix E.2"></a></div>
    
    <dl class="bibliography"><dt id="bib-provable_ed25519">[Provable_Ed25519]</dt><dd>
      <a href="https://eprint.iacr.org/2020/823"><cite>The Provable Security of Ed25519: Theory and Practice</cite></a>. Jacqueline Brendel; Cas Cremers; Dennis Jackson; Mang Zhao.  Cryptology ePrint Archive, Paper 2020/823. 2020. URL: <a href="https://eprint.iacr.org/2020/823">https://eprint.iacr.org/2020/823</a>
    </dd><dt id="bib-taming_eddsas">[Taming_EdDSAs]</dt><dd>
      <a href="https://eprint.iacr.org/2020/1244"><cite>Taming the many EdDSAs</cite></a>. Konstantinos Chalkias; François Garillot; Valeria Nikolaenko.  Cryptology ePrint Archive, Paper 2020/1244. 2020. URL: <a href="https://eprint.iacr.org/2020/1244">https://eprint.iacr.org/2020/1244</a>
    </dd><dt id="bib-vc-di-bbs">[VC-DI-BBS]</dt><dd>
      <a href="https://www.w3.org/TR/vc-di-bbs/"><cite>Data Integrity BBS Cryptosuites v1.0</cite></a>. Greg Bernstein; Manu Sporny.  W3C. 18 February 2025. CRD. URL: <a href="https://www.w3.org/TR/vc-di-bbs/">https://www.w3.org/TR/vc-di-bbs/</a>
    </dd><dt id="bib-vc-di-ecdsa">[VC-DI-ECDSA]</dt><dd>
      <a href="https://www.w3.org/TR/vc-di-ecdsa/"><cite>Data Integrity ECDSA Cryptosuites v1.0</cite></a>. Manu Sporny; Dave Longley; Greg Bernstein.  W3C. 23 February 2025. CRD. URL: <a href="https://www.w3.org/TR/vc-di-ecdsa/">https://www.w3.org/TR/vc-di-ecdsa/</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-conforming-proof" aria-label="Links in this document to definition: conforming proof">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-conforming-proof" aria-label="Permalink for definition: conforming proof. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-conforming-proof-1" title="§ 1.2 Conformance">§ 1.2 Conformance</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-conforming-processor" aria-label="Links in this document to definition: conforming processor">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-conforming-processor" aria-label="Permalink for definition: conforming processor. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
      <li>Not referenced in this document.</li>
    </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verification-result" aria-label="Links in this document to definition: verification result">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verification-result" aria-label="Permalink for definition: verification result. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-verification-result-1" title="§ 3.2.2 Verify Proof (eddsa-rdfc-2022)">§ 3.2.2 Verify Proof (eddsa-rdfc-2022)</a> 
    </li><li>
      <a href="#ref-for-dfn-verification-result-2" title="§ 3.3.2 Verify Proof (eddsa-jcs-2022)">§ 3.3.2 Verify Proof (eddsa-jcs-2022)</a> <a href="#ref-for-dfn-verification-result-3" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verified" aria-label="Links in this document to definition: verified">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verified" aria-label="Permalink for definition: verified. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-verified-1" title="§ 3.2.2 Verify Proof (eddsa-rdfc-2022)">§ 3.2.2 Verify Proof (eddsa-rdfc-2022)</a> <a href="#ref-for-dfn-verified-2" title="Reference 2">(2)</a> 
    </li><li>
      <a href="#ref-for-dfn-verified-3" title="§ 3.3.2 Verify Proof (eddsa-jcs-2022)">§ 3.3.2 Verify Proof (eddsa-jcs-2022)</a> <a href="#ref-for-dfn-verified-4" title="Reference 2">(2)</a> <a href="#ref-for-dfn-verified-5" title="Reference 3">(3)</a> 
    </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verifieddocument" aria-label="Links in this document to definition: verifiedDocument">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verifieddocument" aria-label="Permalink for definition: verifiedDocument. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      <a href="#ref-for-dfn-verifieddocument-1" title="§ 3.2.2 Verify Proof (eddsa-rdfc-2022)">§ 3.2.2 Verify Proof (eddsa-rdfc-2022)</a> 
    </li><li>
      <a href="#ref-for-dfn-verifieddocument-2" title="§ 3.3.2 Verify Proof (eddsa-jcs-2022)">§ 3.3.2 Verify Proof (eddsa-jcs-2022)</a> <a href="#ref-for-dfn-verifieddocument-3" title="Reference 2">(2)</a> 
    </li>
  </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>